<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rafiq Islam">
<meta name="dcterms.date" content="2024-10-17">

<title>Classification: Linear Discriminant Analysis (LDA) – Mohammad Rafiqul Islam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//_assets/images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-5c1e972a709ec2345b6d43d3c093db11.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-5c1e972a709ec2345b6d43d3c093db11.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-4f173b6b72e710a50e531603dc7f7788.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5a25a63be99f19f9289209c35fcd57a0.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-image','listing-date','listing-title','listing-author','listing-reading-time',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      page: 18,
    pagination: { item: "<li class='page-item'><a class='page page-link' href='#'></a></li>" },
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description","listing-categories"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Z5NP67GHFC"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Z5NP67GHFC', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6878992848042528" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Classification: Linear Discriminant Analysis (LDA) – Mohammad Rafiqul Islam">
<meta property="og:description" content="">
<meta property="og:image" content="https://mrislambd.github.io/dsandml/lda/lda.png">
<meta property="og:site_name" content="Mohammad Rafiqul Islam">
<meta property="og:image:height" content="576">
<meta property="og:image:width" content="768">
<meta name="twitter:title" content="Classification: Linear Discriminant Analysis (LDA) – Mohammad Rafiqul Islam">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://mrislambd.github.io/dsandml/lda/lda.png">
<meta name="twitter:image-height" content="576">
<meta name="twitter:image-width" content="768">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../dsandml/lda/index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../_assets/images/fsu-logo.png" alt="Florida State University" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../dsandml/lda/index.html">
    <span class="navbar-title">Mohammad Rafiqul Islam</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blog">    
        <li>
    <a class="dropdown-item" href="../../posts/machinelearning/index.html">
 <span class="dropdown-text">Data Science and Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/jobandintern/index.html">
 <span class="dropdown-text">Job and Intern</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../blog.html">
 <span class="dropdown-text">All Other Blogs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/mohammad-rafiqul-islam/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mrislambd" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#mathematical-foundation-of-lda" id="toc-mathematical-foundation-of-lda" class="nav-link" data-scroll-target="#mathematical-foundation-of-lda">Mathematical Foundation of LDA</a></li>
  <li><a href="#dimensionality-reduction" id="toc-dimensionality-reduction" class="nav-link" data-scroll-target="#dimensionality-reduction">Dimensionality Reduction</a>
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#compute-class-means-mu_k-for-each-class" id="toc-compute-class-means-mu_k-for-each-class" class="nav-link" data-scroll-target="#compute-class-means-mu_k-for-each-class">1. Compute Class Means <span class="math inline">\(\mu_k\)</span> for each class:</a></li>
  <li><a href="#compute-overall-mean-mu" id="toc-compute-overall-mean-mu" class="nav-link" data-scroll-target="#compute-overall-mean-mu">2. Compute Overall Mean <span class="math inline">\(\mu\)</span>:</a></li>
  <li><a href="#compute-the-within-class-scatter-matrix-s_w" id="toc-compute-the-within-class-scatter-matrix-s_w" class="nav-link" data-scroll-target="#compute-the-within-class-scatter-matrix-s_w">3. <strong>Compute the Within-Class Scatter Matrix <span class="math inline">\(S_W\)</span></strong>:</a></li>
  <li><a href="#compute-the-between-class-scatter-matrix-s_b" id="toc-compute-the-between-class-scatter-matrix-s_b" class="nav-link" data-scroll-target="#compute-the-between-class-scatter-matrix-s_b">4. Compute the Between-Class Scatter Matrix <span class="math inline">\(S_B\)</span>:</a></li>
  <li><a href="#solve-the-eigenvalue-problem" id="toc-solve-the-eigenvalue-problem" class="nav-link" data-scroll-target="#solve-the-eigenvalue-problem">5. Solve the Eigenvalue Problem:</a></li>
  <li><a href="#step-6-visualizing-the-results" id="toc-step-6-visualizing-the-results" class="nav-link" data-scroll-target="#step-6-visualizing-the-results">Step 6: Visualizing the Results</a></li>
  <li><a href="#summary-of-the-process-of-eigenvalue-problem" id="toc-summary-of-the-process-of-eigenvalue-problem" class="nav-link" data-scroll-target="#summary-of-the-process-of-eigenvalue-problem">Summary of the Process of Eigenvalue Problem</a></li>
  <li><a href="#final-summary" id="toc-final-summary" class="nav-link" data-scroll-target="#final-summary">Final Summary</a></li>
  </ul></li>
  <li><a href="#python-code-example" id="toc-python-code-example" class="nav-link" data-scroll-target="#python-code-example">Python Code Example</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul>
  <li><a href="#disclaimer" id="toc-disclaimer" class="nav-link" data-scroll-target="#disclaimer">Disclaimer</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.ipynb" download="index.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li><li><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="index.epub"><i class="bi bi-file"></i>ePub</a></li><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <h5 class="quarto-listing-category-title">Categories</h5><div class="quarto-listing-category category-default"><div class="category" data-category="">All <span class="quarto-category-count">(157)</span></div><div class="category" data-category="QWxnb3JpdGhtcw==">Algorithms <span class="quarto-category-count">(1)</span></div><div class="category" data-category="QXJ0aWZpY2lhbCUyMEludGVsbGlnZW5jZQ==">Artificial Intelligence <span class="quarto-category-count">(20)</span></div><div class="category" data-category="QmF5ZXNpYW4lMjBJbmZlcmVuY2U=">Bayesian Inference <span class="quarto-category-count">(2)</span></div><div class="category" data-category="QmF5ZXNpYW4lMjBTdGF0aXN0aWNz">Bayesian Statistics <span class="quarto-category-count">(2)</span></div><div class="category" data-category="RGF0YSUyMEVuZ2luZWVyaW5n">Data Engineering <span class="quarto-category-count">(10)</span></div><div class="category" data-category="RGF0YSUyMFNjaWVuY2U=">Data Science <span class="quarto-category-count">(23)</span></div><div class="category" data-category="TWFjaGluZSUyMExlYXJuaW5n">Machine Learning <span class="quarto-category-count">(23)</span></div><div class="category" data-category="UHJvZ3JhbW1pbmc=">Programming <span class="quarto-category-count">(1)</span></div><div class="category" data-category="UHlUb3JjaA==">PyTorch <span class="quarto-category-count">(1)</span></div><div class="category" data-category="UHl0aG9u">Python <span class="quarto-category-count">(1)</span></div><div class="category" data-category="U3RhdGlzdGljcw==">Statistics <span class="quarto-category-count">(5)</span></div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Classification: Linear Discriminant Analysis (LDA)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Data Science</div>
    <div class="quarto-category">Machine Learning</div>
    <div class="quarto-category">Artificial Intelligence</div>
    <div class="quarto-category">Data Engineering</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rafiq Islam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p style="text-align: justify">
Linear Discriminant Analysis (LDA) is a supervised machine learning algorithm commonly used for classification tasks. It is widely applied when dealing with datasets where the number of predictors (features) exceeds the number of observations, or when multicollinearity is a concern. LDA works by projecting data onto a lower-dimensional space, maximizing the separation between classes.
</p>
</section>
<section id="mathematical-foundation-of-lda" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-foundation-of-lda">Mathematical Foundation of LDA</h2>
<p style="text-align: justify">
Let’s assume we have a dataset <span class="math inline">\(X \in \mathbb{R}^{n \times p}\)</span> consisting of <span class="math inline">\(n\)</span> data points and <span class="math inline">\(p\)</span> features, and each data point belongs to one of <span class="math inline">\(K\)</span> distinct classes. The goal of LDA is to find a new space (called a discriminant space) in which the classes are maximally separated, i.e.&nbsp;we want to <strong>maximize the separability between classes</strong> while <strong>minimizing the variation within each class</strong>. This can be mathematically expressed as finding a projection that maximizes the ratio of between-class variance to within-class variance.
</p>
<p>For each class <span class="math inline">\(C_k\)</span> (where <span class="math inline">\(k \in \{1, 2, \dots, K\}\)</span>):</p>
<ul>
<li><span class="math inline">\(\mu_k\)</span> is the <strong>mean vector</strong> of class <span class="math inline">\(C_k\)</span>.<br>
</li>
<li><span class="math inline">\(\mu\)</span> is the <strong>overall mean</strong> of the entire dataset.</li>
</ul>
<p><strong>Class Mean</strong>: For each class <span class="math inline">\(C_k\)</span>, the mean is calculated as:</p>
<p><span class="math display">\[
\mu_k = \frac{1}{N_k} \sum_{x_i \in C_k} x_i
\]</span></p>
<p>where <span class="math inline">\(N_k\)</span> is the number of data points in class <span class="math inline">\(C_k\)</span>, and <span class="math inline">\(x_i\)</span> represents individual data points.</p>
<p><strong>Overall Mean</strong>: The mean of the entire dataset is:</p>
<p><span class="math display">\[
\mu = \frac{1}{n} \sum_{i=1}^{n} x_i
\]</span></p>
<p>To understand how well classes are separated, we need two key measures:</p>
<ol type="1">
<li><p><strong>Within-Class Scatter Matrix <span class="math inline">\(S_W\)</span></strong><br>
The within-class scatter matrix measures how the data points of each class deviate from the class mean. It captures the <strong>spread of data points within each class</strong>. For class <span class="math inline">\(C_k\)</span>, the scatter matrix is calculated as:<br>
<span class="math display">\[
S_W = \sum_{k=1}^{K} \sum_{x_i \in C_k} (x_i - \mu_k)(x_i - \mu_k)^T
\]</span></p>
<p>This formula is saying that for each class <span class="math inline">\(C_k\)</span>, we calculate the distance of every point <span class="math inline">\(x_i\)</span> from the mean of its class <span class="math inline">\(\mu_k\)</span>, and then sum these squared distances across all classes.</p></li>
<li><p><strong>Between-Class Scatter Matrix <span class="math inline">\(S_B\)</span></strong><br>
The between-class scatter matrix measures how the <strong>class means deviate from the overall mean</strong>. It captures how well-separated the classes are.</p>
<p><span class="math display">\[
S_B = \sum_{k=1}^{K} N_k (\mu_k - \mu)(\mu_k - \mu)^T
\]</span></p>
<p>In this case, for each class <span class="math inline">\(C_k\)</span>, we calculate the distance between the mean of class <span class="math inline">\(\mu_k\)</span> and the overall mean <span class="math inline">\(\mu\)</span>, then scale this by the number of points in class <span class="math inline">\(C_k\)</span>.</p></li>
</ol>
<hr>
<p style="text-align: justify">
LDA aims to find a transformation that maximizes the separation between classes. This is done by finding a linear projection <span class="math inline">\(\mathbf{w}\)</span> such that the <strong>between-class scatter is maximized</strong> and the <strong>within-class scatter is minimized</strong>. Mathematically, the optimization problem becomes:
</p>
<p><span class="math display">\[
J(\mathbf{w}) = \frac{\mathbf{w}^T S_B \mathbf{w}}{\mathbf{w}^T S_W \mathbf{w}}
\]</span></p>
<ul>
<li><span class="math inline">\(S_B \mathbf{w}\)</span> captures the between-class variance (how well-separated the classes are in the new projection).<br>
</li>
<li><span class="math inline">\(S_W \mathbf{w}\)</span> captures the within-class variance (how tightly packed the points of the same class are in the new projection).</li>
</ul>
<p>This ratio <span class="math inline">\(J(\mathbf{w})\)</span> is known as the <strong>Fisher’s discriminant ratio</strong>. The goal is to find <span class="math inline">\(\mathbf{w}\)</span> that maximizes this ratio. To maximize the Fisher’s discriminant ratio, we need to solve the following generalized eigenvalue problem:</p>
<p><span class="math display">\[
S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{w}\)</span> is the vector that defines the linear combination of features that maximizes class separation, and <span class="math inline">\(\lambda\)</span> is an eigenvalue that represents how much variance is explained by that direction.</p>
<p>The solution to this equation gives us the eigenvectors (directions) and eigenvalues (variances) of the transformed space. We select the top eigenvectors corresponding to the largest eigenvalues to form the projection matrix <span class="math inline">\(W\)</span>.</p>
<hr>
</section>
<section id="dimensionality-reduction" class="level2">
<h2 class="anchored" data-anchor-id="dimensionality-reduction">Dimensionality Reduction</h2>
<p style="text-align: justify">
The LDA transformation reduces the dimensionality of the data by projecting it onto a subspace spanned by the eigenvectors with the largest eigenvalues. For a dataset with <span class="math inline">\(K\)</span> classes, LDA can reduce the data to at most <span class="math inline">\(K-1\)</span> dimensions because <span class="math inline">\(S_B\)</span> has rank <span class="math inline">\(K-1\)</span>. <br><br> If we have two classes, LDA will reduce the data to a one-dimensional subspace. For three classes, LDA can project the data onto a two-dimensional subspace, and so on.
</p>
<hr>
<p>Now before diving into the python code, let’s do some math by hand so that we can understand the skeleton of the process. Let’s create a small dataset with 6 features and 4 observations divided into 3 classes. We will use this dataset to manually go through the Linear Discriminant Analysis (LDA) process step by step.</p>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Observation</th>
<th>Feature 1</th>
<th>Feature 2</th>
<th>Feature 3</th>
<th>Feature 4</th>
<th>Feature 5</th>
<th>Feature 6</th>
<th>Class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_1\)</span></td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td><span class="math inline">\(C_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_2\)</span></td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td><span class="math inline">\(C_1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_3\)</span></td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td><span class="math inline">\(C_2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_4\)</span></td>
<td>7</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td><span class="math inline">\(C_3\)</span></td>
</tr>
</tbody>
</table>
<p>Now, we’ll walk through the mathematical steps of LDA for this small dataset.</p>
</section>
<section id="compute-class-means-mu_k-for-each-class" class="level3">
<h3 class="anchored" data-anchor-id="compute-class-means-mu_k-for-each-class">1. Compute Class Means <span class="math inline">\(\mu_k\)</span> for each class:</h3>
<ul>
<li><p>Class <span class="math inline">\(C_1\)</span> (mean of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>): <span class="math display">\[
\mu_1 = \frac{1}{2} \left( \begin{bmatrix} 2 \\ 3 \\ 4 \\ 5 \\ 6 \\ 7 \end{bmatrix} + \begin{bmatrix} 3 \\ 4 \\ 5 \\ 6 \\ 7 \\ 8 \end{bmatrix} \right) = \begin{bmatrix} 2.5 \\ 3.5 \\ 4.5 \\ 5.5 \\ 6.5 \\ 7.5 \end{bmatrix}
\]</span></p></li>
<li><p>Class <span class="math inline">\(C_2\)</span> (only one observation <span class="math inline">\(x_3\)</span>): <span class="math display">\[
\mu_2 = \begin{bmatrix} 6 \\ 5 \\ 4 \\ 3 \\ 2 \\ 1 \end{bmatrix}
\]</span></p></li>
<li><p>Class <span class="math inline">\(C_3\)</span> (only one observation <span class="math inline">\(x_4\)</span>): <span class="math display">\[
\mu_3 = \begin{bmatrix} 7 \\ 6 \\ 5 \\ 4 \\ 3 \\ 2 \end{bmatrix}
\]</span></p></li>
</ul>
</section>
<section id="compute-overall-mean-mu" class="level3">
<h3 class="anchored" data-anchor-id="compute-overall-mean-mu">2. Compute Overall Mean <span class="math inline">\(\mu\)</span>:</h3>
<p>We compute the overall mean <span class="math inline">\(\mu\)</span>, which is the average of all observations from all classes:</p>
<p><span class="math display">\[
\mu = \frac{1}{4} \left( \begin{bmatrix} 2 \\ 3 \\ 4 \\ 5 \\ 6 \\ 7 \end{bmatrix} + \begin{bmatrix} 3 \\ 4 \\ 5 \\ 6 \\ 7 \\ 8 \end{bmatrix} + \begin{bmatrix} 6 \\ 5 \\ 4 \\ 3 \\ 2 \\ 1 \end{bmatrix} + \begin{bmatrix} 7 \\ 6 \\ 5 \\ 4 \\ 3 \\ 2 \end{bmatrix} \right)= \frac{1}{4} \begin{bmatrix} 18 \\ 18 \\ 18 \\ 18 \\ 18 \\ 18 \end{bmatrix} = \begin{bmatrix} 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \end{bmatrix}
\]</span></p>
</section>
<section id="compute-the-within-class-scatter-matrix-s_w" class="level3">
<h3 class="anchored" data-anchor-id="compute-the-within-class-scatter-matrix-s_w">3. <strong>Compute the Within-Class Scatter Matrix <span class="math inline">\(S_W\)</span></strong>:</h3>
<p>For each class <span class="math inline">\(C_k\)</span>, the within-class scatter matrix <span class="math inline">\(S_W\)</span> is computed as:</p>
<p><span class="math display">\[
S_W = \sum_{k=1}^{K} \sum_{x_i \in C_k} (x_i - \mu_k)(x_i - \mu_k)^T
\]</span></p>
<p>For <span class="math inline">\(C_1\)</span>, the within-class scatter matrix is:</p>
<p><span class="math display">\[
(x_1 - \mu_1) = \begin{bmatrix} 2 \\ 3 \\ 4 \\ 5 \\ 6 \\ 7 \end{bmatrix} - \begin{bmatrix} 2.5 \\ 3.5 \\ 4.5 \\ 5.5 \\ 6.5 \\ 7.5 \end{bmatrix} = \begin{bmatrix} -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \end{bmatrix}; \hspace{6mm} (x_2 - \mu_1) = \begin{bmatrix} 3 \\ 4 \\ 5 \\ 6 \\ 7 \\ 8 \end{bmatrix} - \begin{bmatrix} 2.5 \\ 3.5 \\ 4.5 \\ 5.5 \\ 6.5 \\ 7.5 \end{bmatrix} = \begin{bmatrix} 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \end{bmatrix}
\]</span></p>
<p>For class <span class="math inline">\(C_1\)</span>, the scatter matrix is:</p>
<p><span class="math display">\[\begin{align*}
S_{W1} &amp;= (x_1 - \mu_1)(x_1 - \mu_1)^T + (x_2 - \mu_1)(x_2 - \mu_1)^T\\
&amp;=\begin{bmatrix} -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \\ -0.5 \end{bmatrix} \begin{bmatrix} -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 \end{bmatrix} + \begin{bmatrix} 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \end{bmatrix} \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}\\
&amp;= \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}
\end{align*}\]</span></p>
<p>For classes <span class="math inline">\(C_2\)</span> and <span class="math inline">\(C_3\)</span>, there is only one data point in each, so there is no within-class scatter:</p>
<p><span class="math display">\[
S_{W2} = 0, \quad S_{W3} = 0
\]</span></p>
<p>Thus, the total within-class scatter matrix is:</p>
<p><span class="math display">\[
S_W = S_{W1} + S_{W2} + S_{W3} = S_{W1}
\]</span></p>
<p><span class="math display">\[
S_W = \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}
\]</span></p>
</section>
<section id="compute-the-between-class-scatter-matrix-s_b" class="level3">
<h3 class="anchored" data-anchor-id="compute-the-between-class-scatter-matrix-s_b">4. Compute the Between-Class Scatter Matrix <span class="math inline">\(S_B\)</span>:</h3>
<p>For each class <span class="math inline">\(C_k\)</span>, the between-class scatter matrix is computed as:</p>
<p><span class="math display">\[
S_B = \sum_{k=1}^{K} N_k (\mu_k - \mu)(\mu_k - \mu)^T
\]</span></p>
<p>For class <span class="math inline">\(C_1\)</span> (where <span class="math inline">\(N_1 = 2\)</span>):</p>
<p><span class="math display">\[
(\mu_1 - \mu) = \begin{bmatrix} 2.5 \\ 3.5 \\ 4.5 \\ 5.5 \\ 6.5 \\ 7.5 \end{bmatrix} - \begin{bmatrix} 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \end{bmatrix} = \begin{bmatrix} -2 \\ -1 \\ 0 \\ 1 \\ 2 \\ 3 \end{bmatrix}
\]</span></p>
<p>Thus, for <span class="math inline">\(C_1\)</span>:</p>
<p><span class="math display">\[\begin{align*}
S_{B1} &amp;= 2 \begin{bmatrix} -2 \\ -1 \\ 0 \\ 1 \\ 2 \\ 3 \end{bmatrix} \begin{bmatrix} -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 &amp; 3 \end{bmatrix}= 2 \begin{bmatrix} 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 \\ 2 &amp; 1 &amp; 0 &amp; -1 &amp; -2 &amp; -3 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 &amp; 3 \\ -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 \\ -6 &amp; -3 &amp; 0 &amp; 3 &amp; 6 &amp; 9 \end{bmatrix}\\
&amp;=\begin{bmatrix} 8 &amp; 4 &amp; 0 &amp; -4 &amp; -8 &amp; -12 \\ 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 \\ -8 &amp; -4 &amp; 0 &amp; 4 &amp; 8 &amp; 12 \\ -12 &amp; -6 &amp; 0 &amp; 6 &amp; 12 &amp; 18 \end{bmatrix}
\end{align*}\]</span></p>
<p>For <span class="math inline">\(C_2\)</span> (where <span class="math inline">\(N_2 = 1\)</span>):</p>
<p><span class="math display">\[
(\mu_2 - \mu) = \begin{bmatrix} 6 \\ 5 \\ 4 \\ 3 \\ 2 \\ 1 \end{bmatrix} - \begin{bmatrix} 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \end{bmatrix} = \begin{bmatrix} 1.5 \\ 0.5 \\ -0.5 \\ -1.5 \\ -2.5 \\ -3.5 \end{bmatrix}
\]</span></p>
<p>The between-class scatter matrix for <span class="math inline">\(C_2\)</span> is:</p>
<p><span class="math display">\[\begin{align*}
S_{B2} &amp;= \begin{bmatrix} 1.5 \\ 0.5 \\ -0.5 \\ -1.5 \\ -2.5 \\ -3.5 \end{bmatrix} \begin{bmatrix} 1.5 &amp; 0.5 &amp; -0.5 &amp; -1.5 &amp; -2.5 &amp; -3.5 \end{bmatrix}\\
&amp;= \begin{bmatrix} 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 &amp; -5.25 \\ 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 &amp; -1.75 \\ -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 &amp; 1.75 \\ -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 &amp; 5.25 \\ -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 &amp; 8.75 \\ -5.25 &amp; -1.75 &amp; 1.75 &amp; 5.25 &amp; 8.75 &amp; 12.25 \end{bmatrix}
\end{align*}\]</span></p>
<p>For <span class="math inline">\(C_3\)</span> (where <span class="math inline">\(N_3 = 1\)</span>):</p>
<p><span class="math display">\[
(\mu_3 - \mu) = \begin{bmatrix} 7 \\ 6 \\ 5 \\ 4 \\ 3 \\ 2 \end{bmatrix} - \begin{bmatrix} 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \\ 4.5 \end{bmatrix} = \begin{bmatrix} 2.5 \\ 1.5 \\ 0.5 \\ -0.5 \\ -1.5 \\ -2.5 \end{bmatrix}
\]</span></p>
<p>The between-class scatter matrix for <span class="math inline">\(C_3\)</span> is:</p>
<p><span class="math display">\[\begin{align*}
S_{B3} &amp;= \begin{bmatrix} 2.5 \\ 1.5 \\ 0.5 \\ -0.5 \\ -1.5 \\ -2.5 \end{bmatrix} \begin{bmatrix} 2.5 &amp; 1.5 &amp; 0.5 &amp; -0.5 &amp; -1.5 &amp; -2.5 \end{bmatrix}\\
&amp;=\begin{bmatrix} 6.25 &amp; 3.75 &amp; 1.25 &amp; -1.25 &amp; -3.75 &amp; -6.25 \\ 3.75 &amp; 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 \\ 1.25 &amp; 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 \\ -1.25 &amp; -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 \\ -3.75 &amp; -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 \\ -6.25 &amp; -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 \end{bmatrix}
\end{align*}\]</span></p>
<p>Total Between-Class Scatter Matrix <span class="math inline">\(S_B\)</span>:</p>
<p><span class="math display">\[\begin{align*}
S_B &amp;= S_{B1} + S_{B2} + S_{B3}\\
&amp;=\begin{bmatrix} 8 &amp; 4 &amp; 0 &amp; -4 &amp; -8 &amp; -12 \\ 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 \\ -8 &amp; -4 &amp; 0 &amp; 4 &amp; 8 &amp; 12 \\ -12 &amp; -6 &amp; 0 &amp; 6 &amp; 12 &amp; 18 \end{bmatrix} + \begin{bmatrix} 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 &amp; -5.25 \\ 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 &amp; -1.75 \\ -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 &amp; 1.75 \\ -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 &amp; 5.25 \\ -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 &amp; 8.75 \\ -5.25 &amp; -1.75 &amp; 1.75 &amp; 5.25 &amp; 8.75 &amp; 12.25 \end{bmatrix} \\
&amp;\\
&amp; + \begin{bmatrix} 6.25 &amp; 3.75 &amp; 1.25 &amp; -1.25 &amp; -3.75 &amp; -6.25 \\ 3.75 &amp; 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 \\ 1.25 &amp; 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 \\ -1.25 &amp; -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 \\ -3.75 &amp; -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 \\ -6.25 &amp; -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 \end{bmatrix}
\end{align*}\]</span></p>
<p>Adding the matrices gives:</p>
<p><span class="math display">\[
S_B = \begin{bmatrix} 16.5 &amp; 8.5 &amp; 0.5 &amp; -7.5 &amp; -15.5 &amp; -23.5 \\ 8.5 &amp; 4.5 &amp; 0.5 &amp; -3.5 &amp; -7.5 &amp; -11.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ -7.5 &amp; -3.5 &amp; 0.5 &amp; 4.5 &amp; 8.5 &amp; 12.5 \\ -15.5 &amp; -7.5 &amp; 0.5 &amp; 8.5 &amp; 16.5 &amp; 24.5 \\ -23.5 &amp; -11.5 &amp; 0.5 &amp; 12.5 &amp; 24.5 &amp; 36.5 \end{bmatrix}
\]</span></p>
</section>
<section id="solve-the-eigenvalue-problem" class="level3">
<h3 class="anchored" data-anchor-id="solve-the-eigenvalue-problem">5. Solve the Eigenvalue Problem:</h3>
<p>We now solve the eigenvalue problem:<br>
<span class="math display">\[
S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}
\]</span></p>
<p style="text-align:justify">
The solution to this eigenvalue problem gives us the eigenvalues <span class="math inline">\(\lambda\)</span> (which quantify the amount of variance captured in each direction) and the eigenvectors <span class="math inline">\(\mathbf{w}\)</span> (which give the directions of maximum class separation). The eigenvector corresponding to the largest eigenvalue defines the direction of the first discriminant axis, which is the direction that maximally separates the classes.
</p>
<p><span class="math display">\[\begin{align*}
\begin{bmatrix}
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \\
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \\
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \\
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \\
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \\
6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \end{bmatrix}\begin{bmatrix} 16.5 &amp; 8.5 &amp; 0.5 &amp; -7.5 &amp; -15.5 &amp; -23.5 \\ 8.5 &amp; 4.5 &amp; 0.5 &amp; -3.5 &amp; -7.5 &amp; -11.5 \\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\ -7.5 &amp; -3.5 &amp; 0.5 &amp; 4.5 &amp; 8.5 &amp; 12.5 \\ -15.5 &amp; -7.5 &amp; 0.5 &amp; 8.5 &amp; 16.5 &amp; 24.5 \\ -23.5 &amp; -11.5 &amp; 0.5 &amp; 12.5 &amp; 24.5 &amp; 36.5 \end{bmatrix}\begin{bmatrix}w_1\\w_2\\w_3\\w_4\\w_5\\w_6\end{bmatrix}&amp;=\lambda\begin{bmatrix}w_1\\w_2\\w_3\\w_4\\w_5\\w_6\end{bmatrix}\\
\implies \begin{bmatrix}
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \\
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \\
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \\
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \\
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \\
-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \end{bmatrix}\begin{bmatrix}w_1\\w_2\\w_3\\w_4\\w_5\\w_6\end{bmatrix}&amp;=\lambda\begin{bmatrix}w_1\\w_2\\w_3\\w_4\\w_5\\w_6\end{bmatrix}
\end{align*}\]</span></p>
<p>The eigenvalues of the matrix are:</p>
<p><span class="math display">\[
\lambda_1 = 6.00, \quad \lambda_2 = 1.78 \times 10^{-15}, \quad \lambda_3 = 9.86 \times 10^{-32}, \quad \lambda_4 = 0.00, \quad \lambda_5 = -5.47 \times 10^{-48}, \quad \lambda_6 = -5.95 \times 10^{-16}
\]</span></p>
<p>The two largest eigenvalues are:</p>
<ol type="1">
<li><span class="math inline">\(\lambda_1 = 6.00\)</span></li>
<li><span class="math inline">\(\lambda_2 = 1.78 \times 10^{-15}\)</span></li>
</ol>
<p>The corresponding eigenvectors for the two largest eigenvalues are:</p>
<p><span class="math display">\[
\mathbf{w_1} = \begin{bmatrix}
-0.408 \\
-0.408 \\
-0.408 \\
-0.408 \\
-0.408 \\
-0.408 \end{bmatrix}, \quad
\mathbf{w_2} = \begin{bmatrix}
-0.848 \\
-0.237 \\
-0.237 \\
-0.237 \\
-0.237 \\
-0.237 \end{bmatrix}
\]</span></p>
<p>By projecting the data onto the eigenvector <span class="math inline">\(\mathbf{w}\)</span>, we transform the original dataset into a lower-dimensional space where class separability is maximized. For this dataset, since there are 3 classes, LDA will find up to <span class="math inline">\(K-1 = 2\)</span> discriminant axes. Let’s see how.</p>
<p>The matrix formed by the two largest eigenvectors is:</p>
<p><span class="math display">\[
W=\begin{bmatrix}
-0.408 &amp; -0.848 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \end{bmatrix}
\]</span></p>
<p style="text-align: justify">
This matrix represents the projection directions corresponding to the two largest eigenvalues in the Linear Discriminant Analysis process. With the eigenvectors <span class="math inline">\(\mathbf{w}_1\)</span> and <span class="math inline">\(\mathbf{w}_2\)</span>, we can now project our original dataset onto the new 2D subspace. <br><br> Now, let <span class="math inline">\(X\)</span> represent our original dataset (where each row corresponds to an observation and each column to a feature). The projection of the original data onto the new 2D subspace is given by:
</p>
<p><span class="math display">\[
Y = X W
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(X\)</span> is the <span class="math inline">\(4 \times 6\)</span> matrix (4 observations, 6 features),</li>
<li><span class="math inline">\(W\)</span> is the <span class="math inline">\(6 \times 2\)</span> matrix of eigenvectors.</li>
</ul>
<p>After multiplying <span class="math inline">\(X\)</span> by <span class="math inline">\(W\)</span>, we obtain the projected data matrix <span class="math inline">\(Y\)</span>, which is a <span class="math inline">\(4 \times 2\)</span> matrix (4 observations, 2 features):</p>
<p><span class="math display">\[
Y = \begin{bmatrix}
y_{11} &amp; y_{12} \\
y_{21} &amp; y_{22} \\
y_{31} &amp; y_{32} \\
y_{41} &amp; y_{42}
\end{bmatrix}
\]</span></p>
<p>This matrix <span class="math inline">\(Y\)</span> represents the data in the new 2D space where class separability is maximized. So for our data</p>
<p><span class="math display">\[\begin{align*}
\begin{bmatrix}2&amp;3&amp;4&amp;5&amp;6&amp;7\\3&amp;4&amp;5&amp;6&amp;7&amp;8\\6&amp;5&amp;4&amp;3&amp;2&amp;1\\7&amp;6&amp;5&amp;4&amp;3&amp;2\end{bmatrix}\begin{bmatrix}
-0.408 &amp; -0.848 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \\
-0.408 &amp; -0.237 \end{bmatrix}&amp;=\begin{bmatrix}-11.016 &amp; -7.621\\-13.464 &amp; -9.654\\ -8.568 &amp; -8.643\\-11.016 &amp;-10.676\end{bmatrix}
\end{align*}\]</span></p>
</section>
<section id="step-6-visualizing-the-results" class="level3">
<h3 class="anchored" data-anchor-id="step-6-visualizing-the-results">Step 6: Visualizing the Results</h3>
<p>If we were to plot the projected data in this new 2D space, we would see the observations from different classes are better separated, which is the ultimate goal of LDA. The two axes of this 2D space correspond to the two linear discriminants that maximize the separation between the classes.</p>
<div id="f2c456a2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>]])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.array([[<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.848</span>],</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>]])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.dot(X, W)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the projection</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Y.shape[<span class="dv">0</span>]):</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    plt.scatter(Y[i, <span class="dv">0</span>], Y[i, <span class="dv">1</span>], label<span class="op">=</span><span class="ss">f'Obs </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    plt.text(Y[i, <span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.02</span>, Y[i, <span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.02</span>, <span class="ss">f'Obs </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Projected Data after LDA"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'LD1 (First Linear Discriminant)'</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'LD2 (Second Linear Discriminant)'</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>plt.gca().set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-2-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/cell-2-output-1.png" width="670" height="523" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="summary-of-the-process-of-eigenvalue-problem" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-the-process-of-eigenvalue-problem">Summary of the Process of Eigenvalue Problem</h3>
<ol type="1">
<li><strong>Eigenvalue Calculation</strong>: We found the eigenvalues <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> to be the largest, indicating the directions with the most class separability. We did find only two eigenvaleus since total class is 3.</li>
<li><strong>Eigenvector Calculation</strong>: We computed the eigenvectors <span class="math inline">\(\mathbf{w}_1\)</span> and <span class="math inline">\(\mathbf{w}_2\)</span> corresponding to these eigenvalues. These eigenvectors define the directions in the original feature space along which the class separation is maximized.</li>
<li><strong>Projection</strong>: We projected the original dataset onto the new 2D subspace spanned by the eigenvectors. This resulted in a new dataset in 2D, where the different classes are more separable.</li>
</ol>
<p>This completes the detailed walkthrough of solving the eigenvalue problem in LDA for our example dataset.</p>
<hr>
</section>
<section id="final-summary" class="level3">
<h3 class="anchored" data-anchor-id="final-summary">Final Summary</h3>
<ul>
<li><strong>Within-class scatter matrix</strong> <span class="math inline">\(S_W\)</span> quantifies the spread of data points within each class, and we calculated it for each class.</li>
<li><strong>Between-class scatter matrix</strong> <span class="math inline">\(S_B\)</span> quantifies the separation between the class means, and we calculated it using the mean of each class and the overall mean.</li>
<li>Solving the <strong>eigenvalue problem</strong> <span class="math inline">\(S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}\)</span> gives us the directions <span class="math inline">\(\mathbf{w}\)</span> (eigenvectors) that maximize class separation.</li>
</ul>
<p>This is how LDA works step by step, using a small dataset as an example.</p>
</section>
</section>
<section id="python-code-example" class="level2">
<h2 class="anchored" data-anchor-id="python-code-example">Python Code Example</h2>
<p>Let’s now revisit the Python code, with an understanding of the math behind LDA. First build our own classifier</p>
<div id="09c1c08f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomLDA:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,n_components <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">        n_components: int, optional (default=None)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">                      Number of components to keep. If None, all components are kept</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_components <span class="op">=</span> n_components</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvalues <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvectors <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_vectors <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.class_means <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, X, y):</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">        X: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">        y: ndarray of shape (n_samples,)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">           Target labels (must be categorical)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        n_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        class_labels <span class="op">=</span> np.unique(y)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step1: Compute the class means mu_k for each class </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_vectors <span class="op">=</span> []</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> class_labels:</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.mean_vectors.append(np.mean(X[y<span class="op">==</span>c], axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 2: Compute the within-class scatter matrix S_W </span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        S_W <span class="op">=</span> np.zeros((n_features, n_features))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> class_labels:</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            class_scatter <span class="op">=</span> np.cov(X[y<span class="op">==</span>c].T, bias<span class="op">=</span><span class="va">True</span>) <span class="co"># Covariance matrix for each class</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            S_W <span class="op">+=</span> class_scatter <span class="op">*</span> (X[y<span class="op">==</span>c].shape[<span class="dv">0</span>])</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 3: Compute the between-class scatter matrix S_B</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        overall_mean <span class="op">=</span> np.mean(X, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        S_B <span class="op">=</span> np.zeros((n_features, n_features))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i,mean_vector <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.mean_vectors):</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> X[y <span class="op">==</span> class_labels[i]].shape[<span class="dv">0</span>]</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            mean_differences <span class="op">=</span> (mean_vector <span class="op">-</span>overall_mean).reshape(n_features,<span class="dv">1</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            S_B <span class="op">+=</span> n<span class="op">*</span>(mean_differences).dot(mean_differences.T)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 4: Solve the Eigenvalue problem </span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        eigvalues, eigvectors <span class="op">=</span> np.linalg.eig(np.linalg.pinv(S_W).dot(S_B))</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 5: Sort the Eigenvalues and corresponding eigenvectors </span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        eigvalues_sort_idx <span class="op">=</span> np.argsort(np.<span class="bu">abs</span>(eigvalues))[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvalues <span class="op">=</span> eigvalues[eigvalues_sort_idx]</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvectors <span class="op">=</span> eigvectors[:,eigvalues_sort_idx]</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 6: Keep only the top n_components</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.n_components:</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.eigenvectors <span class="op">=</span> <span class="va">self</span>.eigenvectors[:,:<span class="va">self</span>.n_components]</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.class_means <span class="op">=</span> np.dot(<span class="va">self</span>.mean_vectors, <span class="va">self</span>.eigenvectors)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transform(<span class="va">self</span>,X):</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co">        Project the data onto the LDA components </span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">        X: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co">        X_transformed: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.dot(X,<span class="va">self</span>.eigenvectors)</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit_transform(<span class="va">self</span>, X, y):</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co">        Fit the LDA model and transform the data.</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="co">        X : ndarray of shape (n_samples, n_features)</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co">            Training data.</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="co">        y : ndarray of shape (n_samples,)</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="co">            Target labels (must be categorical).</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="co">        X_transformed : ndarray of shape (n_samples, n_components)</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co">            Transformed data after fitting.</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fit(X, y)</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.transform(X)</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, X):</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co">        Predict the class labels for new data points.</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="co">        X : ndarray of shape (n_samples, n_features)</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="co">            New data to classify.</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="co">        Predictions: ndarray of shape (n_samples,)</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="co">                     Predicted class labels</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>        X_projected <span class="op">=</span> <span class="va">self</span>.transform(X)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> []</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> x <span class="kw">in</span> X_projected:</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>            distances <span class="op">=</span> np.linalg.norm(x<span class="op">-</span><span class="va">self</span>.class_means, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>            predictions.append(np.argmin(distances))</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.array(predictions)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> explained_variance_ratio(<span class="va">self</span>):</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a><span class="co">        Return the percentage of variance explained by each of the selected components</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a><span class="co">        explained_variance: ndarray of shape (n_components,)</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="co">                            Percentage of variance explained by each selected components</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> np.<span class="bu">sum</span>(<span class="va">self</span>.eigenvalues)</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(i<span class="op">/</span>total) <span class="cf">for</span> i <span class="kw">in</span> <span class="va">self</span>.eigenvalues[:<span class="va">self</span>.n_components]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next we apply both the custom classifier and the classifier from the <code>scikit-learn</code> library.</p>
<div id="a1577491" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> LinearDiscriminantAnalysis <span class="im">as</span> LDA</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the dataset (optional but often improves performance)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into training and test sets</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply LDA from the scikit-learn library</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>lda1 <span class="op">=</span> LDA(n_components<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Reduce to 2 dimensions</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>X_train_lda1 <span class="op">=</span> lda1.fit_transform(X_train, y_train)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>X_test_lda1 <span class="op">=</span> lda1.transform(X_test)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply LDA from the custom built classifier</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>lda2 <span class="op">=</span> CustomLDA(n_components<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Reduce to 2 dimensions</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>X_train_lda2 <span class="op">=</span> lda2.fit_transform(X_train, y_train)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>X_test_lda2 <span class="op">=</span> lda2.transform(X_test)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the LDA-transformed data</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize<span class="op">=</span>(<span class="fl">9.5</span>,<span class="dv">4</span>))</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X_train_lda1[:, <span class="dv">0</span>], X_train_lda1[:, <span class="dv">1</span>], c<span class="op">=</span>y_train, cmap<span class="op">=</span><span class="st">'rainbow'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'LD1'</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'LD2'</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Scikit-learn'</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(X_train_lda2[:, <span class="dv">0</span>], X_train_lda2[:, <span class="dv">1</span>], c<span class="op">=</span>y_train, cmap<span class="op">=</span><span class="st">'rainbow'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'LD1'</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'LD2'</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Custom'</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'LDA: Projection of the Iris Dataset'</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/hostedtoolcache/Python/3.10.16/x64/lib/python3.10/site-packages/matplotlib/cbook.py:1762: ComplexWarning:

Casting complex values to real discards the imaginary part

/opt/hostedtoolcache/Python/3.10.16/x64/lib/python3.10/site-packages/matplotlib/collections.py:197: ComplexWarning:

Casting complex values to real discards the imaginary part
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-4-output-2.png" width="773" height="394" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Next, apply LDA as a classifiers for the actual classification</p>
<div id="a6473fc4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lda_classifier1 <span class="op">=</span> LDA()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>lda_classifier1.fit(X_train, y_train)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> lda_classifier1.predict(X_test)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>lda_classifier2 <span class="op">=</span> CustomLDA()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>lda_classifier2.fit(X_train, y_train)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> lda_classifier2.predict(X_test)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check accuracy</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>accuracy1 <span class="op">=</span> accuracy_score(y_test, y_pred1)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="op">=</span> accuracy_score(y_test, y_pred2)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'sklearn LDA Classifier Accuracy: </span><span class="sc">{</span>accuracy1 <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% and </span><span class="ch">\n</span><span class="ss">custom LDA Classifier Accuracy: </span><span class="sc">{</span>accuracy2 <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sklearn LDA Classifier Accuracy: 100.00% and 
custom LDA Classifier Accuracy: 95.56%</code></pre>
</div>
</div>
<p>Not too bad, huh! Let’s see the confusion matrix for our custom classifier</p>
<div id="aba29048" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="op">=</span> confusion_matrix(y_test, y_pred2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    conf_mat, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Pred: Setosa'</span>,<span class="st">'Pred: Virginica'</span>, <span class="st">'Pred: Versicolor'</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">'Actual: Setosa'</span>,<span class="st">'Actual: Virginica'</span>, <span class="st">'Actual: Versicolor'</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Pred: Setosa  Pred: Virginica  Pred: Versicolor
Actual: Setosa                19                0                 0
Actual: Virginica              0               11                 2
Actual: Versicolor             0                0                13</code></pre>
</div>
</div>
<hr>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p style="text-align: justify">
Linear Discriminant Analysis (LDA) is a powerful technique for dimensionality reduction and classification. Its goal is to find directions (linear combinations of the original features) that best separate the classes by maximizing between-class variance while minimizing within-class variance.
</p>
<section id="disclaimer" class="level3">
<h3 class="anchored" data-anchor-id="disclaimer">Disclaimer</h3>
<p style="text-align: justify">
For the mathematical explanation, I used generative AI to produce the matrices and vectors and their manipulations. So it won’t be surprising if a calculation mistake is found. The custom python class was created by the help of ChatGPT4
</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li>Fisher, R.A. (1936). “The Use of Multiple Measurements in Taxonomic Problems.” <em>Annals of Eugenics</em>, 7(2), 179–188.<br>
</li>
<li>Murphy, K. P. (2012). <em>Machine Learning: A Probabilistic Perspective</em>. MIT Press.<br>
</li>
<li>Strang, G. (2016). <em>Introduction to Linear Algebra</em> (5th ed.). Wellesley-Cambridge Press.<br>
</li>
<li>Lay, D. C. (2011). <em>Linear Algebra and Its Applications</em> (4th ed.). Pearson.</li>
</ul>
<p><strong>Share on</strong></p>
<div class="columns">
<div class="column" style="width:33%;">
<p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1877F2; text-decoration: none;">
<p><i class="fa-brands fa-facebook fa-3x" aria-label="facebook"></i></p>
</a><p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#0077B5; text-decoration: none;">
<p><i class="fa-brands fa-linkedin fa-3x" aria-label="linkedin"></i></p>
</a><p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1DA1F2; text-decoration: none;">
<p><i class="fa-brands fa-twitter fa-3x" aria-label="twitter"></i></p>
</a><p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p>
</div>
</div>
<script src="https://giscus.app/client.js" data-repo="mrislambd/mrislambd.github.io" data-repo-id="R_kgDOMV8crA" data-category="Announcements" data-category-id="DIC_kwDOMV8crM4CjbQW" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<div id="fb-root">

</div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"></script>
<div class="fb-comments" data-href="https://mrislambd.github.io/dsandml/lda/" data-width="800" data-numposts="5">

</div>
<hr>
<p><strong>You may also like</strong></p>



<!-- -->

</section>

<div class="quarto-listing quarto-listing-container-grid" id="listing-listing">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="TWFjaGluZSUyMExlYXJuaW5nJTJDRGF0YSUyMFNjaWVuY2UlMkNCYXllc2lhbiUyMEluZmVyZW5jZSUyQ0JheWVzaWFuJTIwU3RhdGlzdGljcyUyQ1N0YXRpc3RpY3M=" data-listing-date-sort="1729555200000" data-listing-file-modified-sort="1737518522580" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="12" data-listing-word-count-sort="2300">
<a href="../../dsandml/bayesianclassification/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../dsandml/bayesianclassification/Bayeslearn.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Bayesian Probabilistic Models for Classification
</h5>
<div class="listing-reading-time card-text text-muted">
12 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Tuesday, October 22, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="TWFjaGluZSUyMExlYXJuaW5nJTJDRGF0YSUyMFNjaWVuY2UlMkNCYXllc2lhbiUyMEluZmVyZW5jZSUyQ0JheWVzaWFuJTIwU3RhdGlzdGljcyUyQ1N0YXRpc3RpY3M=" data-listing-date-sort="1733097600000" data-listing-file-modified-sort="1737518522580" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="7" data-listing-word-count-sort="1271">
<a href="../../dsandml/adaboost/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../dsandml/adaboost/ada1.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Boosting Algorithm: Adaptive Boosting Method (AdaBoost)
</h5>
<div class="listing-reading-time card-text text-muted">
7 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Monday, December 2, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="U3RhdGlzdGljcyUyQ0RhdGElMjBTY2llbmNlJTJDRGF0YSUyMEVuZ2luZWVyaW5nJTJDTWFjaGluZSUyMExlYXJuaW5nJTJDQXJ0aWZpY2lhbCUyMEludGVsbGlnZW5jZQ==" data-listing-date-sort="1728518400000" data-listing-file-modified-sort="1737518522651" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="11" data-listing-word-count-sort="2195">
<a href="../../dsandml/naivebayes/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../bayesianclassification/Bayeslearn.png" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Classification using Naive Bayes algorithm
</h5>
<div class="listing-reading-time card-text text-muted">
11 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Thursday, October 10, 2024
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{islam2024,
  author = {Islam, Rafiq},
  title = {Classification: {Linear} {Discriminant} {Analysis} {(LDA)}},
  date = {2024-10-17},
  url = {https://mrislambd.github.io/dsandml/lda/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-islam2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Islam, Rafiq. 2024. <span>“Classification: Linear Discriminant Analysis
(LDA).”</span> October 17, 2024. <a href="https://mrislambd.github.io/dsandml/lda/">https://mrislambd.github.io/dsandml/lda/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mrislambd\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Classification: Linear Discriminant Analysis (LDA)"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-10-17"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Rafiq Islam</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Data Science, Machine Learning, Artificial Intelligence, Data Engineering]</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="an">search:</span><span class="co"> true</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> lda.png</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="an">listing:</span><span class="co"> </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">    contents: "/../../dsandml"</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">    max-items: 3</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">    type: grid</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">    categories: true</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">    date-format: full</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fields: [image, date, title, author, reading-time]  </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">    html: default</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">    ipynb: default</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">    docx: </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">    epub:</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">    pdf: </span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">      pdf-engine: pdflatex</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">      number-sections: false</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">      colorlinks: true</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">      cite-method: biblatex</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">---</span>  </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction  </span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>Linear Discriminant Analysis (LDA) is a supervised machine learning algorithm commonly used for classification tasks. It is widely applied when dealing with datasets where the number of predictors (features) exceeds the number of observations, or when multicollinearity is a concern. LDA works by projecting data onto a lower-dimensional space, maximizing the separation between classes.&lt;/p&gt;</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mathematical Foundation of LDA  </span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>Let’s assume we have a dataset $X \in \mathbb{R}^{n \times p}$ consisting of $n$ data points and $p$ features, and each data point belongs to one of $K$ distinct classes. The goal of LDA is to find a new space (called a discriminant space) in which the classes are maximally separated, i.e. we want to  **maximize the separability between classes** while **minimizing the variation within each class**. This can be mathematically expressed as finding a projection that maximizes the ratio of between-class variance to within-class variance.&lt;/p&gt;</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>For each class $C_k$ (where $k \in <span class="sc">\{</span>1, 2, \dots, K<span class="sc">\}</span>$):  </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu_k$ is the **mean vector** of class $C_k$.  </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ is the **overall mean** of the entire dataset.</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>**Class Mean**: For each class $C_k$, the mean is calculated as:</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>\mu_k = \frac{1}{N_k} \sum_{x_i \in C_k} x_i</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>where $N_k$ is the number of data points in class $C_k$, and $x_i$ represents individual data points.</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>**Overall Mean**: The mean of the entire dataset is:</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>\mu = \frac{1}{n} \sum_{i=1}^{n} x_i</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>To understand how well classes are separated, we need two key measures:  </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Within-Class Scatter Matrix $S_W$**  </span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>   The within-class scatter matrix measures how the data points of each class deviate from the class mean. It captures the **spread of data points within each class**. For class $C_k$, the scatter matrix is calculated as:  </span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    S_W = \sum_{k=1}^{K} \sum_{x_i \in C_k} (x_i - \mu_k)(x_i - \mu_k)^T</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>    This formula is saying that for each class $C_k$, we calculate the distance of every point $x_i$ from the mean of its class $\mu_k$, and then sum these squared distances across all classes.</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Between-Class Scatter Matrix $S_B$**  </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>   The between-class scatter matrix measures how the **class means deviate from the overall mean**. It captures how well-separated the classes are.</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    S_B = \sum_{k=1}^{K} N_k (\mu_k - \mu)(\mu_k - \mu)^T</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    In this case, for each class $C_k$, we calculate the distance between the mean of class $\mu_k$ and the overall mean $\mu$, then scale this by the number of points in class $C_k$.</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>---  </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>LDA aims to find a transformation that maximizes the separation between classes. This is done by finding a linear projection $\mathbf{w}$ such that the **between-class scatter is maximized** and the **within-class scatter is minimized**. Mathematically, the optimization problem becomes:&lt;/p&gt;</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>J(\mathbf{w}) = \frac{\mathbf{w}^T S_B \mathbf{w}}{\mathbf{w}^T S_W \mathbf{w}}</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$S_B \mathbf{w}$ captures the between-class variance (how well-separated the classes are in the new projection).  </span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$S_W \mathbf{w}$ captures the within-class variance (how tightly packed the points of the same class are in the new projection).</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>This ratio $J(\mathbf{w})$ is known as the **Fisher’s discriminant ratio**. The goal is to find $\mathbf{w}$ that maximizes this ratio. To maximize the Fisher’s discriminant ratio, we need to solve the following generalized eigenvalue problem:</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>Here, $\mathbf{w}$ is the vector that defines the linear combination of features that maximizes class separation, and $\lambda$ is an eigenvalue that represents how much variance is explained by that direction.</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>The solution to this equation gives us the eigenvectors (directions) and eigenvalues (variances) of the transformed space. We select the top eigenvectors corresponding to the largest eigenvalues to form the projection matrix $W$.</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dimensionality Reduction</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>The LDA transformation reduces the dimensionality of the data by projecting it onto a subspace spanned by the eigenvectors with the largest eigenvalues. For a dataset with $K$ classes, LDA can reduce the data to at most $K-1$ dimensions because $S_B$ has rank $K-1$.</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;&lt;br&gt;</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>If we have two classes, LDA will reduce the data to a one-dimensional subspace. For three classes, LDA can project the data onto a two-dimensional subspace, and so on.&lt;/p&gt;</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>---  </span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>Now before diving into the python code, let's do some math by hand so that we can understand the skeleton of the process. Let's create a small dataset with 6 features and 4 observations divided into 3 classes. We will use this dataset to manually go through the Linear Discriminant Analysis (LDA) process step by step.</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>| Observation | Feature 1 | Feature 2 | Feature 3 | Feature 4 | Feature 5 | Feature 6 | Class  |</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>|-------------|-----------|-----------|-----------|-----------|-----------|-----------|--------|</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>| $x_1$   | 2         | 3         | 4         | 5         | 6         | 7         | $C_1$ |</span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>| $x_2$   | 3         | 4         | 5         | 6         | 7         | 8         | $C_1$ |</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>| $x_3$   | 6         | 5         | 4         | 3         | 2         | 1         | $C_2$ |</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>| $x_4$   | 7         | 6         | 5         | 4         | 3         | 2         | $C_3$ |</span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>Now, we’ll walk through the mathematical steps of LDA for this small dataset.</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Compute Class Means $\mu_k$ for each class:</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Class $C_1$ (mean of $x_1$ and $x_2$):</span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>  $$</span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>  \mu_1 = \frac{1}{2} \left( \begin{bmatrix} 2 <span class="sc">\\</span> 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 \end{bmatrix} + \begin{bmatrix} 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 <span class="sc">\\</span> 8 \end{bmatrix} \right) = \begin{bmatrix} 2.5 <span class="sc">\\</span> 3.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 5.5 <span class="sc">\\</span> 6.5 <span class="sc">\\</span> 7.5 \end{bmatrix}</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>  $$</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Class $C_2$ (only one observation $x_3$):</span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a> $$</span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>  \mu_2 = \begin{bmatrix} 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 <span class="sc">\\</span> 1 \end{bmatrix}</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a> $$</span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Class $C_3$ (only one observation $x_4$):</span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a> $$</span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>  \mu_3 = \begin{bmatrix} 7 <span class="sc">\\</span> 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 \end{bmatrix}</span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a> $$</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Compute Overall Mean $\mu$:</span></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>We compute the overall mean $\mu$, which is the average of all observations from all classes:</span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>\mu = \frac{1}{4} \left( \begin{bmatrix} 2 <span class="sc">\\</span> 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 \end{bmatrix} + \begin{bmatrix} 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 <span class="sc">\\</span> 8 \end{bmatrix} + \begin{bmatrix} 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 <span class="sc">\\</span> 1 \end{bmatrix} + \begin{bmatrix} 7 <span class="sc">\\</span> 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 \end{bmatrix} \right)= \frac{1}{4} \begin{bmatrix} 18 <span class="sc">\\</span> 18 <span class="sc">\\</span> 18 <span class="sc">\\</span> 18 <span class="sc">\\</span> 18 <span class="sc">\\</span> 18 \end{bmatrix} = \begin{bmatrix} 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 \end{bmatrix}</span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. **Compute the Within-Class Scatter Matrix $S_W$**:</span></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>For each class $C_k$, the within-class scatter matrix $S_W$ is computed as:</span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>S_W = \sum_{k=1}^{K} \sum_{x_i \in C_k} (x_i - \mu_k)(x_i - \mu_k)^T</span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>For $C_1$, the within-class scatter matrix is:</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>(x_1 - \mu_1) = \begin{bmatrix} 2 <span class="sc">\\</span> 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 \end{bmatrix} - \begin{bmatrix} 2.5 <span class="sc">\\</span> 3.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 5.5 <span class="sc">\\</span> 6.5 <span class="sc">\\</span> 7.5 \end{bmatrix} = \begin{bmatrix} -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 \end{bmatrix}; \hspace{6mm} (x_2 - \mu_1) = \begin{bmatrix} 3 <span class="sc">\\</span> 4 <span class="sc">\\</span> 5 <span class="sc">\\</span> 6 <span class="sc">\\</span> 7 <span class="sc">\\</span> 8 \end{bmatrix} - \begin{bmatrix} 2.5 <span class="sc">\\</span> 3.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 5.5 <span class="sc">\\</span> 6.5 <span class="sc">\\</span> 7.5 \end{bmatrix} = \begin{bmatrix} 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 \end{bmatrix}</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a>For class $C_1$, the scatter matrix is:</span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>S_{W1} &amp;= (x_1 - \mu_1)(x_1 - \mu_1)^T + (x_2 - \mu_1)(x_2 - \mu_1)^T<span class="sc">\\</span></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a> &amp;=\begin{bmatrix} -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -0.5 \end{bmatrix} \begin{bmatrix} -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 &amp; -0.5 \end{bmatrix} + \begin{bmatrix} 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> 0.5 \end{bmatrix} \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}<span class="sc">\\</span></span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a> &amp;= \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}</span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>For classes $C_2$ and $C_3$, there is only one data point in each, so there is no within-class scatter:</span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>S_{W2} = 0, \quad S_{W3} = 0</span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>Thus, the total within-class scatter matrix is:</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>S_W = S_{W1} + S_{W2} + S_{W3} = S_{W1}</span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-199"><a href="#cb9-199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a>S_W = \begin{bmatrix} 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 \end{bmatrix}</span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Compute the Between-Class Scatter Matrix $S_B$:</span></span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a>For each class $C_k$, the between-class scatter matrix is computed as:</span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a>S_B = \sum_{k=1}^{K} N_k (\mu_k - \mu)(\mu_k - \mu)^T</span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-211"><a href="#cb9-211" aria-hidden="true" tabindex="-1"></a>For class $C_1$ (where $N_1 = 2$):</span>
<span id="cb9-212"><a href="#cb9-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a>(\mu_1 - \mu) = \begin{bmatrix} 2.5 <span class="sc">\\</span> 3.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 5.5 <span class="sc">\\</span> 6.5 <span class="sc">\\</span> 7.5 \end{bmatrix} - \begin{bmatrix} 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 \end{bmatrix} = \begin{bmatrix} -2 <span class="sc">\\</span> -1 <span class="sc">\\</span> 0 <span class="sc">\\</span> 1 <span class="sc">\\</span> 2 <span class="sc">\\</span> 3 \end{bmatrix}</span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>Thus, for $C_1$:</span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a>S_{B1} &amp;= 2 \begin{bmatrix} -2 <span class="sc">\\</span> -1 <span class="sc">\\</span> 0 <span class="sc">\\</span> 1 <span class="sc">\\</span> 2 <span class="sc">\\</span> 3 \end{bmatrix} \begin{bmatrix} -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 &amp; 3 \end{bmatrix}= 2 \begin{bmatrix} 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 <span class="sc">\\</span> 2 &amp; 1 &amp; 0 &amp; -1 &amp; -2 &amp; -3 <span class="sc">\\</span> 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span> -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 &amp; 3 <span class="sc">\\</span> -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 <span class="sc">\\</span> -6 &amp; -3 &amp; 0 &amp; 3 &amp; 6 &amp; 9 \end{bmatrix}<span class="sc">\\</span></span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>&amp;=\begin{bmatrix} 8 &amp; 4 &amp; 0 &amp; -4 &amp; -8 &amp; -12 <span class="sc">\\</span> 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 <span class="sc">\\</span> 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span> -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 <span class="sc">\\</span> -8 &amp; -4 &amp; 0 &amp; 4 &amp; 8 &amp; 12 <span class="sc">\\</span> -12 &amp; -6 &amp; 0 &amp; 6 &amp; 12 &amp; 18 \end{bmatrix}</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a>For $C_2$ (where $N_2 = 1$):</span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a>(\mu_2 - \mu) = \begin{bmatrix} 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 <span class="sc">\\</span> 1 \end{bmatrix} - \begin{bmatrix} 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 \end{bmatrix} = \begin{bmatrix} 1.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -1.5 <span class="sc">\\</span> -2.5 <span class="sc">\\</span> -3.5 \end{bmatrix}</span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-230"><a href="#cb9-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-231"><a href="#cb9-231" aria-hidden="true" tabindex="-1"></a>The between-class scatter matrix for $C_2$ is:</span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a>S_{B2} &amp;= \begin{bmatrix} 1.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -1.5 <span class="sc">\\</span> -2.5 <span class="sc">\\</span> -3.5 \end{bmatrix} \begin{bmatrix} 1.5 &amp; 0.5 &amp; -0.5 &amp; -1.5 &amp; -2.5 &amp; -3.5 \end{bmatrix}<span class="sc">\\</span></span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a>&amp;= \begin{bmatrix} 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 &amp; -5.25 <span class="sc">\\</span> 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 &amp; -1.75 <span class="sc">\\</span> -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 &amp; 1.75 <span class="sc">\\</span> -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 &amp; 5.25 <span class="sc">\\</span> -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 &amp; 8.75 <span class="sc">\\</span> -5.25 &amp; -1.75 &amp; 1.75 &amp; 5.25 &amp; 8.75 &amp; 12.25 \end{bmatrix}</span>
<span id="cb9-236"><a href="#cb9-236" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-237"><a href="#cb9-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a>For $C_3$ (where $N_3 = 1$):</span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a>(\mu_3 - \mu) = \begin{bmatrix} 7 <span class="sc">\\</span> 6 <span class="sc">\\</span> 5 <span class="sc">\\</span> 4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 2 \end{bmatrix} - \begin{bmatrix} 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 <span class="sc">\\</span> 4.5 \end{bmatrix} = \begin{bmatrix} 2.5 <span class="sc">\\</span> 1.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -1.5 <span class="sc">\\</span> -2.5 \end{bmatrix}</span>
<span id="cb9-243"><a href="#cb9-243" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-244"><a href="#cb9-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-245"><a href="#cb9-245" aria-hidden="true" tabindex="-1"></a>The between-class scatter matrix for $C_3$ is:</span>
<span id="cb9-246"><a href="#cb9-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-247"><a href="#cb9-247" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-248"><a href="#cb9-248" aria-hidden="true" tabindex="-1"></a>S_{B3} &amp;= \begin{bmatrix} 2.5 <span class="sc">\\</span> 1.5 <span class="sc">\\</span> 0.5 <span class="sc">\\</span> -0.5 <span class="sc">\\</span> -1.5 <span class="sc">\\</span> -2.5 \end{bmatrix} \begin{bmatrix} 2.5 &amp; 1.5 &amp; 0.5 &amp; -0.5 &amp; -1.5 &amp; -2.5 \end{bmatrix}<span class="sc">\\</span></span>
<span id="cb9-249"><a href="#cb9-249" aria-hidden="true" tabindex="-1"></a>&amp;=\begin{bmatrix} 6.25 &amp; 3.75 &amp; 1.25 &amp; -1.25 &amp; -3.75 &amp; -6.25 <span class="sc">\\</span> 3.75 &amp; 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 <span class="sc">\\</span> 1.25 &amp; 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 <span class="sc">\\</span> -1.25 &amp; -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 <span class="sc">\\</span> -3.75 &amp; -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 <span class="sc">\\</span> -6.25 &amp; -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 \end{bmatrix}</span>
<span id="cb9-250"><a href="#cb9-250" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-251"><a href="#cb9-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-252"><a href="#cb9-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-253"><a href="#cb9-253" aria-hidden="true" tabindex="-1"></a>Total Between-Class Scatter Matrix $S_B$:</span>
<span id="cb9-254"><a href="#cb9-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-255"><a href="#cb9-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-256"><a href="#cb9-256" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-257"><a href="#cb9-257" aria-hidden="true" tabindex="-1"></a>S_B &amp;= S_{B1} + S_{B2} + S_{B3}<span class="sc">\\</span></span>
<span id="cb9-258"><a href="#cb9-258" aria-hidden="true" tabindex="-1"></a>&amp;=\begin{bmatrix} 8 &amp; 4 &amp; 0 &amp; -4 &amp; -8 &amp; -12 <span class="sc">\\</span> 4 &amp; 2 &amp; 0 &amp; -2 &amp; -4 &amp; -6 <span class="sc">\\</span> 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span> -4 &amp; -2 &amp; 0 &amp; 2 &amp; 4 &amp; 6 <span class="sc">\\</span> -8 &amp; -4 &amp; 0 &amp; 4 &amp; 8 &amp; 12 <span class="sc">\\</span> -12 &amp; -6 &amp; 0 &amp; 6 &amp; 12 &amp; 18 \end{bmatrix} + \begin{bmatrix} 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 &amp; -5.25 <span class="sc">\\</span> 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 &amp; -1.75 <span class="sc">\\</span> -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 &amp; 1.75 <span class="sc">\\</span> -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 &amp; 5.25 <span class="sc">\\</span> -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 &amp; 8.75 <span class="sc">\\</span> -5.25 &amp; -1.75 &amp; 1.75 &amp; 5.25 &amp; 8.75 &amp; 12.25 \end{bmatrix} <span class="sc">\\</span></span>
<span id="cb9-259"><a href="#cb9-259" aria-hidden="true" tabindex="-1"></a>&amp;<span class="sc">\\</span></span>
<span id="cb9-260"><a href="#cb9-260" aria-hidden="true" tabindex="-1"></a>&amp; + \begin{bmatrix} 6.25 &amp; 3.75 &amp; 1.25 &amp; -1.25 &amp; -3.75 &amp; -6.25 <span class="sc">\\</span> 3.75 &amp; 2.25 &amp; 0.75 &amp; -0.75 &amp; -2.25 &amp; -3.75 <span class="sc">\\</span> 1.25 &amp; 0.75 &amp; 0.25 &amp; -0.25 &amp; -0.75 &amp; -1.25 <span class="sc">\\</span> -1.25 &amp; -0.75 &amp; -0.25 &amp; 0.25 &amp; 0.75 &amp; 1.25 <span class="sc">\\</span> -3.75 &amp; -2.25 &amp; -0.75 &amp; 0.75 &amp; 2.25 &amp; 3.75 <span class="sc">\\</span> -6.25 &amp; -3.75 &amp; -1.25 &amp; 1.25 &amp; 3.75 &amp; 6.25 \end{bmatrix}</span>
<span id="cb9-261"><a href="#cb9-261" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-262"><a href="#cb9-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-263"><a href="#cb9-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-264"><a href="#cb9-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-265"><a href="#cb9-265" aria-hidden="true" tabindex="-1"></a>Adding the matrices gives:</span>
<span id="cb9-266"><a href="#cb9-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-267"><a href="#cb9-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-268"><a href="#cb9-268" aria-hidden="true" tabindex="-1"></a>S_B = \begin{bmatrix} 16.5 &amp; 8.5 &amp; 0.5 &amp; -7.5 &amp; -15.5 &amp; -23.5 <span class="sc">\\</span> 8.5 &amp; 4.5 &amp; 0.5 &amp; -3.5 &amp; -7.5 &amp; -11.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> -7.5 &amp; -3.5 &amp; 0.5 &amp; 4.5 &amp; 8.5 &amp; 12.5 <span class="sc">\\</span> -15.5 &amp; -7.5 &amp; 0.5 &amp; 8.5 &amp; 16.5 &amp; 24.5 <span class="sc">\\</span> -23.5 &amp; -11.5 &amp; 0.5 &amp; 12.5 &amp; 24.5 &amp; 36.5 \end{bmatrix}</span>
<span id="cb9-269"><a href="#cb9-269" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-270"><a href="#cb9-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. Solve the Eigenvalue Problem:</span></span>
<span id="cb9-272"><a href="#cb9-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-273"><a href="#cb9-273" aria-hidden="true" tabindex="-1"></a>We now solve the eigenvalue problem:  </span>
<span id="cb9-274"><a href="#cb9-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-275"><a href="#cb9-275" aria-hidden="true" tabindex="-1"></a>S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}</span>
<span id="cb9-276"><a href="#cb9-276" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb9-277"><a href="#cb9-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-278"><a href="#cb9-278" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb9-279"><a href="#cb9-279" aria-hidden="true" tabindex="-1"></a>The solution to this eigenvalue problem gives us the eigenvalues $\lambda$ (which quantify the amount of variance captured in each direction) and the eigenvectors $\mathbf{w}$ (which give the directions of maximum class separation). The eigenvector corresponding to the largest eigenvalue defines the direction of the first discriminant axis, which is the direction that maximally separates the classes.&lt;/p&gt;</span>
<span id="cb9-280"><a href="#cb9-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-281"><a href="#cb9-281" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-282"><a href="#cb9-282" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} </span>
<span id="cb9-283"><a href="#cb9-283" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 <span class="sc">\\</span></span>
<span id="cb9-284"><a href="#cb9-284" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 <span class="sc">\\</span></span>
<span id="cb9-285"><a href="#cb9-285" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 <span class="sc">\\</span></span>
<span id="cb9-286"><a href="#cb9-286" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 <span class="sc">\\</span></span>
<span id="cb9-287"><a href="#cb9-287" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 <span class="sc">\\</span></span>
<span id="cb9-288"><a href="#cb9-288" aria-hidden="true" tabindex="-1"></a>6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 &amp; 6.67 \end{bmatrix}\begin{bmatrix} 16.5 &amp; 8.5 &amp; 0.5 &amp; -7.5 &amp; -15.5 &amp; -23.5 <span class="sc">\\</span> 8.5 &amp; 4.5 &amp; 0.5 &amp; -3.5 &amp; -7.5 &amp; -11.5 <span class="sc">\\</span> 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 <span class="sc">\\</span> -7.5 &amp; -3.5 &amp; 0.5 &amp; 4.5 &amp; 8.5 &amp; 12.5 <span class="sc">\\</span> -15.5 &amp; -7.5 &amp; 0.5 &amp; 8.5 &amp; 16.5 &amp; 24.5 <span class="sc">\\</span> -23.5 &amp; -11.5 &amp; 0.5 &amp; 12.5 &amp; 24.5 &amp; 36.5 \end{bmatrix}\begin{bmatrix}w_1<span class="sc">\\</span>w_2<span class="sc">\\</span>w_3<span class="sc">\\</span>w_4<span class="sc">\\</span>w_5<span class="sc">\\</span>w_6\end{bmatrix}&amp;=\lambda\begin{bmatrix}w_1<span class="sc">\\</span>w_2<span class="sc">\\</span>w_3<span class="sc">\\</span>w_4<span class="sc">\\</span>w_5<span class="sc">\\</span>w_6\end{bmatrix}<span class="sc">\\</span></span>
<span id="cb9-289"><a href="#cb9-289" aria-hidden="true" tabindex="-1"></a>\implies \begin{bmatrix} </span>
<span id="cb9-290"><a href="#cb9-290" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 <span class="sc">\\</span></span>
<span id="cb9-291"><a href="#cb9-291" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 <span class="sc">\\</span></span>
<span id="cb9-292"><a href="#cb9-292" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 <span class="sc">\\</span></span>
<span id="cb9-293"><a href="#cb9-293" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 <span class="sc">\\</span></span>
<span id="cb9-294"><a href="#cb9-294" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 <span class="sc">\\</span></span>
<span id="cb9-295"><a href="#cb9-295" aria-hidden="true" tabindex="-1"></a>-2.33 &amp; -1.00 &amp; 0.33 &amp; 1.67 &amp; 3.00 &amp; 4.33 \end{bmatrix}\begin{bmatrix}w_1<span class="sc">\\</span>w_2<span class="sc">\\</span>w_3<span class="sc">\\</span>w_4<span class="sc">\\</span>w_5<span class="sc">\\</span>w_6\end{bmatrix}&amp;=\lambda\begin{bmatrix}w_1<span class="sc">\\</span>w_2<span class="sc">\\</span>w_3<span class="sc">\\</span>w_4<span class="sc">\\</span>w_5<span class="sc">\\</span>w_6\end{bmatrix}</span>
<span id="cb9-296"><a href="#cb9-296" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-297"><a href="#cb9-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-298"><a href="#cb9-298" aria-hidden="true" tabindex="-1"></a>The eigenvalues of the matrix are:</span>
<span id="cb9-299"><a href="#cb9-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-300"><a href="#cb9-300" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-301"><a href="#cb9-301" aria-hidden="true" tabindex="-1"></a>\lambda_1 = 6.00, \quad \lambda_2 = 1.78 \times 10^{-15}, \quad \lambda_3 = 9.86 \times 10^{-32}, \quad \lambda_4 = 0.00, \quad \lambda_5 = -5.47 \times 10^{-48}, \quad \lambda_6 = -5.95 \times 10^{-16}</span>
<span id="cb9-302"><a href="#cb9-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-303"><a href="#cb9-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-304"><a href="#cb9-304" aria-hidden="true" tabindex="-1"></a>The two largest eigenvalues are:</span>
<span id="cb9-305"><a href="#cb9-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-306"><a href="#cb9-306" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$\lambda_1 = 6.00$</span>
<span id="cb9-307"><a href="#cb9-307" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$\lambda_2 = 1.78 \times 10^{-15}$</span>
<span id="cb9-308"><a href="#cb9-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-309"><a href="#cb9-309" aria-hidden="true" tabindex="-1"></a>The corresponding eigenvectors for the two largest eigenvalues are:</span>
<span id="cb9-310"><a href="#cb9-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-312"><a href="#cb9-312" aria-hidden="true" tabindex="-1"></a>\mathbf{w_1} = \begin{bmatrix} </span>
<span id="cb9-313"><a href="#cb9-313" aria-hidden="true" tabindex="-1"></a>-0.408 <span class="sc">\\</span></span>
<span id="cb9-314"><a href="#cb9-314" aria-hidden="true" tabindex="-1"></a>-0.408 <span class="sc">\\</span></span>
<span id="cb9-315"><a href="#cb9-315" aria-hidden="true" tabindex="-1"></a>-0.408 <span class="sc">\\</span></span>
<span id="cb9-316"><a href="#cb9-316" aria-hidden="true" tabindex="-1"></a>-0.408 <span class="sc">\\</span></span>
<span id="cb9-317"><a href="#cb9-317" aria-hidden="true" tabindex="-1"></a>-0.408 <span class="sc">\\</span></span>
<span id="cb9-318"><a href="#cb9-318" aria-hidden="true" tabindex="-1"></a>-0.408 \end{bmatrix}, \quad</span>
<span id="cb9-319"><a href="#cb9-319" aria-hidden="true" tabindex="-1"></a>\mathbf{w_2} = \begin{bmatrix} </span>
<span id="cb9-320"><a href="#cb9-320" aria-hidden="true" tabindex="-1"></a>-0.848 <span class="sc">\\</span></span>
<span id="cb9-321"><a href="#cb9-321" aria-hidden="true" tabindex="-1"></a>-0.237 <span class="sc">\\</span></span>
<span id="cb9-322"><a href="#cb9-322" aria-hidden="true" tabindex="-1"></a>-0.237 <span class="sc">\\</span></span>
<span id="cb9-323"><a href="#cb9-323" aria-hidden="true" tabindex="-1"></a>-0.237 <span class="sc">\\</span></span>
<span id="cb9-324"><a href="#cb9-324" aria-hidden="true" tabindex="-1"></a>-0.237 <span class="sc">\\</span></span>
<span id="cb9-325"><a href="#cb9-325" aria-hidden="true" tabindex="-1"></a>-0.237 \end{bmatrix}</span>
<span id="cb9-326"><a href="#cb9-326" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-327"><a href="#cb9-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-328"><a href="#cb9-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-329"><a href="#cb9-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-330"><a href="#cb9-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-331"><a href="#cb9-331" aria-hidden="true" tabindex="-1"></a>By projecting the data onto the eigenvector $\mathbf{w}$, we transform the original dataset into a lower-dimensional space where class separability is maximized. For this dataset, since there are 3 classes, LDA will find up to $K-1 = 2$ discriminant axes. Let's see how. </span>
<span id="cb9-332"><a href="#cb9-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-333"><a href="#cb9-333" aria-hidden="true" tabindex="-1"></a>The matrix formed by the two largest eigenvectors is:</span>
<span id="cb9-334"><a href="#cb9-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-335"><a href="#cb9-335" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-336"><a href="#cb9-336" aria-hidden="true" tabindex="-1"></a>W=\begin{bmatrix} </span>
<span id="cb9-337"><a href="#cb9-337" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.848 <span class="sc">\\</span></span>
<span id="cb9-338"><a href="#cb9-338" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-339"><a href="#cb9-339" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-340"><a href="#cb9-340" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-341"><a href="#cb9-341" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-342"><a href="#cb9-342" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 \end{bmatrix}</span>
<span id="cb9-343"><a href="#cb9-343" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-344"><a href="#cb9-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-345"><a href="#cb9-345" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-346"><a href="#cb9-346" aria-hidden="true" tabindex="-1"></a>This matrix represents the projection directions corresponding to the two largest eigenvalues in the Linear Discriminant Analysis process. With the eigenvectors $\mathbf{w}_1$ and $\mathbf{w}_2$, we can now project our original dataset onto the new 2D subspace.</span>
<span id="cb9-347"><a href="#cb9-347" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;&lt;br&gt;</span>
<span id="cb9-348"><a href="#cb9-348" aria-hidden="true" tabindex="-1"></a>Now, let $X$ represent our original dataset (where each row corresponds to an observation and each column to a feature). The projection of the original data onto the new 2D subspace is given by:&lt;/p&gt;</span>
<span id="cb9-349"><a href="#cb9-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-350"><a href="#cb9-350" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-351"><a href="#cb9-351" aria-hidden="true" tabindex="-1"></a>Y = X W</span>
<span id="cb9-352"><a href="#cb9-352" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-353"><a href="#cb9-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-354"><a href="#cb9-354" aria-hidden="true" tabindex="-1"></a>Where:  </span>
<span id="cb9-355"><a href="#cb9-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-356"><a href="#cb9-356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X$ is the $4 \times 6$ matrix (4 observations, 6 features),</span>
<span id="cb9-357"><a href="#cb9-357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$W$ is the $6 \times 2$ matrix of eigenvectors.</span>
<span id="cb9-358"><a href="#cb9-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-359"><a href="#cb9-359" aria-hidden="true" tabindex="-1"></a>After multiplying $X$ by $W$, we obtain the projected data matrix $Y$, which is a $4 \times 2$ matrix (4 observations, 2 features):</span>
<span id="cb9-360"><a href="#cb9-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-361"><a href="#cb9-361" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-362"><a href="#cb9-362" aria-hidden="true" tabindex="-1"></a>Y = \begin{bmatrix}</span>
<span id="cb9-363"><a href="#cb9-363" aria-hidden="true" tabindex="-1"></a>y_{11} &amp; y_{12} <span class="sc">\\</span></span>
<span id="cb9-364"><a href="#cb9-364" aria-hidden="true" tabindex="-1"></a>y_{21} &amp; y_{22} <span class="sc">\\</span></span>
<span id="cb9-365"><a href="#cb9-365" aria-hidden="true" tabindex="-1"></a>y_{31} &amp; y_{32} <span class="sc">\\</span></span>
<span id="cb9-366"><a href="#cb9-366" aria-hidden="true" tabindex="-1"></a>y_{41} &amp; y_{42}</span>
<span id="cb9-367"><a href="#cb9-367" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb9-368"><a href="#cb9-368" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-369"><a href="#cb9-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-370"><a href="#cb9-370" aria-hidden="true" tabindex="-1"></a>This matrix $Y$ represents the data in the new 2D space where class separability is maximized. So for our data  </span>
<span id="cb9-371"><a href="#cb9-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-372"><a href="#cb9-372" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb9-373"><a href="#cb9-373" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}2&amp;3&amp;4&amp;5&amp;6&amp;7<span class="sc">\\</span>3&amp;4&amp;5&amp;6&amp;7&amp;8<span class="sc">\\</span>6&amp;5&amp;4&amp;3&amp;2&amp;1<span class="sc">\\</span>7&amp;6&amp;5&amp;4&amp;3&amp;2\end{bmatrix}\begin{bmatrix} </span>
<span id="cb9-374"><a href="#cb9-374" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.848 <span class="sc">\\</span></span>
<span id="cb9-375"><a href="#cb9-375" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-376"><a href="#cb9-376" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-377"><a href="#cb9-377" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-378"><a href="#cb9-378" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 <span class="sc">\\</span></span>
<span id="cb9-379"><a href="#cb9-379" aria-hidden="true" tabindex="-1"></a>-0.408 &amp; -0.237 \end{bmatrix}&amp;=\begin{bmatrix}-11.016 &amp; -7.621<span class="sc">\\</span>-13.464 &amp; -9.654<span class="sc">\\</span> -8.568 &amp; -8.643<span class="sc">\\</span>-11.016 &amp;-10.676\end{bmatrix}</span>
<span id="cb9-380"><a href="#cb9-380" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb9-381"><a href="#cb9-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-382"><a href="#cb9-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-383"><a href="#cb9-383" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Visualizing the Results</span></span>
<span id="cb9-384"><a href="#cb9-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-385"><a href="#cb9-385" aria-hidden="true" tabindex="-1"></a>If we were to plot the projected data in this new 2D space, we would see the observations from different classes are better separated, which is the ultimate goal of LDA. The two axes of this 2D space correspond to the two linear discriminants that maximize the separation between the classes.</span>
<span id="cb9-386"><a href="#cb9-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-389"><a href="#cb9-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-390"><a href="#cb9-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb9-391"><a href="#cb9-391" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-392"><a href="#cb9-392" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-393"><a href="#cb9-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-394"><a href="#cb9-394" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>],</span>
<span id="cb9-395"><a href="#cb9-395" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>],</span>
<span id="cb9-396"><a href="#cb9-396" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb9-397"><a href="#cb9-397" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>]])</span>
<span id="cb9-398"><a href="#cb9-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-399"><a href="#cb9-399" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.array([[<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.848</span>],</span>
<span id="cb9-400"><a href="#cb9-400" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb9-401"><a href="#cb9-401" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb9-402"><a href="#cb9-402" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb9-403"><a href="#cb9-403" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>],</span>
<span id="cb9-404"><a href="#cb9-404" aria-hidden="true" tabindex="-1"></a>                         [<span class="op">-</span><span class="fl">0.408</span>, <span class="op">-</span><span class="fl">0.237</span>]])</span>
<span id="cb9-405"><a href="#cb9-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-406"><a href="#cb9-406" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.dot(X, W)</span>
<span id="cb9-407"><a href="#cb9-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-408"><a href="#cb9-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the projection</span></span>
<span id="cb9-409"><a href="#cb9-409" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb9-410"><a href="#cb9-410" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Y.shape[<span class="dv">0</span>]):</span>
<span id="cb9-411"><a href="#cb9-411" aria-hidden="true" tabindex="-1"></a>    plt.scatter(Y[i, <span class="dv">0</span>], Y[i, <span class="dv">1</span>], label<span class="op">=</span><span class="ss">f'Obs </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb9-412"><a href="#cb9-412" aria-hidden="true" tabindex="-1"></a>    plt.text(Y[i, <span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.02</span>, Y[i, <span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.02</span>, <span class="ss">f'Obs </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-413"><a href="#cb9-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-414"><a href="#cb9-414" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Projected Data after LDA"</span>)</span>
<span id="cb9-415"><a href="#cb9-415" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'LD1 (First Linear Discriminant)'</span>)</span>
<span id="cb9-416"><a href="#cb9-416" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'LD2 (Second Linear Discriminant)'</span>)</span>
<span id="cb9-417"><a href="#cb9-417" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-418"><a href="#cb9-418" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-419"><a href="#cb9-419" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb9-420"><a href="#cb9-420" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb9-421"><a href="#cb9-421" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb9-422"><a href="#cb9-422" aria-hidden="true" tabindex="-1"></a>plt.gca().set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb9-423"><a href="#cb9-423" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-424"><a href="#cb9-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-425"><a href="#cb9-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-426"><a href="#cb9-426" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb9-427"><a href="#cb9-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-428"><a href="#cb9-428" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of the Process of Eigenvalue Problem</span></span>
<span id="cb9-429"><a href="#cb9-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-430"><a href="#cb9-430" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Eigenvalue Calculation**: We found the eigenvalues $\lambda_1$ and $\lambda_2$ to be the largest, indicating the directions with the most class separability. We did find only two eigenvaleus since total class is 3.</span>
<span id="cb9-431"><a href="#cb9-431" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Eigenvector Calculation**: We computed the eigenvectors $\mathbf{w}_1$ and $\mathbf{w}_2$ corresponding to these eigenvalues. These eigenvectors define the directions in the original feature space along which the class separation is maximized.</span>
<span id="cb9-432"><a href="#cb9-432" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Projection**: We projected the original dataset onto the new 2D subspace spanned by the eigenvectors. This resulted in a new dataset in 2D, where the different classes are more separable.</span>
<span id="cb9-433"><a href="#cb9-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-434"><a href="#cb9-434" aria-hidden="true" tabindex="-1"></a>This completes the detailed walkthrough of solving the eigenvalue problem in LDA for our example dataset.</span>
<span id="cb9-435"><a href="#cb9-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-436"><a href="#cb9-436" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb9-437"><a href="#cb9-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-438"><a href="#cb9-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Summary</span></span>
<span id="cb9-439"><a href="#cb9-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-440"><a href="#cb9-440" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Within-class scatter matrix** $S_W$ quantifies the spread of data points within each class, and we calculated it for each class.</span>
<span id="cb9-441"><a href="#cb9-441" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Between-class scatter matrix** $S_B$ quantifies the separation between the class means, and we calculated it using the mean of each class and the overall mean.</span>
<span id="cb9-442"><a href="#cb9-442" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Solving the **eigenvalue problem** $S_W^{-1} S_B \mathbf{w} = \lambda \mathbf{w}$ gives us the directions $\mathbf{w}$ (eigenvectors) that maximize class separation.</span>
<span id="cb9-443"><a href="#cb9-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-444"><a href="#cb9-444" aria-hidden="true" tabindex="-1"></a>This is how LDA works step by step, using a small dataset as an example.</span>
<span id="cb9-445"><a href="#cb9-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-446"><a href="#cb9-446" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Code Example</span></span>
<span id="cb9-447"><a href="#cb9-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-448"><a href="#cb9-448" aria-hidden="true" tabindex="-1"></a>Let’s now revisit the Python code, with an understanding of the math behind LDA. First build our own classifier  </span>
<span id="cb9-449"><a href="#cb9-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-452"><a href="#cb9-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-453"><a href="#cb9-453" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomLDA:</span>
<span id="cb9-454"><a href="#cb9-454" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,n_components <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb9-455"><a href="#cb9-455" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-456"><a href="#cb9-456" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-457"><a href="#cb9-457" aria-hidden="true" tabindex="-1"></a><span class="co">        n_components: int, optional (default=None)</span></span>
<span id="cb9-458"><a href="#cb9-458" aria-hidden="true" tabindex="-1"></a><span class="co">                      Number of components to keep. If None, all components are kept</span></span>
<span id="cb9-459"><a href="#cb9-459" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-460"><a href="#cb9-460" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_components <span class="op">=</span> n_components</span>
<span id="cb9-461"><a href="#cb9-461" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvalues <span class="op">=</span> <span class="va">None</span></span>
<span id="cb9-462"><a href="#cb9-462" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvectors <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb9-463"><a href="#cb9-463" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_vectors <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb9-464"><a href="#cb9-464" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.class_means <span class="op">=</span> <span class="va">None</span></span>
<span id="cb9-465"><a href="#cb9-465" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-466"><a href="#cb9-466" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, X, y):</span>
<span id="cb9-467"><a href="#cb9-467" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-468"><a href="#cb9-468" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-469"><a href="#cb9-469" aria-hidden="true" tabindex="-1"></a><span class="co">        X: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb9-470"><a href="#cb9-470" aria-hidden="true" tabindex="-1"></a><span class="co">        y: ndarray of shape (n_samples,)</span></span>
<span id="cb9-471"><a href="#cb9-471" aria-hidden="true" tabindex="-1"></a><span class="co">           Target labels (must be categorical)</span></span>
<span id="cb9-472"><a href="#cb9-472" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-473"><a href="#cb9-473" aria-hidden="true" tabindex="-1"></a>        n_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb9-474"><a href="#cb9-474" aria-hidden="true" tabindex="-1"></a>        class_labels <span class="op">=</span> np.unique(y)</span>
<span id="cb9-475"><a href="#cb9-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-476"><a href="#cb9-476" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step1: Compute the class means mu_k for each class </span></span>
<span id="cb9-477"><a href="#cb9-477" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_vectors <span class="op">=</span> []</span>
<span id="cb9-478"><a href="#cb9-478" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> class_labels:</span>
<span id="cb9-479"><a href="#cb9-479" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.mean_vectors.append(np.mean(X[y<span class="op">==</span>c], axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb9-480"><a href="#cb9-480" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-481"><a href="#cb9-481" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 2: Compute the within-class scatter matrix S_W </span></span>
<span id="cb9-482"><a href="#cb9-482" aria-hidden="true" tabindex="-1"></a>        S_W <span class="op">=</span> np.zeros((n_features, n_features))</span>
<span id="cb9-483"><a href="#cb9-483" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> class_labels:</span>
<span id="cb9-484"><a href="#cb9-484" aria-hidden="true" tabindex="-1"></a>            class_scatter <span class="op">=</span> np.cov(X[y<span class="op">==</span>c].T, bias<span class="op">=</span><span class="va">True</span>) <span class="co"># Covariance matrix for each class</span></span>
<span id="cb9-485"><a href="#cb9-485" aria-hidden="true" tabindex="-1"></a>            S_W <span class="op">+=</span> class_scatter <span class="op">*</span> (X[y<span class="op">==</span>c].shape[<span class="dv">0</span>])</span>
<span id="cb9-486"><a href="#cb9-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-487"><a href="#cb9-487" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 3: Compute the between-class scatter matrix S_B</span></span>
<span id="cb9-488"><a href="#cb9-488" aria-hidden="true" tabindex="-1"></a>        overall_mean <span class="op">=</span> np.mean(X, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-489"><a href="#cb9-489" aria-hidden="true" tabindex="-1"></a>        S_B <span class="op">=</span> np.zeros((n_features, n_features))</span>
<span id="cb9-490"><a href="#cb9-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-491"><a href="#cb9-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-492"><a href="#cb9-492" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i,mean_vector <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.mean_vectors):</span>
<span id="cb9-493"><a href="#cb9-493" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> X[y <span class="op">==</span> class_labels[i]].shape[<span class="dv">0</span>]</span>
<span id="cb9-494"><a href="#cb9-494" aria-hidden="true" tabindex="-1"></a>            mean_differences <span class="op">=</span> (mean_vector <span class="op">-</span>overall_mean).reshape(n_features,<span class="dv">1</span>)</span>
<span id="cb9-495"><a href="#cb9-495" aria-hidden="true" tabindex="-1"></a>            S_B <span class="op">+=</span> n<span class="op">*</span>(mean_differences).dot(mean_differences.T)</span>
<span id="cb9-496"><a href="#cb9-496" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-497"><a href="#cb9-497" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 4: Solve the Eigenvalue problem </span></span>
<span id="cb9-498"><a href="#cb9-498" aria-hidden="true" tabindex="-1"></a>        eigvalues, eigvectors <span class="op">=</span> np.linalg.eig(np.linalg.pinv(S_W).dot(S_B))</span>
<span id="cb9-499"><a href="#cb9-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-500"><a href="#cb9-500" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 5: Sort the Eigenvalues and corresponding eigenvectors </span></span>
<span id="cb9-501"><a href="#cb9-501" aria-hidden="true" tabindex="-1"></a>        eigvalues_sort_idx <span class="op">=</span> np.argsort(np.<span class="bu">abs</span>(eigvalues))[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-502"><a href="#cb9-502" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvalues <span class="op">=</span> eigvalues[eigvalues_sort_idx]</span>
<span id="cb9-503"><a href="#cb9-503" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eigenvectors <span class="op">=</span> eigvectors[:,eigvalues_sort_idx]</span>
<span id="cb9-504"><a href="#cb9-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-505"><a href="#cb9-505" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 6: Keep only the top n_components</span></span>
<span id="cb9-506"><a href="#cb9-506" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.n_components:</span>
<span id="cb9-507"><a href="#cb9-507" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.eigenvectors <span class="op">=</span> <span class="va">self</span>.eigenvectors[:,:<span class="va">self</span>.n_components]</span>
<span id="cb9-508"><a href="#cb9-508" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-509"><a href="#cb9-509" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.class_means <span class="op">=</span> np.dot(<span class="va">self</span>.mean_vectors, <span class="va">self</span>.eigenvectors)</span>
<span id="cb9-510"><a href="#cb9-510" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-511"><a href="#cb9-511" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transform(<span class="va">self</span>,X):</span>
<span id="cb9-512"><a href="#cb9-512" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-513"><a href="#cb9-513" aria-hidden="true" tabindex="-1"></a><span class="co">        Project the data onto the LDA components </span></span>
<span id="cb9-514"><a href="#cb9-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-515"><a href="#cb9-515" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-516"><a href="#cb9-516" aria-hidden="true" tabindex="-1"></a><span class="co">        X: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb9-517"><a href="#cb9-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-518"><a href="#cb9-518" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb9-519"><a href="#cb9-519" aria-hidden="true" tabindex="-1"></a><span class="co">        X_transformed: ndarray of shape (n_samples, n_features)</span></span>
<span id="cb9-520"><a href="#cb9-520" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-521"><a href="#cb9-521" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.dot(X,<span class="va">self</span>.eigenvectors)</span>
<span id="cb9-522"><a href="#cb9-522" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-523"><a href="#cb9-523" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit_transform(<span class="va">self</span>, X, y):</span>
<span id="cb9-524"><a href="#cb9-524" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-525"><a href="#cb9-525" aria-hidden="true" tabindex="-1"></a><span class="co">        Fit the LDA model and transform the data.</span></span>
<span id="cb9-526"><a href="#cb9-526" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb9-527"><a href="#cb9-527" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-528"><a href="#cb9-528" aria-hidden="true" tabindex="-1"></a><span class="co">        X : ndarray of shape (n_samples, n_features)</span></span>
<span id="cb9-529"><a href="#cb9-529" aria-hidden="true" tabindex="-1"></a><span class="co">            Training data.</span></span>
<span id="cb9-530"><a href="#cb9-530" aria-hidden="true" tabindex="-1"></a><span class="co">        y : ndarray of shape (n_samples,)</span></span>
<span id="cb9-531"><a href="#cb9-531" aria-hidden="true" tabindex="-1"></a><span class="co">            Target labels (must be categorical).</span></span>
<span id="cb9-532"><a href="#cb9-532" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb9-533"><a href="#cb9-533" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb9-534"><a href="#cb9-534" aria-hidden="true" tabindex="-1"></a><span class="co">        X_transformed : ndarray of shape (n_samples, n_components)</span></span>
<span id="cb9-535"><a href="#cb9-535" aria-hidden="true" tabindex="-1"></a><span class="co">            Transformed data after fitting.</span></span>
<span id="cb9-536"><a href="#cb9-536" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-537"><a href="#cb9-537" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fit(X, y)</span>
<span id="cb9-538"><a href="#cb9-538" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.transform(X)</span>
<span id="cb9-539"><a href="#cb9-539" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-540"><a href="#cb9-540" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, X):</span>
<span id="cb9-541"><a href="#cb9-541" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-542"><a href="#cb9-542" aria-hidden="true" tabindex="-1"></a><span class="co">        Predict the class labels for new data points.</span></span>
<span id="cb9-543"><a href="#cb9-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-544"><a href="#cb9-544" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-545"><a href="#cb9-545" aria-hidden="true" tabindex="-1"></a><span class="co">        X : ndarray of shape (n_samples, n_features)</span></span>
<span id="cb9-546"><a href="#cb9-546" aria-hidden="true" tabindex="-1"></a><span class="co">            New data to classify.</span></span>
<span id="cb9-547"><a href="#cb9-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-548"><a href="#cb9-548" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb9-549"><a href="#cb9-549" aria-hidden="true" tabindex="-1"></a><span class="co">        Predictions: ndarray of shape (n_samples,)</span></span>
<span id="cb9-550"><a href="#cb9-550" aria-hidden="true" tabindex="-1"></a><span class="co">                     Predicted class labels</span></span>
<span id="cb9-551"><a href="#cb9-551" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-552"><a href="#cb9-552" aria-hidden="true" tabindex="-1"></a>        X_projected <span class="op">=</span> <span class="va">self</span>.transform(X)</span>
<span id="cb9-553"><a href="#cb9-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-554"><a href="#cb9-554" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> []</span>
<span id="cb9-555"><a href="#cb9-555" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> x <span class="kw">in</span> X_projected:</span>
<span id="cb9-556"><a href="#cb9-556" aria-hidden="true" tabindex="-1"></a>            distances <span class="op">=</span> np.linalg.norm(x<span class="op">-</span><span class="va">self</span>.class_means, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-557"><a href="#cb9-557" aria-hidden="true" tabindex="-1"></a>            predictions.append(np.argmin(distances))</span>
<span id="cb9-558"><a href="#cb9-558" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-559"><a href="#cb9-559" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.array(predictions)</span>
<span id="cb9-560"><a href="#cb9-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-561"><a href="#cb9-561" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-562"><a href="#cb9-562" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> explained_variance_ratio(<span class="va">self</span>):</span>
<span id="cb9-563"><a href="#cb9-563" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb9-564"><a href="#cb9-564" aria-hidden="true" tabindex="-1"></a><span class="co">        Return the percentage of variance explained by each of the selected components</span></span>
<span id="cb9-565"><a href="#cb9-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-566"><a href="#cb9-566" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb9-567"><a href="#cb9-567" aria-hidden="true" tabindex="-1"></a><span class="co">        explained_variance: ndarray of shape (n_components,)</span></span>
<span id="cb9-568"><a href="#cb9-568" aria-hidden="true" tabindex="-1"></a><span class="co">                            Percentage of variance explained by each selected components</span></span>
<span id="cb9-569"><a href="#cb9-569" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb9-570"><a href="#cb9-570" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> np.<span class="bu">sum</span>(<span class="va">self</span>.eigenvalues)</span>
<span id="cb9-571"><a href="#cb9-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-572"><a href="#cb9-572" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(i<span class="op">/</span>total) <span class="cf">for</span> i <span class="kw">in</span> <span class="va">self</span>.eigenvalues[:<span class="va">self</span>.n_components]]</span>
<span id="cb9-573"><a href="#cb9-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb9-574"><a href="#cb9-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-575"><a href="#cb9-575" aria-hidden="true" tabindex="-1"></a>Next we apply both the custom classifier and the classifier from the <span class="in">`scikit-learn`</span> library.</span>
<span id="cb9-576"><a href="#cb9-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-579"><a href="#cb9-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-580"><a href="#cb9-580" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-581"><a href="#cb9-581" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb9-582"><a href="#cb9-582" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb9-583"><a href="#cb9-583" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> LinearDiscriminantAnalysis <span class="im">as</span> LDA</span>
<span id="cb9-584"><a href="#cb9-584" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb9-585"><a href="#cb9-585" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb9-586"><a href="#cb9-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-587"><a href="#cb9-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb9-588"><a href="#cb9-588" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb9-589"><a href="#cb9-589" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data</span>
<span id="cb9-590"><a href="#cb9-590" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb9-591"><a href="#cb9-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-592"><a href="#cb9-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the dataset (optional but often improves performance)</span></span>
<span id="cb9-593"><a href="#cb9-593" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb9-594"><a href="#cb9-594" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb9-595"><a href="#cb9-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-596"><a href="#cb9-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into training and test sets</span></span>
<span id="cb9-597"><a href="#cb9-597" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-598"><a href="#cb9-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-599"><a href="#cb9-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply LDA from the scikit-learn library</span></span>
<span id="cb9-600"><a href="#cb9-600" aria-hidden="true" tabindex="-1"></a>lda1 <span class="op">=</span> LDA(n_components<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Reduce to 2 dimensions</span></span>
<span id="cb9-601"><a href="#cb9-601" aria-hidden="true" tabindex="-1"></a>X_train_lda1 <span class="op">=</span> lda1.fit_transform(X_train, y_train)</span>
<span id="cb9-602"><a href="#cb9-602" aria-hidden="true" tabindex="-1"></a>X_test_lda1 <span class="op">=</span> lda1.transform(X_test)</span>
<span id="cb9-603"><a href="#cb9-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-604"><a href="#cb9-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply LDA from the custom built classifier</span></span>
<span id="cb9-605"><a href="#cb9-605" aria-hidden="true" tabindex="-1"></a>lda2 <span class="op">=</span> CustomLDA(n_components<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Reduce to 2 dimensions</span></span>
<span id="cb9-606"><a href="#cb9-606" aria-hidden="true" tabindex="-1"></a>X_train_lda2 <span class="op">=</span> lda2.fit_transform(X_train, y_train)</span>
<span id="cb9-607"><a href="#cb9-607" aria-hidden="true" tabindex="-1"></a>X_test_lda2 <span class="op">=</span> lda2.transform(X_test)</span>
<span id="cb9-608"><a href="#cb9-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-609"><a href="#cb9-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the LDA-transformed data</span></span>
<span id="cb9-610"><a href="#cb9-610" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize<span class="op">=</span>(<span class="fl">9.5</span>,<span class="dv">4</span>))</span>
<span id="cb9-611"><a href="#cb9-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-612"><a href="#cb9-612" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X_train_lda1[:, <span class="dv">0</span>], X_train_lda1[:, <span class="dv">1</span>], c<span class="op">=</span>y_train, cmap<span class="op">=</span><span class="st">'rainbow'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb9-613"><a href="#cb9-613" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'LD1'</span>)</span>
<span id="cb9-614"><a href="#cb9-614" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'LD2'</span>)</span>
<span id="cb9-615"><a href="#cb9-615" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Scikit-learn'</span>)</span>
<span id="cb9-616"><a href="#cb9-616" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(X_train_lda2[:, <span class="dv">0</span>], X_train_lda2[:, <span class="dv">1</span>], c<span class="op">=</span>y_train, cmap<span class="op">=</span><span class="st">'rainbow'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb9-617"><a href="#cb9-617" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'LD1'</span>)</span>
<span id="cb9-618"><a href="#cb9-618" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'LD2'</span>)</span>
<span id="cb9-619"><a href="#cb9-619" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Custom'</span>)</span>
<span id="cb9-620"><a href="#cb9-620" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb9-621"><a href="#cb9-621" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb9-622"><a href="#cb9-622" aria-hidden="true" tabindex="-1"></a>plt.gcf().patch.set_facecolor(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb9-623"><a href="#cb9-623" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'LDA: Projection of the Iris Dataset'</span>)</span>
<span id="cb9-624"><a href="#cb9-624" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-625"><a href="#cb9-625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb9-626"><a href="#cb9-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-627"><a href="#cb9-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-628"><a href="#cb9-628" aria-hidden="true" tabindex="-1"></a>Next, apply LDA as a classifiers for the actual classification  </span>
<span id="cb9-629"><a href="#cb9-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-632"><a href="#cb9-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-633"><a href="#cb9-633" aria-hidden="true" tabindex="-1"></a>lda_classifier1 <span class="op">=</span> LDA()</span>
<span id="cb9-634"><a href="#cb9-634" aria-hidden="true" tabindex="-1"></a>lda_classifier1.fit(X_train, y_train)</span>
<span id="cb9-635"><a href="#cb9-635" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> lda_classifier1.predict(X_test)</span>
<span id="cb9-636"><a href="#cb9-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-637"><a href="#cb9-637" aria-hidden="true" tabindex="-1"></a>lda_classifier2 <span class="op">=</span> CustomLDA()</span>
<span id="cb9-638"><a href="#cb9-638" aria-hidden="true" tabindex="-1"></a>lda_classifier2.fit(X_train, y_train)</span>
<span id="cb9-639"><a href="#cb9-639" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> lda_classifier2.predict(X_test)</span>
<span id="cb9-640"><a href="#cb9-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-641"><a href="#cb9-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-642"><a href="#cb9-642" aria-hidden="true" tabindex="-1"></a><span class="co"># Check accuracy</span></span>
<span id="cb9-643"><a href="#cb9-643" aria-hidden="true" tabindex="-1"></a>accuracy1 <span class="op">=</span> accuracy_score(y_test, y_pred1)</span>
<span id="cb9-644"><a href="#cb9-644" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="op">=</span> accuracy_score(y_test, y_pred2)</span>
<span id="cb9-645"><a href="#cb9-645" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'sklearn LDA Classifier Accuracy: </span><span class="sc">{</span>accuracy1 <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% and </span><span class="ch">\n</span><span class="ss">custom LDA Classifier Accuracy: </span><span class="sc">{</span>accuracy2 <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb9-646"><a href="#cb9-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb9-647"><a href="#cb9-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-648"><a href="#cb9-648" aria-hidden="true" tabindex="-1"></a>Not too bad, huh! Let's see the confusion matrix for our custom classifier  </span>
<span id="cb9-649"><a href="#cb9-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-652"><a href="#cb9-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-653"><a href="#cb9-653" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb9-654"><a href="#cb9-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-655"><a href="#cb9-655" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="op">=</span> confusion_matrix(y_test, y_pred2)</span>
<span id="cb9-656"><a href="#cb9-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-657"><a href="#cb9-657" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(</span>
<span id="cb9-658"><a href="#cb9-658" aria-hidden="true" tabindex="-1"></a>    conf_mat, </span>
<span id="cb9-659"><a href="#cb9-659" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'Pred: Setosa'</span>,<span class="st">'Pred: Virginica'</span>, <span class="st">'Pred: Versicolor'</span>],</span>
<span id="cb9-660"><a href="#cb9-660" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">'Actual: Setosa'</span>,<span class="st">'Actual: Virginica'</span>, <span class="st">'Actual: Versicolor'</span>]</span>
<span id="cb9-661"><a href="#cb9-661" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb9-662"><a href="#cb9-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-663"><a href="#cb9-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-664"><a href="#cb9-664" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb9-665"><a href="#cb9-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-666"><a href="#cb9-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb9-667"><a href="#cb9-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-668"><a href="#cb9-668" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-669"><a href="#cb9-669" aria-hidden="true" tabindex="-1"></a>Linear Discriminant Analysis (LDA) is a powerful technique for dimensionality reduction and classification. Its goal is to find directions (linear combinations of the original features) that best separate the classes by maximizing between-class variance while minimizing within-class variance. &lt;/p&gt;</span>
<span id="cb9-670"><a href="#cb9-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-671"><a href="#cb9-671" aria-hidden="true" tabindex="-1"></a><span class="fu">### Disclaimer  </span></span>
<span id="cb9-672"><a href="#cb9-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-673"><a href="#cb9-673" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb9-674"><a href="#cb9-674" aria-hidden="true" tabindex="-1"></a>For the mathematical explanation, I used generative AI to produce the matrices and vectors and their manipulations. So it won't be surprising if a calculation mistake is found. The custom python class was created by the help of ChatGPT4 &lt;/p&gt;</span>
<span id="cb9-675"><a href="#cb9-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-676"><a href="#cb9-676" aria-hidden="true" tabindex="-1"></a><span class="fu">## References  </span></span>
<span id="cb9-677"><a href="#cb9-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-678"><a href="#cb9-678" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fisher, R.A. (1936). "The Use of Multiple Measurements in Taxonomic Problems." *Annals of Eugenics*, 7(2), 179–188.  </span>
<span id="cb9-679"><a href="#cb9-679" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Murphy, K. P. (2012). *Machine Learning: A Probabilistic Perspective*. MIT Press.  </span>
<span id="cb9-680"><a href="#cb9-680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Strang, G. (2016). *Introduction to Linear Algebra* (5th ed.). Wellesley-Cambridge Press.  </span>
<span id="cb9-681"><a href="#cb9-681" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lay, D. C. (2011). *Linear Algebra and Its Applications* (4th ed.). Pearson.</span>
<span id="cb9-682"><a href="#cb9-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-683"><a href="#cb9-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-684"><a href="#cb9-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-685"><a href="#cb9-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-686"><a href="#cb9-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-687"><a href="#cb9-687" aria-hidden="true" tabindex="-1"></a>**Share on**  </span>
<span id="cb9-688"><a href="#cb9-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-689"><a href="#cb9-689" aria-hidden="true" tabindex="-1"></a>::::{.columns}</span>
<span id="cb9-690"><a href="#cb9-690" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb9-691"><a href="#cb9-691" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1877F2; text-decoration: none;"&gt;</span>
<span id="cb9-692"><a href="#cb9-692" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-693"><a href="#cb9-693" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands facebook size=3x &gt;}}</span>
<span id="cb9-694"><a href="#cb9-694" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb9-695"><a href="#cb9-695" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-696"><a href="#cb9-696" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-697"><a href="#cb9-697" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-698"><a href="#cb9-698" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb9-699"><a href="#cb9-699" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#0077B5; text-decoration: none;"&gt;</span>
<span id="cb9-700"><a href="#cb9-700" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-701"><a href="#cb9-701" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands linkedin size=3x &gt;}}</span>
<span id="cb9-702"><a href="#cb9-702" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb9-703"><a href="#cb9-703" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-704"><a href="#cb9-704" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-705"><a href="#cb9-705" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-706"><a href="#cb9-706" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb9-707"><a href="#cb9-707" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/dsandml/lda/" target="_blank" style="color:#1DA1F2; text-decoration: none;"&gt;</span>
<span id="cb9-708"><a href="#cb9-708" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-709"><a href="#cb9-709" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands twitter size=3x &gt;}}</span>
<span id="cb9-710"><a href="#cb9-710" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb9-711"><a href="#cb9-711" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-712"><a href="#cb9-712" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-713"><a href="#cb9-713" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb9-714"><a href="#cb9-714" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-715"><a href="#cb9-715" aria-hidden="true" tabindex="-1"></a>&lt;script src="https://giscus.app/client.js"</span>
<span id="cb9-716"><a href="#cb9-716" aria-hidden="true" tabindex="-1"></a>        data-repo="mrislambd/mrislambd.github.io" </span>
<span id="cb9-717"><a href="#cb9-717" aria-hidden="true" tabindex="-1"></a>        data-repo-id="R_kgDOMV8crA"</span>
<span id="cb9-718"><a href="#cb9-718" aria-hidden="true" tabindex="-1"></a>        data-category="Announcements"</span>
<span id="cb9-719"><a href="#cb9-719" aria-hidden="true" tabindex="-1"></a>        data-category-id="DIC_kwDOMV8crM4CjbQW"</span>
<span id="cb9-720"><a href="#cb9-720" aria-hidden="true" tabindex="-1"></a>        data-mapping="pathname"</span>
<span id="cb9-721"><a href="#cb9-721" aria-hidden="true" tabindex="-1"></a>        data-strict="0"</span>
<span id="cb9-722"><a href="#cb9-722" aria-hidden="true" tabindex="-1"></a>        data-reactions-enabled="1"</span>
<span id="cb9-723"><a href="#cb9-723" aria-hidden="true" tabindex="-1"></a>        data-emit-metadata="0"</span>
<span id="cb9-724"><a href="#cb9-724" aria-hidden="true" tabindex="-1"></a>        data-input-position="bottom"</span>
<span id="cb9-725"><a href="#cb9-725" aria-hidden="true" tabindex="-1"></a>        data-theme="light"</span>
<span id="cb9-726"><a href="#cb9-726" aria-hidden="true" tabindex="-1"></a>        data-lang="en"</span>
<span id="cb9-727"><a href="#cb9-727" aria-hidden="true" tabindex="-1"></a>        crossorigin="anonymous"</span>
<span id="cb9-728"><a href="#cb9-728" aria-hidden="true" tabindex="-1"></a>        async&gt;</span>
<span id="cb9-729"><a href="#cb9-729" aria-hidden="true" tabindex="-1"></a>&lt;/script&gt;</span>
<span id="cb9-730"><a href="#cb9-730" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-731"><a href="#cb9-731" aria-hidden="true" tabindex="-1"></a>&lt;div id="fb-root"&gt;&lt;/div&gt;</span>
<span id="cb9-732"><a href="#cb9-732" aria-hidden="true" tabindex="-1"></a>&lt;script async defer crossorigin="anonymous"</span>
<span id="cb9-733"><a href="#cb9-733" aria-hidden="true" tabindex="-1"></a> src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"&gt;&lt;/script&gt;</span>
<span id="cb9-734"><a href="#cb9-734" aria-hidden="true" tabindex="-1"></a>&lt;div class="fb-comments" data-href="https://mrislambd.github.io/dsandml/lda/" data-width="800" data-numposts="5"&gt;&lt;/div&gt;</span>
<span id="cb9-735"><a href="#cb9-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-736"><a href="#cb9-736" aria-hidden="true" tabindex="-1"></a>---  </span>
<span id="cb9-737"><a href="#cb9-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-738"><a href="#cb9-738" aria-hidden="true" tabindex="-1"></a>**You may also like**  </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org/">Quarto</a> 1.6.40</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2024 @ Rafiq Islam
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.txt">
<p>License</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rafiqr35" target="_blank">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://youtube.com/@quanttube" target="_blank">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:rafiqfsu@gmail.com?subject&amp;body" target="_blank">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>