<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rafiq Islam">
<meta name="dcterms.date" content="2024-12-18">

<title>Correlation, Bivariate, and Regression Analysis – Mohammad Rafiqul Islam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//_assets/images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-image','listing-date','listing-title','listing-author','listing-reading-time',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      page: 18,
    pagination: { item: "<li class='page-item'><a class='page page-link' href='#'></a></li>" },
      searchColumns: ["listing-title","listing-author","listing-date","listing-image","listing-description","listing-categories"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Z5NP67GHFC"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Z5NP67GHFC', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6878992848042528" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Correlation, Bivariate, and Regression Analysis – Mohammad Rafiqul Islam">
<meta property="og:description" content="">
<meta property="og:image" content="https://mrislambd.github.io/jobandintern/correlationandregression/corr.png">
<meta property="og:site_name" content="Mohammad Rafiqul Islam">
<meta property="og:image:height" content="480">
<meta property="og:image:width" content="672">
<meta name="twitter:title" content="Correlation, Bivariate, and Regression Analysis – Mohammad Rafiqul Islam">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://mrislambd.github.io/jobandintern/correlationandregression/corr.png">
<meta name="twitter:image-height" content="480">
<meta name="twitter:image-width" content="672">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../jobandintern/correlationandregression/index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../_assets/images/fsu-logo.png" alt="Florida State University" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../jobandintern/correlationandregression/index.html">
    <span class="navbar-title">Mohammad Rafiqul Islam</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blog" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blog</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blog">    
        <li>
    <a class="dropdown-item" href="../../posts/machinelearning/index.html">
 <span class="dropdown-text">Data Science and Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mrislambd.github.io/letscode/">
 <span class="dropdown-text">Data Structure and Algorithm</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/jobandintern/index.html">
 <span class="dropdown-text">Statistics and Probability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../blog.html">
 <span class="dropdown-text">Other Blogs</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/mohammad-rafiqul-islam/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mrislambd" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">Correlation Analysis</a></li>
  <li><a href="#bivariate-analysis" id="toc-bivariate-analysis" class="nav-link" data-scroll-target="#bivariate-analysis">Bivariate Analysis</a>
  <ul>
  <li><a href="#t-statistic" id="toc-t-statistic" class="nav-link" data-scroll-target="#t-statistic"><span class="math inline">\(t-\)</span>Statistic</a></li>
  <li><a href="#fishers-transformation-of-r" id="toc-fishers-transformation-of-r" class="nav-link" data-scroll-target="#fishers-transformation-of-r">Fisher’s Transformation of <span class="math inline">\(r\)</span></a></li>
  </ul></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis">Regression Analysis</a>
  <ul>
  <li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting">Model Fitting</a></li>
  <li><a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit">Goodness of fit</a></li>
  <li><a href="#inference-on-beta" id="toc-inference-on-beta" class="nav-link" data-scroll-target="#inference-on-beta">Inference on <span class="math inline">\(\beta\)</span></a></li>
  <li><a href="#mean-response-and-individual-response" id="toc-mean-response-and-individual-response" class="nav-link" data-scroll-target="#mean-response-and-individual-response">Mean Response and Individual Response</a>
  <ul class="collapse">
  <li><a href="#mean-response" id="toc-mean-response" class="nav-link" data-scroll-target="#mean-response">Mean Response</a></li>
  <li><a href="#individual-response" id="toc-individual-response" class="nav-link" data-scroll-target="#individual-response">Individual Response</a></li>
  </ul></li>
  <li><a href="#model-accuracy" id="toc-model-accuracy" class="nav-link" data-scroll-target="#model-accuracy">Model Accuracy</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.ipynb" download="index.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li><li><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="index.epub"><i class="bi bi-file"></i>ePub</a></li><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <h5 class="quarto-listing-category-title">Categories</h5><div class="quarto-listing-category category-default"><div class="category" data-category="">All <span class="quarto-category-count">(64)</span></div><div class="category" data-category="Algorithms">Algorithms <span class="quarto-category-count">(1)</span></div><div class="category" data-category="Artificial Intelligence">Artificial Intelligence <span class="quarto-category-count">(21)</span></div><div class="category" data-category="Bayesian Inference">Bayesian Inference <span class="quarto-category-count">(2)</span></div><div class="category" data-category="Bayesian Statistics">Bayesian Statistics <span class="quarto-category-count">(2)</span></div><div class="category" data-category="Data Engineering">Data Engineering <span class="quarto-category-count">(11)</span></div><div class="category" data-category="Data Science">Data Science <span class="quarto-category-count">(24)</span></div><div class="category" data-category="Machine Learning">Machine Learning <span class="quarto-category-count">(24)</span></div><div class="category" data-category="Programming">Programming <span class="quarto-category-count">(1)</span></div><div class="category" data-category="PyTorch">PyTorch <span class="quarto-category-count">(1)</span></div><div class="category" data-category="Python">Python <span class="quarto-category-count">(1)</span></div><div class="category" data-category="Statistics">Statistics <span class="quarto-category-count">(5)</span></div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Correlation, Bivariate, and Regression Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Data Science</div>
    <div class="quarto-category">Machine Learning</div>
    <div class="quarto-category">Artificial Intelligence</div>
    <div class="quarto-category">Statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rafiq Islam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 18, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p style="text-align: justify">
Correlation and regression are two fundamental concepts in statistics, often used to study relationships between variables. While correlation measures the strength and direction of a linear relationship between two variables, regression goes further by modeling the relationship to predict or explain one variable based on another. This blog explores the mathematical underpinnings of both concepts, illustrating their significance in data analysis.
</p>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h2>
<p>To better explain, we will use the following hypothetical stock data of 10 companies with stock price and their corresponding proportion in the portfolio.</p>
<div id="30d31f3a" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="st">'Apple'</span>, <span class="st">'Citi'</span>, <span class="st">'MS'</span>, <span class="st">'WF'</span>, <span class="st">'GS'</span>, <span class="st">'Google'</span>, <span class="st">'Amazon'</span>, <span class="st">'Tesla'</span>, <span class="st">'Toyota'</span>, <span class="st">'SPY'</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'StockPrice'</span>: [<span class="fl">2.11</span>, <span class="fl">2.42</span>, <span class="fl">2.52</span>, <span class="fl">3.21</span>, <span class="fl">3.62</span>, <span class="fl">3.86</span>, <span class="fl">4.13</span>, <span class="fl">4.27</span>, <span class="fl">4.51</span>, <span class="fl">5.01</span>], </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Portfolio'</span>: [<span class="fl">2.12</span>, <span class="fl">2.16</span>, <span class="fl">2.51</span>, <span class="fl">2.65</span>, <span class="fl">3.62</span>, <span class="fl">3.15</span>, <span class="fl">4.32</span>, <span class="fl">3.31</span>, <span class="fl">4.18</span>, <span class="fl">4.45</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">'Stock'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>df.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Stock</th>
<th data-quarto-table-cell-role="th">Apple</th>
<th data-quarto-table-cell-role="th">Citi</th>
<th data-quarto-table-cell-role="th">MS</th>
<th data-quarto-table-cell-role="th">WF</th>
<th data-quarto-table-cell-role="th">GS</th>
<th data-quarto-table-cell-role="th">Google</th>
<th data-quarto-table-cell-role="th">Amazon</th>
<th data-quarto-table-cell-role="th">Tesla</th>
<th data-quarto-table-cell-role="th">Toyota</th>
<th data-quarto-table-cell-role="th">SPY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">StockPrice</td>
<td>2.11</td>
<td>2.42</td>
<td>2.52</td>
<td>3.21</td>
<td>3.62</td>
<td>3.86</td>
<td>4.13</td>
<td>4.27</td>
<td>4.51</td>
<td>5.01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Portfolio</td>
<td>2.12</td>
<td>2.16</td>
<td>2.51</td>
<td>2.65</td>
<td>3.62</td>
<td>3.15</td>
<td>4.32</td>
<td>3.31</td>
<td>4.18</td>
<td>4.45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The scatterplot of the data looks like this</p>
<div id="b17efad7" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mywebstyle <span class="im">import</span> plot_style</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plot_style(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(df.StockPrice, df.Portfolio, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Portfolio'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/cell-3-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="593" height="435"></a></p>
</figure>
</div>
</div>
</div>
<p>We can see from the graph that there appears to be a linear relationship between the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values in this case. To find the relationship mathematically we define the followings</p>
<p><span class="math display">\[\begin{align*}
S_{xx}&amp; = \sum (x_i-\bar{x})^2 = \sum (x_i^2-2x_i\bar{x}+\bar{x}^2)\\
&amp; = \sum x_i^2 - 2\bar{x}\sum x_i + \sum \bar{x}^2= \sum x_i^2 - 2\bar{x} n \bar{x} + n \bar{x}^2 = \sum x_i ^2 - n \bar{x}^2
\end{align*}\]</span></p>
<p>Similarly, <span class="math display">\[\begin{align*}
S_{yy}&amp; = \sum (y_i-\bar{y})^2=\sum y_i ^2 - n \bar{y}^2\\
S_{xy} &amp; = \sum (x_i-\bar{x})^2 \sum (y_i-\bar{y})^2 = \sum x_iy_i -n \bar{xy}
\end{align*}\]</span></p>
<p>The sample correlation coefficient <span class="math inline">\(r\)</span> is then given as</p>
<p><span class="math display">\[
r = \frac{S_{xy}}{\sqrt{S_{xx}S_{yy}}} = \frac{\sum x_i ^2 - n \bar{x}^2}{\sqrt{\left(\sum x_i ^2 - n \bar{x}^2\right)\left(\sum y_i ^2 - n \bar{y}^2\right)}}
\]</span></p>
<p>You may have seen a different formula to calculate this quantity which often looks a bit different</p>
<p><span class="math display">\[
\rho = Corr(X,Y)=\frac{Cov(X,Y)}{\sqrt{var(X)var(Y)}}
\]</span><br>
The sample correlation coefficient, <span class="math inline">\(r\)</span>, is an estimator of the population correlation coefficient, <span class="math inline">\(\rho\)</span>, in the same way as <span class="math inline">\(\bar{X}\)</span> is an estimator of <span class="math inline">\(\mu\)</span> or <span class="math inline">\(S^2\)</span> is an estimator of <span class="math inline">\(\sigma^2\)</span> . Now the question is what does this <span class="math inline">\(r\)</span> values mean?</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r=1\)</span></td>
<td>The two variables move together in the same direction in a perfect linear relationship.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0 &lt; r &lt; 1\)</span></td>
<td>The two variables tend to move together in the same direction but there is NOT a direct relationship.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r= 0\)</span></td>
<td>The two variables can move in either direction and show no linear relationship.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(-1 &lt; r &lt; 0\)</span></td>
<td>The two variables tend to move together in opposite directions but there is not a direct relationship.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r =-1\)</span></td>
<td>The two variables move together in opposite directions in a perfect linear relationship.</td>
</tr>
</tbody>
</table>
<p>Let’s calculate the correlation of our stock data.</p>
<div id="9a9a868f" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df.Portfolio.values</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>x_sum, y_sum <span class="op">=</span><span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>s_xx, s_yy, s_xy <span class="op">=</span> <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    x_sum <span class="op">+=</span> x[i]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    s_xx <span class="op">+=</span> x[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    y_sum <span class="op">+=</span> y[i]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    s_yy <span class="op">+=</span> y[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    s_xy <span class="op">+=</span> x[i]<span class="op">*</span>y[i]    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>s_xx <span class="op">=</span> s_xx <span class="op">-</span> (x_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>s_yy <span class="op">=</span> s_yy <span class="op">-</span> (y_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>s_xy <span class="op">=</span> s_xy <span class="op">-</span> (x_sum <span class="op">*</span> y_sum)<span class="op">/</span>n</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> s_xy<span class="op">/</span>math.sqrt(s_xx <span class="op">*</span> s_yy)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print with formatted labels</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum x: </span><span class="sc">{</span>x_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum y: </span><span class="sc">{</span>y_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓₓ: </span><span class="sc">{</span>s_xx<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sᵧᵧ: </span><span class="sc">{</span>s_yy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓᵧ: </span><span class="sc">{</span>s_xy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r : </span><span class="sc">{</span>r<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sum x: 35.66
Sum y: 32.47
Sₓₓ: 8.53
Sᵧᵧ: 6.97
Sₓᵧ: 7.13
 
r : 0.92</code></pre>
</div>
</div>
</section>
<section id="bivariate-analysis" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-analysis">Bivariate Analysis</h2>
<p>The joint probability density function for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in the bivariate normal distribution is given by:</p>
<p><span class="math display">\[
f_{X,Y}(x, y) = \frac{1}{2\pi \sigma_X \sigma_Y \sqrt{1-\rho^2}}
\exp\left( -\frac{1}{2(1-\rho^2)} \left[ \frac{(x-\mu_X)^2}{\sigma_X^2} - 2\rho\frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X \sigma_Y} + \frac{(y-\mu_Y)^2}{\sigma_Y^2} \right] \right)
\]</span></p>
<p style="text-align: justify">
When <span class="math inline">\(|\rho| = 1\)</span>, the denominator <span class="math inline">\(\sqrt{1-\rho^2}\)</span> in the PDF becomes zero, which might appear problematic. However, what happens in this case is that the joint distribution degenerates into a <strong>one-dimensional structure</strong> (a line) rather than being a two-dimensional probability density.
</p>
<p>To see why, consider the quadratic term inside the exponential:</p>
<p><span class="math display">\[
Q = \frac{(x-\mu_X)^2}{\sigma_X^2} - 2\rho \frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X \sigma_Y} + \frac{(y-\mu_Y)^2}{\sigma_Y^2}
\]</span></p>
<p>When <span class="math inline">\(|\rho| = 1\)</span>, this quadratic expression simplifies, as shown next.</p>
<p>Start with the simplified <span class="math inline">\(Q\)</span> when <span class="math inline">\(|\rho| = 1\)</span>:</p>
<p><span class="math display">\[\begin{align*}
Q &amp;= \left( \frac{x-\mu_X}{\sigma_X} \right)^2 - 2\rho \left( \frac{x-\mu_X}{\sigma_X} \cdot \frac{y-\mu_Y}{\sigma_Y} \right) + \left( \frac{y-\mu_Y}{\sigma_Y} \right)^2\\
&amp;=\left( \frac{x-\mu_X}{\sigma_X} - \rho \frac{y-\mu_Y}{\sigma_Y} \right)^2
\end{align*}\]</span></p>
<p>This is a <strong>perfect square</strong> because the “cross term” cancels out all independent variability of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> when <span class="math inline">\(|\rho| = 1\)</span>.</p>
<p>For the quadratic term <span class="math inline">\(Q\)</span> to have any non-zero probability density (since it appears in the exponent of the PDF), it must be equal to zero: <span class="math display">\[
\frac{x-\mu_X}{\sigma_X} - \rho \frac{y-\mu_Y}{\sigma_Y} = 0
\]</span></p>
<p>Rearranging this equation: <span class="math display">\[
\frac{y-\mu_Y}{\sigma_Y} = \rho \frac{x-\mu_X}{\sigma_X}
\]</span></p>
<p>Multiply through by <span class="math inline">\(\sigma_Y\)</span>: <span class="math display">\[
y - \mu_Y = \rho \frac{\sigma_Y}{\sigma_X} (x - \mu_X)
\]</span></p>
<p>Thus:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}(Y| X=x)&amp;= \mu_Y + \rho\frac{\sigma_Y}{\sigma_X}(x-\mu_X)\\
&amp; = \mu_Y + \rho \frac{\sigma_Y}{\sigma_X} (x - \mu_X)
\end{align*}\]</span></p>
<p>This is the equation of a straight line in the <span class="math inline">\((X, Y)\)</span>-plane. The slope of the line is <span class="math inline">\(\rho \frac{\sigma_Y}{\sigma_X}\)</span>, and the line passes through the point <span class="math inline">\((\mu_X, \mu_Y)\)</span>. When <span class="math inline">\(|\rho| = 1\)</span>, all the joint probability mass collapses onto this line, meaning <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are perfectly linearly dependent.</p>
<div id="3084f26a" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the bivariate normal PDF</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bivariate_normal_pdf(x, y, mu_x, mu_y, sigma_x, sigma_y, rho):</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> (</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        ((x <span class="op">-</span> mu_x) <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> sigma_x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rho <span class="op">*</span> (x <span class="op">-</span> mu_x) <span class="op">*</span> (y <span class="op">-</span> mu_y) <span class="op">/</span> (sigma_x <span class="op">*</span> sigma_y)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> ((y <span class="op">-</span> mu_y) <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> sigma_y<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> sigma_x <span class="op">*</span> sigma_y <span class="op">*</span> np.sqrt(<span class="dv">1</span> <span class="op">-</span> rho<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>z <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> rho<span class="op">**</span><span class="dv">2</span>))) <span class="op">/</span> denominator</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot the bivariate normal distribution and a line for rho = 1 or -1</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_bivariate_and_line_side_by_side(rho1, rho2):</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for the first rho</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">121</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(rho1) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Degenerate case: Straight line</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        line_x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        line_y <span class="op">=</span> line_x  <span class="co"># Since rho = 1 implies y = x (perfect correlation)</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        ax1.plot(line_x, line_y, np.zeros_like(line_x), label<span class="op">=</span><span class="ss">f'Degenerate Line (ρ = </span><span class="sc">{</span>rho1<span class="sc">}</span><span class="ss">)'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># General bivariate normal distribution</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> bivariate_normal_pdf(X, Y, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, rho1)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        ax1.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    ax1.set_title(<span class="ss">f'Bivariate Normal (ρ = </span><span class="sc">{</span>rho1<span class="sc">:.2f}</span><span class="ss">)'</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    ax1.set_zlabel(<span class="st">'PDF'</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for the second rho</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">122</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(rho2) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Degenerate case: Straight line</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        line_x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        line_y <span class="op">=</span> line_x  <span class="co"># Since rho = 1 implies y = x (perfect correlation)</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        ax2.plot(line_x, line_y, np.zeros_like(line_x), label<span class="op">=</span><span class="ss">f'Degenerate Line (ρ = </span><span class="sc">{</span>rho2<span class="sc">}</span><span class="ss">)'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># General bivariate normal distribution</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> bivariate_normal_pdf(X, Y, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, rho2)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        ax2.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    ax2.set_title(<span class="ss">f'Bivariate Normal (ρ = </span><span class="sc">{</span>rho2<span class="sc">:.2f}</span><span class="ss">)'</span>)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    ax2.set_zlabel(<span class="st">'PDF'</span>)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot examples side by side</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>plot_bivariate_and_line_side_by_side(<span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example with rho = 0.5 and rho = 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-5-output-1.png" width="760" height="391" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<section id="t-statistic" class="level3">
<h3 class="anchored" data-anchor-id="t-statistic"><span class="math inline">\(t-\)</span>Statistic</h3>
<p>Under the null hypothesis, where <span class="math inline">\(H_0: \rho =0, \frac{r\sqrt{n-2}}{\sqrt{1-r^2}}\)</span> has a <span class="math inline">\(t-\)</span> distribution with <span class="math inline">\(\nu=n-2\)</span> degree of freedom.</p>
</section>
<section id="fishers-transformation-of-r" class="level3">
<h3 class="anchored" data-anchor-id="fishers-transformation-of-r">Fisher’s Transformation of <span class="math inline">\(r\)</span></h3>
<p>If <span class="math inline">\(W = \frac{1}{2}\ln{\frac{1+r}{1-r}}=\tanh^{-1}r\)</span>, then <span class="math inline">\(W\)</span> has approximately a normal distribution with mean <span class="math inline">\(\frac{1}{2}\ln{\frac{1+\rho}{1-\rho}}\)</span> and standard deviation <span class="math inline">\(\frac{1}{\sqrt{n-3}}\)</span>.</p>
<p>For our stock data:</p>
<p><strong>Null Hypothesis <span class="math inline">\(H_0\)</span>:</strong> There is no association between stock prices and the portfolio values, i.e., <span class="math inline">\(\rho =0\)</span><br>
<strong>Alternative Hypothesis <span class="math inline">\(H_1\)</span>:</strong> There is some association between the stock price and portfolio values, i.e., <span class="math inline">\(\rho &gt; 0\)</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true, then the test statistic <span class="math inline">\(\frac{r\sqrt{n-2}}{\sqrt{1-r^2}}=\frac{0.92\sqrt{8}}{\sqrt{1-0.92^2}}=6.64\)</span> has a <span class="math inline">\(t_8\)</span> distribution. The observed value <span class="math inline">\(6.64\)</span> is much greater than the critical value of <span class="math inline">\(t_8\)</span> at <span class="math inline">\(0.5\%\)</span> level which is <span class="math inline">\(3.36\)</span>.</p>
<p>So, we reject the null hypothesis <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(0.5\%\)</span> level and conclude that there is a very strong evidence that <span class="math inline">\(\rho&gt;0\)</span>.</p>
<p>Alternatively, if we want to use the Fisher’s test:</p>
<p>If <span class="math inline">\(H_0\)</span> is true, then the test statistic <span class="math inline">\(Z_r=\tanh^{-1}r=\tanh^{-1}(0.92)\)</span> has a <span class="math inline">\(N\left(0,\frac{1}{7}\right)\)</span> distribution.</p>
<p>The observed value of this statistic is <span class="math inline">\(\frac{1}{2}\log{\frac{1+0.92}{1-0.92}}=1.589\)</span>, which corresponds to a value of <span class="math inline">\(\frac{1.589}{\sqrt{\frac{1}{7}}}=4.204\)</span> on the <span class="math inline">\(N(0,1)\)</span> distribution. This is much greater than <span class="math inline">\(3.090\)</span>, the upper <span class="math inline">\(0.1\%\)</span> point of the standard normal distribution.</p>
<p>So, we reject <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(0.1\%\)</span> level and conclude that there is very strong evidence that <span class="math inline">\(\rho &gt; 0\)</span> ie that there is a positive linear correlation between the stock price and portfolio value.</p>
</section>
</section>
<section id="regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="regression-analysis">Regression Analysis</h2>
<p>Given a set of points <span class="math inline">\((x_i,y_i)_{i=0}^{n}\)</span> for a simple linear regression of the form</p>
<p><span class="math display">\[
Y_i = \alpha +\beta x_i + \epsilon_i; \hspace{4mm} i=1,2,\cdots,n
\]</span></p>
<p>with <span class="math inline">\(\mathbb{\epsilon_i}=0\)</span> and <span class="math inline">\(var[\epsilon_i]=\sigma^2\)</span>.</p>
<section id="model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="model-fitting">Model Fitting</h3>
<p>We can estimate the parameters from the method of least squares but that’s not the goal in this case. Fitting the model involves finding <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> and the estimating the variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p><span class="math display">\[
\hat{y} = \hat{\alpha}+\hat{\beta}x
\]</span></p>
<p>where, <span class="math inline">\(\hat{\beta}= \frac{S_{xy}}{S_{xx}}\)</span> and <span class="math inline">\(\hat{\alpha} = \bar{y}-\hat{\beta}\bar{x}\)</span></p>
<p><span class="math inline">\(\hat{\beta}\)</span> is the observed value of a statistic <span class="math inline">\(\hat{B}\)</span> whose sampling distribution has the following properties</p>
<p><span class="math display">\[
\mathbb{E}[\hat{B}]=\beta, \hspace{4mm} var[\hat{B}]=\frac{\sigma^2}{S_{xx}}
\]</span></p>
<p>And the estimate of the error variance</p>
<p><span class="math display">\[\begin{align*}
\hat{\sigma}^2 &amp; =\frac{1}{n-2}\sum (y_i -\hat{y_i})^2\\
&amp; = \frac{1}{n-2} \left(S_{yy}-\frac{S_{xy}^2}{S_{xx}}\right)
\end{align*}\]</span></p>
</section>
<section id="goodness-of-fit" class="level3">
<h3 class="anchored" data-anchor-id="goodness-of-fit">Goodness of fit</h3>
<p>To better understand the goodness of fit of the model for the data at hand, we can study the total variation in the responses, as given by</p>
<p><span class="math display">\[
S_{yy} = \sum (y_i-\bar{y})^2
\]</span></p>
<p>Let’s see how:</p>
<p><span class="math display">\[\begin{align*}
y_i - \bar{y} &amp;= (y_i - \hat{y_i}) + (\hat{y_i}-\bar{y}) \\
\implies (y_i - \bar{y})^2 &amp; = \left((y_i - \hat{y_i}) + (\hat{y_i}-\bar{y})\right)^2\\
&amp; = (y_i - \hat{y_i})^2 + 2(y_i - \hat{y_i})(\hat{y_i}-\bar{y})+(\hat{y_i}-\bar{y})^2\\
&amp; = (y_i - \hat{y_i})^2 + 2 [y_i -(\hat{\alpha}+\hat{\beta}x_i)][\hat{\alpha}+\hat{\beta}x_i-(\hat{\alpha}+\hat{\beta}\bar{x})]+(\hat{y_i}-\bar{y})^2\\
&amp; = (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left(y_i -\hat{\alpha}-\hat{\beta}x_i\right)(x_i-\bar{x})+(\hat{y_i}-\bar{y})^2\\
\implies \sum (y_i - \bar{y})^2 &amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\sum\left(y_i -\hat{\alpha}-\hat{\beta}x_i\right)(x_i-\bar{x})+\sum(\hat{y_i}-\bar{y})^2\\
&amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left[\sum x_iy_i-\bar{x}\sum y_i -\hat{\alpha}\sum x_i + n\hat{\alpha}\bar{x}-\hat{\beta}\sum x_i^2\right.\\
&amp;\left.\hspace{4mm}+\hat{\beta}\bar{x}\sum x_i\right]+\sum(\hat{y_i}-\bar{y})^2\\
&amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left(\sum x_iy_i-n\bar{x}\bar{y}\right)-2\hat{\beta}^2\left(\sum x_i^2 - n\bar{x}^2\right)+\sum(\hat{y_i}-\bar{y})^2\\
&amp; = \sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}S_{xy}-2\hat{\beta}^2S_{xx}+\sum(\hat{y_i}-\bar{y})^2\\
&amp; = \sum (y_i - \hat{y_i})^2 + 2 \frac{S_{xy}}{S_{xx}}S_{xy}-2\left(\frac{S_{xy}}{S_{xx}}\right)^2S_{xx}+\sum(\hat{y_i}-\bar{y})^2\\
\implies \sum (y_i - \bar{y})^2 &amp; =\sum (y_i - \hat{y_i})^2 +\sum(\hat{y_i}-\bar{y})^2\\
SS_{TOT} &amp; = SS_{RES}+ SS_{REG}
\end{align*}\]</span></p>
<p>In the case that the data are “close” to a line ( <span class="math inline">\(|r|\)</span> high- a strong linear relationship) the model fits well, the fitted responses (the values on the fitted line) are close to the observed responses, and so <span class="math inline">\(SS_{REG}\)</span> is relatively high with <span class="math inline">\(SS_{RES}\)</span> relatively low.</p>
<p>In the case that the data are not “close” to a line ( <span class="math inline">\(|r|\)</span> low - a weak linear relationship) the model does not fit so well, the fitted responses are not so close to the observed responses, and so <span class="math inline">\(SS_{REG}\)</span> is relatively low and <span class="math inline">\(SS_{RES}\)</span> relatively high.</p>
<p>The proportion of the total variability of the responses “explained” by a model is called the coefficient of determination, denoted <span class="math inline">\(R^2\)</span> .</p>
<p><span class="math display">\[
R^2 = \frac{SS_{REG}}{SS_{TOT}} =\frac{S_{xy}^2}{S_{xx}S_{yy}}
\]</span></p>
<p>which takes value between 0 to 1, inclusive. The higher <span class="math inline">\(R^2\)</span>, the better fitting.</p>
<p>For our data, we have:</p>
<p><span class="math display">\[\begin{align*}
n &amp; = 10, \hspace{4mm} \sum x = 35.66, \hspace{4mm} \sum y = 32.47\\
S_{xx} &amp;= 8.53 \hspace{4mm} S_{yy}=6.97, \hspace{4mm} S_{xy}=7.13\\
\implies \hat{\beta} &amp;=\frac{S_{xy}}{S_{xx}}= \frac{7.13}{8.53} = 0.836\\
\hat{\alpha} &amp;= \frac{\sum y}{n} - \hat{\beta} \frac{\sum x}{n} = \bar{y}-\hat{\beta}\bar{x}\\
&amp; = 3.247 - 0.836 \times 3.566 = 0.266
\end{align*}\]</span></p>
<p>Therefore, the fitted line would be <span class="math inline">\(\hat{y}=0.266 + 0.836x\)</span>. Now we see the other metrics</p>
<p><span class="math display">\[\begin{align*}
SS_{TOT} &amp;= 6.97 \\
SS_{REG} &amp; = \frac{S_{yy}^2}{S_{xx}} = \frac{6.97^2}{8.53}=5.695\\
SS_{RES} &amp; = 6.97 - 5.695 = 1.275 \\
\implies \hat{\sigma}^2 &amp; = \frac{1.275}{8}=0.1594\\
R^2 &amp; = \frac{5.695}{6.97}=0.817
\end{align*}\]</span></p>
<div id="8df918e2" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for the line</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.266</span>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.836</span>   </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Line values</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>line_x <span class="op">=</span> np.linspace(<span class="bu">min</span>(df.StockPrice), <span class="bu">max</span>(df.StockPrice), <span class="dv">100</span>)  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>line_y <span class="op">=</span> alpha <span class="op">+</span> beta <span class="op">*</span> line_x             </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(df.StockPrice, df.Portfolio, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Data Points'</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.plot(line_x, line_y, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="ss">f'Line: y = </span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>beta<span class="sc">}</span><span class="ss">x'</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels and title</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Portfolio'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot with Regression Line'</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/cell-6-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/cell-6-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="593" height="455"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-on-beta" class="level3">
<h3 class="anchored" data-anchor-id="inference-on-beta">Inference on <span class="math inline">\(\beta\)</span></h3>
<p>We can rewrite <span class="math inline">\(\hat{\beta}= \frac{S_{xy}}{S_{xx}}\)</span>, as</p>
<p><span class="math display">\[\begin{align*}
\hat{\beta}&amp;= \frac{S_{xy}}{S_{xx}}=\frac{\sum (x_i-\bar{x})(y_i-\bar{y})}{S_{xx}}\\
&amp; = \frac{\sum (x_i-\bar{x})y_i-\bar{y}\sum (x_i-\bar{x})}{S_{xx}}\\
&amp; = \frac{\sum (x_i-\bar{x}y_i)-\bar{y}\left(\sum x_i -n\bar{x}\right)}{S_{xx}}\\
&amp; = \frac{\sum (x_i-\bar{x})y_i}{S_{xx}}
\end{align*}\]</span></p>
<p>Now we recall that <span class="math inline">\(\hat{B}\)</span> is the random variable that has <span class="math inline">\(\hat{\beta}\)</span> as its realization. Therefore, <span class="math inline">\(\hat{B}=\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}\)</span>. We also recall that <span class="math inline">\(\mathbb{E}(Y_i)=\alpha +\beta x\)</span>. Putting these together we obtain,</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[\hat{B}] &amp;= \mathbb{E}\left[\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}\right] = \frac{\sum (x_i -\bar{x})\mathbb{E}[Y_i]}{S_{xx}}\\
&amp; = \frac{\sum (x_i-\bar{x})(\alpha + \beta x_i)}{S_{xx}}\\
&amp; = \frac{\alpha \sum (x_i-\bar{x})+\beta \sum x_i (x_i-\bar{x})}{S_{xx}}\\
&amp; = \frac{\alpha \left(\sum x_i -n\bar{x}\right)+\beta \left(\sum x_i^2-\bar{x}\sum x_i\right)}{S_{xx}} \\
&amp; = \frac{\alpha (n\bar{x}-n\bar{x})+\beta\left(\sum x_i^2-n\bar{x}^2\right)}{S_{xx}}\\
&amp; = \frac{0+\beta S_{xx}}{S_{xx}} = \beta
\end{align*}\]</span></p>
<p>Now the fact that <span class="math inline">\(Y_i'\)</span>s are uncorrelated. Therefore, <span class="math inline">\(var\left(\sum (Y_i)\right)=\sum var(Y_i)\)</span> and we have <span class="math inline">\(var(Y_i)=\sigma^2\)</span>. Therefore,</p>
<p><span class="math display">\[\begin{align*}
var[\hat{B}]&amp; = var\left[\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}\right]= \frac{\sum (x_i-\bar{x})^2var[Y_i]}{S_{xx}^2}\\
&amp; = \frac{\sum (x_i-\bar{x})^2\sigma^2}{S_{xx}^2} = \frac{\sigma^2}{S_{xx}^2}\sum (x_i-\bar{x})^2 = \frac{\sigma^2}{S_{xx}^2}S_{xx}\\
&amp; = \frac{\sigma^2}{S_{xx}}
\end{align*}\]</span></p>
<p>Since <span class="math inline">\(\mathbb{E}(\hat{\beta})=\beta\)</span> and <span class="math inline">\(var(\hat{\beta})=\frac{\sigma^2}{S_{xx}}\)</span> so</p>
<p><span class="math display">\[
M = \frac{\hat{\beta}-\beta}{\sqrt{\frac{\sigma^2}{S_{xx}}}}\sim N(0,1)
\]</span></p>
<p>and the observed variance <span class="math inline">\(\hat{\sigma}^2\)</span> has the property</p>
<p><span class="math display">\[
N = \frac{(n-2)\hat{\sigma}^2}{\sigma^2} \sim \chi_{n-2}^2
\]</span></p>
<p>Since <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(\hat{\sigma}^2\)</span> are independent, it follows that</p>
<p><span class="math display">\[
\frac{M}{\sqrt{\frac{N}{n-2}}} \sim t_{n-2}
\]</span></p>
<p>In other words: <span class="math display">\[
\frac{\hat{\beta}-\beta}{se(\hat{\beta})} = \frac{\hat{\beta}-\beta}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \sim t_{n-2}
\]</span></p>
<p>Now the big question is what’s the use of this mathematical jargon that we have learned so far? Let’s use our regression problem on stock data to explain.</p>
<p><strong><span class="math inline">\(H_0: \beta =0\)</span>, there is no linear relationship</strong><br>
vs<br>
<strong><span class="math inline">\(H_1: \beta&gt; 0\)</span>, there is a linear relationship</strong></p>
<p>Based on our data we have <span class="math inline">\(\hat{\beta} = 0.836\)</span> and <span class="math inline">\(\hat{\sigma}^2=0.1594\)</span>, and <span class="math inline">\(S_{xx}=8.53\)</span>. Therefore, under <span class="math inline">\(H_0\)</span>, the test statistic</p>
<p><span class="math display">\[
\frac{\hat{\beta}-0}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \text{ has a } t_{10-2} \text{ or } t_8 \text{ distribution}
\]</span></p>
<p>But the observed value of this statistic <span class="math display">\[
\frac{0.836-0}{\sqrt{0.1594/8.53}}=6.1156
\]</span></p>
<p>which is way higher than the critical value at <span class="math inline">\(5\%\)</span> significance level.</p>
<div id="d5c37ce3" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">8</span>  <span class="co"># Degrees of freedom</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Upper tail probability</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>t_critical <span class="op">=</span> t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha, df)  <span class="co"># Critical t-value at the 95th percentile</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate x values for the t-distribution</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> t.pdf(x, df)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, label<span class="op">=</span><span class="ss">f't_</span><span class="sc">{</span>df<span class="sc">}</span><span class="ss"> Distribution'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, where<span class="op">=</span>(x <span class="op">&gt;=</span> t_critical), color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f'Upper </span><span class="sc">{</span>alpha<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Area'</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the critical t-value on the x-axis</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>plt.axvline(t_critical, ymin<span class="op">=</span><span class="fl">0.02</span>, ymax<span class="op">=</span><span class="fl">0.30</span>,color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Critical t-value = </span><span class="sc">{</span>t_critical<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plt.text(t_critical, <span class="op">-</span><span class="fl">0.02</span>, <span class="ss">f'</span><span class="sc">{</span>t_critical<span class="sc">:.2f}</span><span class="ss">'</span>, color<span class="op">=</span><span class="st">'red'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a horizontal line at y = 0</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels, title, and legend</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"t-Distribution with </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss"> Degrees of Freedom"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"t"</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust plot limits</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/cell-7-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/cell-7-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="601" height="455"></a></p>
</figure>
</div>
</div>
</div>
<p>So, we reject the null hypothesis <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(5\%\)</span> level and conclude that there is a very strong evidence that <span class="math inline">\(\beta&gt;0\)</span>, i.e., the portfolio value is increasing over stock price.</p>
<p><strong>Alternatively,</strong> let’s put our analysis in a different approach. We claim that</p>
<p><strong><span class="math inline">\(H_0: \beta=1\)</span>, there is a linear relationship</strong><br>
vs<br>
<strong><span class="math inline">\(H_1: \beta \ne 1\)</span></strong></p>
<p>In this case,</p>
<p><span class="math display">\[
se(\hat{\beta}) = \sqrt{\frac{\hat{\sigma}^2}{S_{xx}}} = \sqrt{\frac{0.1594}{8.53}} =0.1367
\]</span></p>
<p>Therefore, the <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\beta\)</span> is</p>
<p><span class="math display">\[
\hat{\beta} \pm \left\{t_{0.025,8}\times se(\hat{\beta})\right\}=0.836 \pm 2.306\times 0.1367 = (0.5207,1.1512)
\]</span></p>
<p>The <span class="math inline">\(95\%\)</span> two-sided confidence interval contains the value <span class="math inline">\(1\)</span>, so the two-sided test conducted at <span class="math inline">\(5\%\)</span> level results in <span class="math inline">\(H_0\)</span> being accepted.</p>
</section>
<section id="mean-response-and-individual-response" class="level3">
<h3 class="anchored" data-anchor-id="mean-response-and-individual-response">Mean Response and Individual Response</h3>
<section id="mean-response" class="level4">
<h4 class="anchored" data-anchor-id="mean-response">Mean Response</h4>
<p style="text-align: justify">
If <span class="math inline">\(\mu_0\)</span> is the expected (mean) response for a value <span class="math inline">\(x_0\)</span> of the predictor variable, that is <span class="math inline">\(\mu_0 = \mathbb{E}[Y|x_0]=\alpha +\beta x_0\)</span>, then <span class="math inline">\(\mu_0\)</span> is an unbiased estimator given by
</p>
<p><span class="math display">\[
\hat{\mu}_0 = \hat{\alpha}+\hat{\beta} x_0
\]</span></p>
<p>and the variance of the estimator is given by</p>
<p><span class="math display">\[
var(\hat{\mu}_0) = \left(\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\frac{\hat{\mu}_0-\mu_0}{se[\hat{\mu}_0] }= \frac{\hat{\mu}_0-\mu_0}{\sqrt{\left(\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2}}\sim t_{n-2}
\]</span></p>
</section>
<section id="individual-response" class="level4">
<h4 class="anchored" data-anchor-id="individual-response">Individual Response</h4>
<p>The actual estimate of an individual response <span class="math display">\[
\hat{y}_0 = \hat{\alpha} +\hat{\beta}x_0
\]</span></p>
<p style="text-align: justify">
However, the uncertainty associated with this estimator, as indicated by its variance, is higher compared to the mean estimator because it relies on the value of an individual response <span class="math inline">\(y_0\)</span> rather than the more stable mean. To account for the additional variability of an individual response relative to the mean, an extra term, <span class="math inline">\(\sigma^2\)</span>, must be included in the variance expression for the estimator of a mean response.
</p>
<p><span class="math display">\[
var[\hat{y}_0] = \left(1+\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\frac{\hat{y}-y_0}{se[\hat{y}_0]}=\frac{\hat{y}-y_0}{\sqrt{\left(1+\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2}}\sim t_{n-2}
\]</span></p>
<p style="text-align:justify">
Let’s put this two idea through our example. If we want to find a <span class="math inline">\(95\%\)</span> confidence interval or the expected portfolio value on stock price of say, 360. In that case,
</p>
<p><span class="math display">\[
\text{Estimate of the expected portfolio value} = 0.266+0.836\times 3.6 = 3.276
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\text{se}[\text{Estimate}] = \sqrt{\left(\frac{1}{10}+\frac{(3.6-3.566)^2}{8.53}\right) 0.1594}=0.1263
\]</span></p>
<p>So, the <span class="math inline">\(95\%\)</span> CI</p>
<p><span class="math display">\[
3.276\pm (t_{0.025,8}\times \text{se}[\text{Estimate}]) = 3.276 \pm 2.306\times 0.1263 = (2.985,3.567)
\]</span></p>
<p>That is for a stock price of <span class="math inline">\(\$360\)</span>, the expected portfolio value would be in the range of <span class="math inline">\((\$298.50,\$356.70)\)</span></p>
<p>Similarly, the <span class="math inline">\(95\%\)</span> CI for the predicted actual portfolio value</p>
<p><span class="math display">\[\begin{align*}
3.276\pm (t_{0.025,8}\times \text{se}[\text{Estimate}]) &amp;= 3.276 \pm 2.306\sqrt{\left(1+\frac{1}{10}+\frac{(3.6-3.566)^2}{8.53}\right) 0.1594}\\
&amp; = (2.3103,4.2417)
\end{align*}\]</span></p>
<p>or <span class="math inline">\((\$231.03,\$424.17)\)</span></p>
</section>
</section>
<section id="model-accuracy" class="level3">
<h3 class="anchored" data-anchor-id="model-accuracy">Model Accuracy</h3>
<p>The residual from the fit at <span class="math inline">\(x_i\)</span> is the estimated error which is defined by <span class="math display">\[
\hat{\epsilon}_i = y_i - \hat{y}_i
\]</span></p>
<p style="text-align: justify">
Scatter plots of residuals versus the explanatory variable (or the fitted response values) are particularly insightful. A lack of random scatter in the residuals, such as the presence of a discernible pattern, indicates potential shortcomings in the model.
</p>
<div id="928b2248" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="st">'Apple'</span>, <span class="st">'Citi'</span>, <span class="st">'MS'</span>, <span class="st">'WF'</span>, <span class="st">'GS'</span>, <span class="st">'Google'</span>, <span class="st">'Amazon'</span>, <span class="st">'Tesla'</span>, <span class="st">'Toyota'</span>, <span class="st">'SPY'</span>],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'StockPrice'</span>: [<span class="fl">2.11</span>, <span class="fl">2.42</span>, <span class="fl">2.52</span>, <span class="fl">3.21</span>, <span class="fl">3.62</span>, <span class="fl">3.86</span>, <span class="fl">4.13</span>, <span class="fl">4.27</span>, <span class="fl">4.51</span>, <span class="fl">5.01</span>], </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Portfolio'</span>: [<span class="fl">2.12</span>, <span class="fl">2.16</span>, <span class="fl">2.51</span>, <span class="fl">2.65</span>, <span class="fl">3.62</span>, <span class="fl">3.15</span>, <span class="fl">4.32</span>, <span class="fl">3.31</span>, <span class="fl">4.18</span>, <span class="fl">4.45</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df.Portfolio.values </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> [<span class="fl">0.266</span><span class="op">+</span><span class="fl">0.836</span><span class="op">*</span>i <span class="cf">for</span> i <span class="kw">in</span> x]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y<span class="op">-</span>y_hat)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of the residuals from the fitted line'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/cell-8-output-1.png" width="601" height="455" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p style="text-align: justify">
In this plot, we can see that the residuals tend to increase as <span class="math inline">\(x\)</span> increases, indicates that the error variance is not bounded, but increasing with <span class="math inline">\(x\)</span>. So, the model is not the best one. A transformation of the responses may stabilize the error variance. <br> <br> In certain case, for some growth models, the appropriate model is that the expected response is related to the exploratory variable through an exponential relationship, i.e.,
</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}[Y_i|X=x_i] &amp;= \alpha e^{\beta x_i}\\
\implies z_i = \log y_i &amp; = \eta + \beta x_i + \epsilon_i; \hspace{4mm}\text{where }\eta=\log \alpha
\end{align*}\]</span></p>
<div id="0f980c61" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(df.Portfolio.values)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>x_sum, y_sum <span class="op">=</span><span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>s_xx, s_yy, s_xy <span class="op">=</span> <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    x_sum <span class="op">+=</span> x[i]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    s_xx <span class="op">+=</span> x[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    y_sum <span class="op">+=</span> y[i]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    s_yy <span class="op">+=</span> y[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    s_xy <span class="op">+=</span> x[i]<span class="op">*</span>y[i]    </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>s_xx <span class="op">=</span> s_xx <span class="op">-</span> (x_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>s_yy <span class="op">=</span> s_yy <span class="op">-</span> (y_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>s_xy <span class="op">=</span> s_xy <span class="op">-</span> (x_sum <span class="op">*</span> y_sum)<span class="op">/</span>n</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> s_xy<span class="op">/</span>math.sqrt(s_xx <span class="op">*</span> s_yy)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print with formatted labels</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum x: </span><span class="sc">{</span>x_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum y: </span><span class="sc">{</span>y_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓₓ: </span><span class="sc">{</span>s_xx<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sᵧᵧ: </span><span class="sc">{</span>s_yy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓᵧ: </span><span class="sc">{</span>s_xy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r : </span><span class="sc">{</span>r<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sum x: 35.66
Sum y: 11.43
Sₓₓ: 8.53
Sᵧᵧ: 0.70
Sₓᵧ: 2.29
 
r : 0.94</code></pre>
</div>
</div>
<p>Now we have:</p>
<p><span class="math display">\[\begin{align*}
n &amp; = 10, \hspace{4mm} \sum x = 35.66, \hspace{4mm} \sum y = 11.43\\
S_{xx} &amp;= 8.53 \hspace{4mm} S_{yy}=0.70, \hspace{4mm} S_{xy}=2.29\\
\implies \hat{\beta} &amp;=\frac{S_{xy}}{S_{xx}}= \frac{2.29}{8.53} = 0.268\\
\hat{\alpha} &amp;= \frac{\sum y}{n} - \hat{\beta} \frac{\sum x}{n} = \bar{y}-\hat{\beta}\bar{x}\\
&amp; = 1.143 - 0.268 \times 3.566 = 0.1873
\end{align*}\]</span></p>
<div id="7aa0c071" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>z_hat <span class="op">=</span> [np.log(<span class="fl">0.1873</span>)<span class="op">+</span><span class="fl">0.268</span><span class="op">*</span>i <span class="cf">for</span> i <span class="kw">in</span> x]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.log(y)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, z<span class="op">-</span>z_hat)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.axhline(np.mean(z<span class="op">-</span>z_hat))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of the residuals from the fitted line'</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-10-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/cell-10-output-1.png" width="601" height="455" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Now the residuals look good, that is no special pattern or increasing the error variance.</p>
<p>Thanks for reading.</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li><strong>Montgomery, D. C., &amp; Runger, G. C.</strong> (2014). <em>Applied Statistics and Probability for Engineers</em>. Wiley.<br>
</li>
<li><strong>Casella, G., &amp; Berger, R. L.</strong> (2002). <em>Statistical Inference</em>. Duxbury.<br>
</li>
<li><strong>Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S.</strong> (2003). <em>Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences</em>. Routledge.<br>
</li>
<li><strong>Seber, G. A. F., &amp; Lee, A. J.</strong> (2003). <em>Linear Regression Analysis</em>. Wiley.</li>
<li><strong>Neter, J., Kutner, M. H., Nachtsheim, C. J., &amp; Wasserman, W.</strong> (1996). <em>Applied Linear Statistical Models</em>. Irwin.<br>
</li>
<li><strong>Hastie, T., Tibshirani, R., &amp; Friedman, J.</strong> (2009). <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. Springer.<br>
</li>
<li><strong>Weisberg, S.</strong> (2005). <em>Applied Linear Regression</em>. Wiley.<br>
</li>
<li><strong>Bivariate Normal Distribution Explanation</strong>:
<ul>
<li>Rice, J. A. (2006). <em>Mathematical Statistics and Data Analysis</em>. Thomson Brooks/Cole.<br>
</li>
<li>A detailed exploration of the bivariate normal distribution and its properties.</li>
</ul></li>
<li><strong>Fisher’s Transformation of Correlation Coefficients</strong>:
<ul>
<li>Fisher, R. A. (1921). <em>On the probable error of a coefficient of correlation</em>. Metron, 1, 3-32.<br>
</li>
<li>The foundational paper describing Fisher’s transformation and its use in hypothesis testing.</li>
</ul></li>
</ol>
<p><strong>Share on</strong></p>
<div class="columns">
<div class="column" style="width:33%;">
<p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1877F2; text-decoration: none;">
<p><i class="fa-brands fa-facebook fa-3x" aria-label="facebook"></i></p>
</a><p><a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1877F2; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#0077B5; text-decoration: none;">
<p><i class="fa-brands fa-linkedin fa-3x" aria-label="linkedin"></i></p>
</a><p><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#0077B5; text-decoration: none;"></a></p>
</div><div class="column" style="width:33%;">
<p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1DA1F2; text-decoration: none;">
<p><i class="fa-brands fa-twitter fa-3x" aria-label="twitter"></i></p>
</a><p><a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1DA1F2; text-decoration: none;"></a></p>
</div>
</div>
<script src="https://giscus.app/client.js" data-repo="mrislambd/mrislambd.github.io" data-repo-id="R_kgDOMV8crA" data-category="Announcements" data-category-id="DIC_kwDOMV8crM4CjbQW" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<div id="fb-root">

</div>
<script async="" defer="" crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"></script>
<div class="fb-comments" data-href="https://mrislambd.github.io/jobandintern/correlationandregression/" data-width="750" data-numposts="5">

</div>
<p><strong>You may also like</strong></p>



<!-- -->

</section>

<div class="quarto-listing quarto-listing-container-grid" id="listing-listing">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-categories="Machine Learning,Data Science,Bayesian Inference,Bayesian Statistics,Statistics" data-listing-date-sort="1729569600000" data-listing-file-modified-sort="1730179317257" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="12" data-listing-word-count-sort="2300">
<a href="../../dsandml/bayesianclassification/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../dsandml/bayesianclassification/Bayeslearn.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Bayesian Probabilistic Models for Classification
</h5>
<div class="listing-reading-time card-text text-muted">
12 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Tuesday, October 22, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-categories="Machine Learning,Data Science,Bayesian Inference,Bayesian Statistics,Statistics" data-listing-date-sort="1733115600000" data-listing-file-modified-sort="1733213800936" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="7" data-listing-word-count-sort="1271">
<a href="../../dsandml/adaboost/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img loading="lazy" src="../../dsandml/adaboost/ada1.png" class="thumbnail-image card-img" style="height: 150px;">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Boosting Algorithm: Adaptive Boosting Method (AdaBoost)
</h5>
<div class="listing-reading-time card-text text-muted">
7 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Monday, December 2, 2024
</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-categories="Statistics,Data Science,Data Engineering,Machine Learning,Artificial Intelligence" data-listing-date-sort="1728532800000" data-listing-file-modified-sort="1728684641298" data-listing-date-modified-sort="NaN" data-listing-reading-time-sort="11" data-listing-word-count-sort="2195">
<a href="../../dsandml/naivebayes/index.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top"><img src="../../dsandml/lda/lda.png" style="height: 150px;"  class="thumbnail-image card-img"/></p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Classification using Naive Bayes algorithm
</h5>
<div class="listing-reading-time card-text text-muted">
11 min
</div>
<div class="card-attribution card-text-small justify">
<div class="listing-author">
Rafiq Islam
</div>
<div class="listing-date">
Thursday, October 10, 2024
</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{islam2024,
  author = {Islam, Rafiq},
  title = {Correlation, {Bivariate,} and {Regression} {Analysis}},
  date = {2024-12-18},
  url = {https://mrislambd.github.io/jobandintern/correlationandregression/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-islam2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Islam, Rafiq. 2024. <span>“Correlation, Bivariate, and Regression
Analysis.”</span> December 18, 2024. <a href="https://mrislambd.github.io/jobandintern/correlationandregression/">https://mrislambd.github.io/jobandintern/correlationandregression/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mrislambd\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Correlation, Bivariate, and Regression Analysis"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-12-18"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Rafiq Islam</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Data Science, Machine Learning, Artificial Intelligence, Statistics]</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="an">search:</span><span class="co"> true</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> corr.png</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="an">listing:</span><span class="co"> </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">    contents: "/../../dsandml"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">    max-items: 3</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">    type: grid</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">    categories: true</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">    date-format: full</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fields: [image, date, title, author, reading-time]</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">    html: default</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">    ipynb: default</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">    docx: </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">    epub:</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">    pdf: </span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">      pdf-engine: xelatex</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">      adsense:</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">        enable-ads: false</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">      number-sections: false</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">      colorlinks: true</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">---</span>   </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction  </span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>Correlation and regression are two fundamental concepts in statistics, often used to study relationships between variables. While correlation measures the strength and direction of a linear relationship between two variables, regression goes further by modeling the relationship to predict or explain one variable based on another. This blog explores the mathematical underpinnings of both concepts, illustrating their significance in data analysis.&lt;/p&gt;</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation Analysis</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>To better explain, we will use the following hypothetical stock data of 10 companies with stock price and their corresponding proportion in the portfolio.</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="st">'Apple'</span>, <span class="st">'Citi'</span>, <span class="st">'MS'</span>, <span class="st">'WF'</span>, <span class="st">'GS'</span>, <span class="st">'Google'</span>, <span class="st">'Amazon'</span>, <span class="st">'Tesla'</span>, <span class="st">'Toyota'</span>, <span class="st">'SPY'</span>],</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'StockPrice'</span>: [<span class="fl">2.11</span>, <span class="fl">2.42</span>, <span class="fl">2.52</span>, <span class="fl">3.21</span>, <span class="fl">3.62</span>, <span class="fl">3.86</span>, <span class="fl">4.13</span>, <span class="fl">4.27</span>, <span class="fl">4.51</span>, <span class="fl">5.01</span>], </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Portfolio'</span>: [<span class="fl">2.12</span>, <span class="fl">2.16</span>, <span class="fl">2.51</span>, <span class="fl">2.65</span>, <span class="fl">3.62</span>, <span class="fl">3.15</span>, <span class="fl">4.32</span>, <span class="fl">3.31</span>, <span class="fl">4.18</span>, <span class="fl">4.45</span>]</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">'Stock'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>df.T</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>The scatterplot of the data looks like this  </span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mywebstyle <span class="im">import</span> plot_style</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>plot_style(<span class="st">'#f4f4f4'</span>)</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>plt.scatter(df.StockPrice, df.Portfolio, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Portfolio'</span>)</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>We can see from the graph that there appears to be a linear relationship between the $x$ and $y$ values in this case. To find the relationship mathematically we define the followings  </span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>S_{xx}&amp; = \sum (x_i-\bar{x})^2 = \sum (x_i^2-2x_i\bar{x}+\bar{x}^2)<span class="sc">\\</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>&amp; = \sum x_i^2 - 2\bar{x}\sum x_i + \sum \bar{x}^2= \sum x_i^2 - 2\bar{x} n \bar{x} + n \bar{x}^2 = \sum x_i ^2 - n \bar{x}^2</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>Similarly, </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>S_{yy}&amp; = \sum (y_i-\bar{y})^2=\sum y_i ^2 - n \bar{y}^2<span class="sc">\\</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>S_{xy} &amp; = \sum (x_i-\bar{x})^2 \sum (y_i-\bar{y})^2 = \sum x_iy_i -n \bar{xy}</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>The sample correlation coefficient $r$ is then given as </span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>r = \frac{S_{xy}}{\sqrt{S_{xx}S_{yy}}} = \frac{\sum x_i ^2 - n \bar{x}^2}{\sqrt{\left(\sum x_i ^2 - n \bar{x}^2\right)\left(\sum y_i ^2 - n \bar{y}^2\right)}}</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>You may have seen a different formula to calculate this quantity which often looks a bit different </span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>\rho = Corr(X,Y)=\frac{Cov(X,Y)}{\sqrt{var(X)var(Y)}}</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>The sample correlation coefficient, $r$, is an estimator of the population correlation coefficient, $\rho$, in the same way as $\bar{X}$ is an estimator of $\mu$ or $S^2$ is an estimator of $\sigma^2$ . Now the question is what does this $r$ values mean?  </span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>| Value | Meaning |  </span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>|-------| ---------------- |  </span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>| $r=1$ | The two variables move together in the same direction in a perfect linear relationship. |  </span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>| $0 &lt; r &lt; 1$ | The two variables tend to move together in the same direction but there is NOT a direct relationship. |  </span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>| $r= 0$ | The two variables can move in either direction and show no linear relationship. |  </span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>| $-1 &lt; r &lt; 0$ | The two variables tend to move together in opposite directions but there is not a direct relationship. |  </span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>| $r =-1$ | The two variables move together in opposite directions in a perfect linear relationship. |  </span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>Let's calculate the correlation of our stock data.</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df.Portfolio.values</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>x_sum, y_sum <span class="op">=</span><span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>s_xx, s_yy, s_xy <span class="op">=</span> <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>    x_sum <span class="op">+=</span> x[i]</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>    s_xx <span class="op">+=</span> x[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>    y_sum <span class="op">+=</span> y[i]</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>    s_yy <span class="op">+=</span> y[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>    s_xy <span class="op">+=</span> x[i]<span class="op">*</span>y[i]    </span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>s_xx <span class="op">=</span> s_xx <span class="op">-</span> (x_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>s_yy <span class="op">=</span> s_yy <span class="op">-</span> (y_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>s_xy <span class="op">=</span> s_xy <span class="op">-</span> (x_sum <span class="op">*</span> y_sum)<span class="op">/</span>n</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> s_xy<span class="op">/</span>math.sqrt(s_xx <span class="op">*</span> s_yy)</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Print with formatted labels</span></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum x: </span><span class="sc">{</span>x_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum y: </span><span class="sc">{</span>y_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓₓ: </span><span class="sc">{</span>s_xx<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sᵧᵧ: </span><span class="sc">{</span>s_yy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓᵧ: </span><span class="sc">{</span>s_xy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r : </span><span class="sc">{</span>r<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bivariate Analysis  </span></span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>The joint probability density function for $X$ and $Y$ in the bivariate normal distribution is given by:</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>f_{X,Y}(x, y) = \frac{1}{2\pi \sigma_X \sigma_Y \sqrt{1-\rho^2}} </span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>\exp\left( -\frac{1}{2(1-\rho^2)} \left<span class="co">[</span><span class="ot"> \frac{(x-\mu_X)^2}{\sigma_X^2} - 2\rho\frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X \sigma_Y} + \frac{(y-\mu_Y)^2}{\sigma_Y^2} \right</span><span class="co">]</span> \right)</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>When $|\rho| = 1$, the denominator $\sqrt{1-\rho^2}$ in the PDF becomes zero, which might appear problematic. However, what happens in this case is that the joint distribution degenerates into a **one-dimensional structure** (a line) rather than being a two-dimensional probability density.&lt;/p&gt;</span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>To see why, consider the quadratic term inside the exponential:</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>Q = \frac{(x-\mu_X)^2}{\sigma_X^2} - 2\rho \frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X \sigma_Y} + \frac{(y-\mu_Y)^2}{\sigma_Y^2}</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>When $|\rho| = 1$, this quadratic expression simplifies, as shown next.</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>Start with the simplified $Q$ when $|\rho| = 1$:</span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>Q &amp;= \left( \frac{x-\mu_X}{\sigma_X} \right)^2 - 2\rho \left( \frac{x-\mu_X}{\sigma_X} \cdot \frac{y-\mu_Y}{\sigma_Y} \right) + \left( \frac{y-\mu_Y}{\sigma_Y} \right)^2<span class="sc">\\</span></span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>&amp;=\left( \frac{x-\mu_X}{\sigma_X} - \rho \frac{y-\mu_Y}{\sigma_Y} \right)^2</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>This is a **perfect square** because the "cross term" cancels out all independent variability of $X$ and $Y$ when $|\rho| = 1$.</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>For the quadratic term $Q$ to have any non-zero probability density (since it appears in the exponent of the PDF), it must be equal to zero:</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>\frac{x-\mu_X}{\sigma_X} - \rho \frac{y-\mu_Y}{\sigma_Y} = 0</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>Rearranging this equation:</span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>\frac{y-\mu_Y}{\sigma_Y} = \rho \frac{x-\mu_X}{\sigma_X}</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>Multiply through by $\sigma_Y$:</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>y - \mu_Y = \rho \frac{\sigma_Y}{\sigma_X} (x - \mu_X)</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>Thus:</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>\mathbb{E}(Y| X=x)&amp;= \mu_Y + \rho\frac{\sigma_Y}{\sigma_X}(x-\mu_X)<span class="sc">\\</span></span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>&amp; = \mu_Y + \rho \frac{\sigma_Y}{\sigma_X} (x - \mu_X)</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>This is the equation of a straight line in the $(X, Y)$-plane. The slope of the line is $\rho \frac{\sigma_Y}{\sigma_X}$, and the line passes through the point $(\mu_X, \mu_Y)$. When $|\rho| = 1$, all the joint probability mass collapses onto this line, meaning $X$ and $Y$ are perfectly linearly dependent.</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the bivariate normal PDF</span></span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bivariate_normal_pdf(x, y, mu_x, mu_y, sigma_x, sigma_y, rho):</span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> (</span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a>        ((x <span class="op">-</span> mu_x) <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> sigma_x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rho <span class="op">*</span> (x <span class="op">-</span> mu_x) <span class="op">*</span> (y <span class="op">-</span> mu_y) <span class="op">/</span> (sigma_x <span class="op">*</span> sigma_y)</span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> ((y <span class="op">-</span> mu_y) <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> sigma_y<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> sigma_x <span class="op">*</span> sigma_y <span class="op">*</span> np.sqrt(<span class="dv">1</span> <span class="op">-</span> rho<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>z <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> rho<span class="op">**</span><span class="dv">2</span>))) <span class="op">/</span> denominator</span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot the bivariate normal distribution and a line for rho = 1 or -1</span></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_bivariate_and_line_side_by_side(rho1, rho2):</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for the first rho</span></span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">121</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(rho1) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Degenerate case: Straight line</span></span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>        line_x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>        line_y <span class="op">=</span> line_x  <span class="co"># Since rho = 1 implies y = x (perfect correlation)</span></span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>        ax1.plot(line_x, line_y, np.zeros_like(line_x), label<span class="op">=</span><span class="ss">f'Degenerate Line (ρ = </span><span class="sc">{</span>rho1<span class="sc">}</span><span class="ss">)'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a>        <span class="co"># General bivariate normal distribution</span></span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> bivariate_normal_pdf(X, Y, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, rho1)</span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a>        ax1.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a>    ax1.set_title(<span class="ss">f'Bivariate Normal (ρ = </span><span class="sc">{</span>rho1<span class="sc">:.2f}</span><span class="ss">)'</span>)</span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>    ax1.set_zlabel(<span class="st">'PDF'</span>)</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot for the second rho</span></span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">122</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(rho2) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Degenerate case: Straight line</span></span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>        line_x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>        line_y <span class="op">=</span> line_x  <span class="co"># Since rho = 1 implies y = x (perfect correlation)</span></span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a>        ax2.plot(line_x, line_y, np.zeros_like(line_x), label<span class="op">=</span><span class="ss">f'Degenerate Line (ρ = </span><span class="sc">{</span>rho2<span class="sc">}</span><span class="ss">)'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a>        <span class="co"># General bivariate normal distribution</span></span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>        Z <span class="op">=</span> bivariate_normal_pdf(X, Y, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, rho2)</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a>        ax2.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a>    ax2.set_title(<span class="ss">f'Bivariate Normal (ρ = </span><span class="sc">{</span>rho2<span class="sc">:.2f}</span><span class="ss">)'</span>)</span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a>    ax2.set_zlabel(<span class="st">'PDF'</span>)</span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot examples side by side</span></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a>plot_bivariate_and_line_side_by_side(<span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example with rho = 0.5 and rho = 1</span></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### $t-$Statistic  </span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a>Under the null hypothesis, where $H_0: \rho =0, \frac{r\sqrt{n-2}}{\sqrt{1-r^2}}$ has a $t-$ distribution </span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>with $\nu=n-2$ degree of freedom.</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fisher's Transformation of $r$  </span></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>If $W = \frac{1}{2}\ln{\frac{1+r}{1-r}}=\tanh^{-1}r$, then $W$ has approximately a normal distribution with </span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>mean $\frac{1}{2}\ln{\frac{1+\rho}{1-\rho}}$ and standard deviation $\frac{1}{\sqrt{n-3}}$.  </span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>For our stock data:  </span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>**Null Hypothesis $H_0$:** There is no association between stock prices and the portfolio values, i.e., $\rho =0$  </span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a>**Alternative Hypothesis $H_1$:** There is some association between the stock price and portfolio values, i.e., $\rho &gt; 0$  </span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>If $H_0$ is true, then the test statistic </span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>$\frac{r\sqrt{n-2}}{\sqrt{1-r^2}}=\frac{0.92\sqrt{8}}{\sqrt{1-0.92^2}}=6.64$ has a $t_8$ distribution. The</span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>observed value $6.64$ is much greater than the critical value of $t_8$ at $0.5\%$ level which is $3.36$.  </span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>So, we reject the null hypothesis $H_0$ at the $0.5\%$ level and conclude that there is a very strong </span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>evidence that $\rho&gt;0$.  </span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>Alternatively, if we want to use the Fisher's test:  </span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a>If $H_0$ is true, then the test statistic $Z_r=\tanh^{-1}r=\tanh^{-1}(0.92)$ has a $N\left(0,\frac{1}{7}\right)$</span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>distribution.  </span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>The observed value of this statistic is $\frac{1}{2}\log{\frac{1+0.92}{1-0.92}}=1.589$, which corresponds to</span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>a value of $\frac{1.589}{\sqrt{\frac{1}{7}}}=4.204$ on the $N(0,1)$ distribution. This is much greater than</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a>$3.090$, the upper $0.1\%$ point of the standard normal distribution.  </span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a>So, we reject $H_0$ at the $0.1\%$ level and conclude that there is very strong evidence that</span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a>$\rho &gt; 0$ ie that there is a positive linear correlation between the stock price and portfolio value.  </span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression Analysis  </span></span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>Given a set of points $(x_i,y_i)_{i=0}^{n}$ for a simple linear regression of the form  </span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a>Y_i = \alpha +\beta x_i + \epsilon_i; \hspace{4mm} i=1,2,\cdots,n</span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a>with $\mathbb{\epsilon_i}=0$ and $var<span class="co">[</span><span class="ot">\epsilon_i</span><span class="co">]</span>=\sigma^2$.  </span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Fitting  </span></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a>We can estimate the parameters from the method of least squares but that's not the goal in this</span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>case. Fitting the model involves finding $\alpha$ and $\beta$ and the estimating the variance $\sigma^2$.  </span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a>\hat{y} = \hat{\alpha}+\hat{\beta}x</span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>where, $\hat{\beta}= \frac{S_{xy}}{S_{xx}}$ and $\hat{\alpha} = \bar{y}-\hat{\beta}\bar{x}$  </span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>$\hat{\beta}$ is the observed value of a statistic $\hat{B}$ whose sampling distribution has the </span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>following properties  </span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\hat{B}</span><span class="co">]</span>=\beta, \hspace{4mm} var<span class="co">[</span><span class="ot">\hat{B}</span><span class="co">]</span>=\frac{\sigma^2}{S_{xx}}</span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>And the estimate of the error variance </span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}^2 &amp; =\frac{1}{n-2}\sum (y_i -\hat{y_i})^2<span class="sc">\\</span></span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{1}{n-2} \left(S_{yy}-\frac{S_{xy}^2}{S_{xx}}\right)</span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Goodness of fit  </span></span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a>To better understand the goodness of fit of the model for the data at hand, we can study the </span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a>total variation in the responses, as given by </span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>S_{yy} = \sum (y_i-\bar{y})^2</span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a>Let's see how: </span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a>y_i - \bar{y} &amp;= (y_i - \hat{y_i}) + (\hat{y_i}-\bar{y}) <span class="sc">\\</span></span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a>\implies (y_i - \bar{y})^2 &amp; = \left((y_i - \hat{y_i}) + (\hat{y_i}-\bar{y})\right)^2<span class="sc">\\</span></span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a>&amp; = (y_i - \hat{y_i})^2 + 2(y_i - \hat{y_i})(\hat{y_i}-\bar{y})+(\hat{y_i}-\bar{y})^2<span class="sc">\\</span></span>
<span id="cb12-363"><a href="#cb12-363" aria-hidden="true" tabindex="-1"></a>&amp; = (y_i - \hat{y_i})^2 + 2 <span class="co">[</span><span class="ot">y_i -(\hat{\alpha}+\hat{\beta}x_i)</span><span class="co">][\hat{\alpha}+\hat{\beta}x_i-(\hat{\alpha}+\hat{\beta}\bar{x})]</span>+(\hat{y_i}-\bar{y})^2<span class="sc">\\</span></span>
<span id="cb12-364"><a href="#cb12-364" aria-hidden="true" tabindex="-1"></a>&amp; = (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left(y_i -\hat{\alpha}-\hat{\beta}x_i\right)(x_i-\bar{x})+(\hat{y_i}-\bar{y})^2<span class="sc">\\</span></span>
<span id="cb12-365"><a href="#cb12-365" aria-hidden="true" tabindex="-1"></a>\implies \sum (y_i - \bar{y})^2 &amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\sum\left(y_i -\hat{\alpha}-\hat{\beta}x_i\right)(x_i-\bar{x})+\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span></span>
<span id="cb12-366"><a href="#cb12-366" aria-hidden="true" tabindex="-1"></a>&amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left[\sum x_iy_i-\bar{x}\sum y_i -\hat{\alpha}\sum x_i + n\hat{\alpha}\bar{x}-\hat{\beta}\sum x_i^2\right.<span class="sc">\\</span></span>
<span id="cb12-367"><a href="#cb12-367" aria-hidden="true" tabindex="-1"></a>&amp;\left.\hspace{4mm}+\hat{\beta}\bar{x}\sum x_i\right]+\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span></span>
<span id="cb12-368"><a href="#cb12-368" aria-hidden="true" tabindex="-1"></a>&amp; =\sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}\left(\sum x_iy_i-n\bar{x}\bar{y}\right)-2\hat{\beta}^2\left(\sum x_i^2 - n\bar{x}^2\right)+\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span> </span>
<span id="cb12-369"><a href="#cb12-369" aria-hidden="true" tabindex="-1"></a>&amp; = \sum (y_i - \hat{y_i})^2 + 2 \hat{\beta}S_{xy}-2\hat{\beta}^2S_{xx}+\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span> </span>
<span id="cb12-370"><a href="#cb12-370" aria-hidden="true" tabindex="-1"></a>&amp; = \sum (y_i - \hat{y_i})^2 + 2 \frac{S_{xy}}{S_{xx}}S_{xy}-2\left(\frac{S_{xy}}{S_{xx}}\right)^2S_{xx}+\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span> </span>
<span id="cb12-371"><a href="#cb12-371" aria-hidden="true" tabindex="-1"></a>\implies \sum (y_i - \bar{y})^2 &amp; =\sum (y_i - \hat{y_i})^2 +\sum(\hat{y_i}-\bar{y})^2<span class="sc">\\</span> </span>
<span id="cb12-372"><a href="#cb12-372" aria-hidden="true" tabindex="-1"></a>SS_{TOT} &amp; = SS_{RES}+ SS_{REG}</span>
<span id="cb12-373"><a href="#cb12-373" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-374"><a href="#cb12-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-375"><a href="#cb12-375" aria-hidden="true" tabindex="-1"></a>In the case that the data are “close” to a line ( $|r|$ high- a strong linear relationship) the model </span>
<span id="cb12-376"><a href="#cb12-376" aria-hidden="true" tabindex="-1"></a>fits well, the fitted responses (the values on the fitted line) are close to the observed responses, </span>
<span id="cb12-377"><a href="#cb12-377" aria-hidden="true" tabindex="-1"></a>and so $SS_{REG}$ is relatively high with $SS_{RES}$ relatively low.  </span>
<span id="cb12-378"><a href="#cb12-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-379"><a href="#cb12-379" aria-hidden="true" tabindex="-1"></a>In the case that the data are not “close” to a line ( $|r|$ low - a weak linear relationship) the model</span>
<span id="cb12-380"><a href="#cb12-380" aria-hidden="true" tabindex="-1"></a>does not fit so well, the fitted responses are not so close to the observed responses, and so $SS_{REG}$ </span>
<span id="cb12-381"><a href="#cb12-381" aria-hidden="true" tabindex="-1"></a>is relatively low and $SS_{RES}$ relatively high.  </span>
<span id="cb12-382"><a href="#cb12-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-383"><a href="#cb12-383" aria-hidden="true" tabindex="-1"></a>The proportion of the total variability of the responses “explained” by a model is</span>
<span id="cb12-384"><a href="#cb12-384" aria-hidden="true" tabindex="-1"></a>called the coefficient of determination, denoted $R^2$ . </span>
<span id="cb12-385"><a href="#cb12-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-386"><a href="#cb12-386" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-387"><a href="#cb12-387" aria-hidden="true" tabindex="-1"></a>R^2 = \frac{SS_{REG}}{SS_{TOT}} =\frac{S_{xy}^2}{S_{xx}S_{yy}}</span>
<span id="cb12-388"><a href="#cb12-388" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-389"><a href="#cb12-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-390"><a href="#cb12-390" aria-hidden="true" tabindex="-1"></a>which takes value between 0 to 1, inclusive. The higher $R^2$, the better fitting.  </span>
<span id="cb12-391"><a href="#cb12-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-392"><a href="#cb12-392" aria-hidden="true" tabindex="-1"></a>For our data, we have: </span>
<span id="cb12-393"><a href="#cb12-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-394"><a href="#cb12-394" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-395"><a href="#cb12-395" aria-hidden="true" tabindex="-1"></a>n &amp; = 10, \hspace{4mm} \sum x = 35.66, \hspace{4mm} \sum y = 32.47<span class="sc">\\</span></span>
<span id="cb12-396"><a href="#cb12-396" aria-hidden="true" tabindex="-1"></a>S_{xx} &amp;= 8.53 \hspace{4mm} S_{yy}=6.97, \hspace{4mm} S_{xy}=7.13<span class="sc">\\</span></span>
<span id="cb12-397"><a href="#cb12-397" aria-hidden="true" tabindex="-1"></a>\implies \hat{\beta} &amp;=\frac{S_{xy}}{S_{xx}}= \frac{7.13}{8.53} = 0.836<span class="sc">\\</span></span>
<span id="cb12-398"><a href="#cb12-398" aria-hidden="true" tabindex="-1"></a>\hat{\alpha} &amp;= \frac{\sum y}{n} - \hat{\beta} \frac{\sum x}{n} = \bar{y}-\hat{\beta}\bar{x}<span class="sc">\\</span></span>
<span id="cb12-399"><a href="#cb12-399" aria-hidden="true" tabindex="-1"></a>&amp; = 3.247 - 0.836 \times 3.566 = 0.266</span>
<span id="cb12-400"><a href="#cb12-400" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-401"><a href="#cb12-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-402"><a href="#cb12-402" aria-hidden="true" tabindex="-1"></a>Therefore, the fitted line would be $\hat{y}=0.266 + 0.836x$. Now we see the other metrics  </span>
<span id="cb12-403"><a href="#cb12-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-404"><a href="#cb12-404" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-405"><a href="#cb12-405" aria-hidden="true" tabindex="-1"></a>SS_{TOT} &amp;= 6.97 <span class="sc">\\</span></span>
<span id="cb12-406"><a href="#cb12-406" aria-hidden="true" tabindex="-1"></a>SS_{REG} &amp; = \frac{S_{yy}^2}{S_{xx}} = \frac{6.97^2}{8.53}=5.695<span class="sc">\\</span></span>
<span id="cb12-407"><a href="#cb12-407" aria-hidden="true" tabindex="-1"></a>SS_{RES} &amp; = 6.97 - 5.695 = 1.275 <span class="sc">\\</span></span>
<span id="cb12-408"><a href="#cb12-408" aria-hidden="true" tabindex="-1"></a>\implies \hat{\sigma}^2 &amp; = \frac{1.275}{8}=0.1594<span class="sc">\\</span></span>
<span id="cb12-409"><a href="#cb12-409" aria-hidden="true" tabindex="-1"></a>R^2 &amp; = \frac{5.695}{6.97}=0.817</span>
<span id="cb12-410"><a href="#cb12-410" aria-hidden="true" tabindex="-1"></a>\end{align*} </span>
<span id="cb12-411"><a href="#cb12-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-414"><a href="#cb12-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-415"><a href="#cb12-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-416"><a href="#cb12-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb12-417"><a href="#cb12-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for the line</span></span>
<span id="cb12-418"><a href="#cb12-418" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.266</span>  </span>
<span id="cb12-419"><a href="#cb12-419" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.836</span>   </span>
<span id="cb12-420"><a href="#cb12-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-421"><a href="#cb12-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Line values</span></span>
<span id="cb12-422"><a href="#cb12-422" aria-hidden="true" tabindex="-1"></a>line_x <span class="op">=</span> np.linspace(<span class="bu">min</span>(df.StockPrice), <span class="bu">max</span>(df.StockPrice), <span class="dv">100</span>)  </span>
<span id="cb12-423"><a href="#cb12-423" aria-hidden="true" tabindex="-1"></a>line_y <span class="op">=</span> alpha <span class="op">+</span> beta <span class="op">*</span> line_x             </span>
<span id="cb12-424"><a href="#cb12-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-425"><a href="#cb12-425" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-426"><a href="#cb12-426" aria-hidden="true" tabindex="-1"></a>plt.scatter(df.StockPrice, df.Portfolio, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Data Points'</span>)</span>
<span id="cb12-427"><a href="#cb12-427" aria-hidden="true" tabindex="-1"></a>plt.plot(line_x, line_y, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="ss">f'Line: y = </span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>beta<span class="sc">}</span><span class="ss">x'</span>)</span>
<span id="cb12-428"><a href="#cb12-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-429"><a href="#cb12-429" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels and title</span></span>
<span id="cb12-430"><a href="#cb12-430" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb12-431"><a href="#cb12-431" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Portfolio'</span>)</span>
<span id="cb12-432"><a href="#cb12-432" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot with Regression Line'</span>)</span>
<span id="cb12-433"><a href="#cb12-433" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-434"><a href="#cb12-434" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-435"><a href="#cb12-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-436"><a href="#cb12-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-437"><a href="#cb12-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference on $\beta$  </span></span>
<span id="cb12-438"><a href="#cb12-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-439"><a href="#cb12-439" aria-hidden="true" tabindex="-1"></a>We can rewrite $\hat{\beta}= \frac{S_{xy}}{S_{xx}}$, as </span>
<span id="cb12-440"><a href="#cb12-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-441"><a href="#cb12-441" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-442"><a href="#cb12-442" aria-hidden="true" tabindex="-1"></a>\hat{\beta}&amp;= \frac{S_{xy}}{S_{xx}}=\frac{\sum (x_i-\bar{x})(y_i-\bar{y})}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-443"><a href="#cb12-443" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sum (x_i-\bar{x})y_i-\bar{y}\sum (x_i-\bar{x})}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-444"><a href="#cb12-444" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sum (x_i-\bar{x}y_i)-\bar{y}\left(\sum x_i -n\bar{x}\right)}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-445"><a href="#cb12-445" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sum (x_i-\bar{x})y_i}{S_{xx}}</span>
<span id="cb12-446"><a href="#cb12-446" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-447"><a href="#cb12-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-448"><a href="#cb12-448" aria-hidden="true" tabindex="-1"></a>Now we recall that $\hat{B}$ is the random variable that has $\hat{\beta}$ as its realization. Therefore, </span>
<span id="cb12-449"><a href="#cb12-449" aria-hidden="true" tabindex="-1"></a>$\hat{B}=\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}$. We also recall that $\mathbb{E}(Y_i)=\alpha +\beta x$. Putting these together we obtain,</span>
<span id="cb12-450"><a href="#cb12-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-451"><a href="#cb12-451" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-452"><a href="#cb12-452" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">\hat{B}</span><span class="co">]</span> &amp;= \mathbb{E}\left<span class="co">[</span><span class="ot">\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}\right</span><span class="co">]</span> = \frac{\sum (x_i -\bar{x})\mathbb{E}<span class="co">[</span><span class="ot">Y_i</span><span class="co">]</span>}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-453"><a href="#cb12-453" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sum (x_i-\bar{x})(\alpha + \beta x_i)}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-454"><a href="#cb12-454" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\alpha \sum (x_i-\bar{x})+\beta \sum x_i (x_i-\bar{x})}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-455"><a href="#cb12-455" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\alpha \left(\sum x_i -n\bar{x}\right)+\beta \left(\sum x_i^2-\bar{x}\sum x_i\right)}{S_{xx}} <span class="sc">\\</span></span>
<span id="cb12-456"><a href="#cb12-456" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\alpha (n\bar{x}-n\bar{x})+\beta\left(\sum x_i^2-n\bar{x}^2\right)}{S_{xx}}<span class="sc">\\</span></span>
<span id="cb12-457"><a href="#cb12-457" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{0+\beta S_{xx}}{S_{xx}} = \beta</span>
<span id="cb12-458"><a href="#cb12-458" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-459"><a href="#cb12-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-460"><a href="#cb12-460" aria-hidden="true" tabindex="-1"></a>Now the fact that $Y_i'$s are uncorrelated. Therefore,  $var\left(\sum (Y_i)\right)=\sum var(Y_i)$ and we have $var(Y_i)=\sigma^2$. Therefore,</span>
<span id="cb12-461"><a href="#cb12-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-462"><a href="#cb12-462" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-463"><a href="#cb12-463" aria-hidden="true" tabindex="-1"></a>var<span class="co">[</span><span class="ot">\hat{B}</span><span class="co">]</span>&amp; = var\left<span class="co">[</span><span class="ot">\frac{\sum (x_i-\bar{x})Y_i}{S_{xx}}\right</span><span class="co">]</span>= \frac{\sum (x_i-\bar{x})^2var<span class="co">[</span><span class="ot">Y_i</span><span class="co">]</span>}{S_{xx}^2}<span class="sc">\\</span></span>
<span id="cb12-464"><a href="#cb12-464" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sum (x_i-\bar{x})^2\sigma^2}{S_{xx}^2} = \frac{\sigma^2}{S_{xx}^2}\sum (x_i-\bar{x})^2 = \frac{\sigma^2}{S_{xx}^2}S_{xx}<span class="sc">\\</span></span>
<span id="cb12-465"><a href="#cb12-465" aria-hidden="true" tabindex="-1"></a>&amp; = \frac{\sigma^2}{S_{xx}}</span>
<span id="cb12-466"><a href="#cb12-466" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb12-467"><a href="#cb12-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-468"><a href="#cb12-468" aria-hidden="true" tabindex="-1"></a>Since $\mathbb{E}(\hat{\beta})=\beta$ and $var(\hat{\beta})=\frac{\sigma^2}{S_{xx}}$ so </span>
<span id="cb12-469"><a href="#cb12-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-470"><a href="#cb12-470" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-471"><a href="#cb12-471" aria-hidden="true" tabindex="-1"></a>M = \frac{\hat{\beta}-\beta}{\sqrt{\frac{\sigma^2}{S_{xx}}}}\sim N(0,1)</span>
<span id="cb12-472"><a href="#cb12-472" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-473"><a href="#cb12-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-474"><a href="#cb12-474" aria-hidden="true" tabindex="-1"></a>and the observed variance $\hat{\sigma}^2$ has the property </span>
<span id="cb12-475"><a href="#cb12-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-476"><a href="#cb12-476" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-477"><a href="#cb12-477" aria-hidden="true" tabindex="-1"></a>N = \frac{(n-2)\hat{\sigma}^2}{\sigma^2} \sim \chi_{n-2}^2</span>
<span id="cb12-478"><a href="#cb12-478" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-479"><a href="#cb12-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-480"><a href="#cb12-480" aria-hidden="true" tabindex="-1"></a>Since $\hat{\beta}$ and $\hat{\sigma}^2$ are independent, it follows that </span>
<span id="cb12-481"><a href="#cb12-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-482"><a href="#cb12-482" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-483"><a href="#cb12-483" aria-hidden="true" tabindex="-1"></a>\frac{M}{\sqrt{\frac{N}{n-2}}} \sim t_{n-2}</span>
<span id="cb12-484"><a href="#cb12-484" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-485"><a href="#cb12-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-486"><a href="#cb12-486" aria-hidden="true" tabindex="-1"></a>In other words: </span>
<span id="cb12-487"><a href="#cb12-487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-488"><a href="#cb12-488" aria-hidden="true" tabindex="-1"></a>\frac{\hat{\beta}-\beta}{se(\hat{\beta})} = \frac{\hat{\beta}-\beta}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \sim t_{n-2}</span>
<span id="cb12-489"><a href="#cb12-489" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-490"><a href="#cb12-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-491"><a href="#cb12-491" aria-hidden="true" tabindex="-1"></a>Now the big question is what's the use of this mathematical jargon that we have learned so far? Let's use</span>
<span id="cb12-492"><a href="#cb12-492" aria-hidden="true" tabindex="-1"></a>our regression problem on stock data to explain. </span>
<span id="cb12-493"><a href="#cb12-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-494"><a href="#cb12-494" aria-hidden="true" tabindex="-1"></a>**$H_0: \beta =0$, there is no linear relationship**  </span>
<span id="cb12-495"><a href="#cb12-495" aria-hidden="true" tabindex="-1"></a>vs  </span>
<span id="cb12-496"><a href="#cb12-496" aria-hidden="true" tabindex="-1"></a>**$H_1: \beta&gt; 0$, there is a linear relationship**  </span>
<span id="cb12-497"><a href="#cb12-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-498"><a href="#cb12-498" aria-hidden="true" tabindex="-1"></a>Based on our data we have $\hat{\beta} = 0.836$ and $\hat{\sigma}^2=0.1594$, and $S_{xx}=8.53$. Therefore, </span>
<span id="cb12-499"><a href="#cb12-499" aria-hidden="true" tabindex="-1"></a>under $H_0$, the test statistic </span>
<span id="cb12-500"><a href="#cb12-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-501"><a href="#cb12-501" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-502"><a href="#cb12-502" aria-hidden="true" tabindex="-1"></a>\frac{\hat{\beta}-0}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \text{ has a } t_{10-2} \text{ or } t_8 \text{ distribution}</span>
<span id="cb12-503"><a href="#cb12-503" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-504"><a href="#cb12-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-505"><a href="#cb12-505" aria-hidden="true" tabindex="-1"></a>But the observed value of this statistic </span>
<span id="cb12-506"><a href="#cb12-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-507"><a href="#cb12-507" aria-hidden="true" tabindex="-1"></a>\frac{0.836-0}{\sqrt{0.1594/8.53}}=6.1156</span>
<span id="cb12-508"><a href="#cb12-508" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-509"><a href="#cb12-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-510"><a href="#cb12-510" aria-hidden="true" tabindex="-1"></a>which is way higher than the critical value at $5\%$ significance level.</span>
<span id="cb12-513"><a href="#cb12-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-514"><a href="#cb12-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-515"><a href="#cb12-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb12-516"><a href="#cb12-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-517"><a href="#cb12-517" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb12-518"><a href="#cb12-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-519"><a href="#cb12-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb12-520"><a href="#cb12-520" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">8</span>  <span class="co"># Degrees of freedom</span></span>
<span id="cb12-521"><a href="#cb12-521" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Upper tail probability</span></span>
<span id="cb12-522"><a href="#cb12-522" aria-hidden="true" tabindex="-1"></a>t_critical <span class="op">=</span> t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha, df)  <span class="co"># Critical t-value at the 95th percentile</span></span>
<span id="cb12-523"><a href="#cb12-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-524"><a href="#cb12-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate x values for the t-distribution</span></span>
<span id="cb12-525"><a href="#cb12-525" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb12-526"><a href="#cb12-526" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> t.pdf(x, df)</span>
<span id="cb12-527"><a href="#cb12-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-528"><a href="#cb12-528" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb12-529"><a href="#cb12-529" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, label<span class="op">=</span><span class="ss">f't_</span><span class="sc">{</span>df<span class="sc">}</span><span class="ss"> Distribution'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb12-530"><a href="#cb12-530" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, where<span class="op">=</span>(x <span class="op">&gt;=</span> t_critical), color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f'Upper </span><span class="sc">{</span>alpha<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Area'</span>)</span>
<span id="cb12-531"><a href="#cb12-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-532"><a href="#cb12-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate the critical t-value on the x-axis</span></span>
<span id="cb12-533"><a href="#cb12-533" aria-hidden="true" tabindex="-1"></a>plt.axvline(t_critical, ymin<span class="op">=</span><span class="fl">0.02</span>, ymax<span class="op">=</span><span class="fl">0.30</span>,color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Critical t-value = </span><span class="sc">{</span>t_critical<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb12-534"><a href="#cb12-534" aria-hidden="true" tabindex="-1"></a>plt.text(t_critical, <span class="op">-</span><span class="fl">0.02</span>, <span class="ss">f'</span><span class="sc">{</span>t_critical<span class="sc">:.2f}</span><span class="ss">'</span>, color<span class="op">=</span><span class="st">'red'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb12-535"><a href="#cb12-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-536"><a href="#cb12-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a horizontal line at y = 0</span></span>
<span id="cb12-537"><a href="#cb12-537" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb12-538"><a href="#cb12-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-539"><a href="#cb12-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels, title, and legend</span></span>
<span id="cb12-540"><a href="#cb12-540" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"t-Distribution with </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss"> Degrees of Freedom"</span>)</span>
<span id="cb12-541"><a href="#cb12-541" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"t"</span>)</span>
<span id="cb12-542"><a href="#cb12-542" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb12-543"><a href="#cb12-543" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-544"><a href="#cb12-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-545"><a href="#cb12-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust plot limits</span></span>
<span id="cb12-546"><a href="#cb12-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-547"><a href="#cb12-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-548"><a href="#cb12-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb12-549"><a href="#cb12-549" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-550"><a href="#cb12-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-551"><a href="#cb12-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-552"><a href="#cb12-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-553"><a href="#cb12-553" aria-hidden="true" tabindex="-1"></a>So, we reject the null hypothesis $H_0$ at the $5\%$ level and conclude that there is a very strong evidence that $\beta&gt;0$, i.e., the portfolio value is increasing over stock price.  </span>
<span id="cb12-554"><a href="#cb12-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-555"><a href="#cb12-555" aria-hidden="true" tabindex="-1"></a>**Alternatively,** let's put our analysis in a different approach. We claim that </span>
<span id="cb12-556"><a href="#cb12-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-557"><a href="#cb12-557" aria-hidden="true" tabindex="-1"></a>**$H_0: \beta=1$, there is a linear relationship**  </span>
<span id="cb12-558"><a href="#cb12-558" aria-hidden="true" tabindex="-1"></a>vs  </span>
<span id="cb12-559"><a href="#cb12-559" aria-hidden="true" tabindex="-1"></a>**$H_1: \beta \ne 1$**  </span>
<span id="cb12-560"><a href="#cb12-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-561"><a href="#cb12-561" aria-hidden="true" tabindex="-1"></a>In this case,  </span>
<span id="cb12-562"><a href="#cb12-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-563"><a href="#cb12-563" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-564"><a href="#cb12-564" aria-hidden="true" tabindex="-1"></a>se(\hat{\beta}) = \sqrt{\frac{\hat{\sigma}^2}{S_{xx}}} = \sqrt{\frac{0.1594}{8.53}} =0.1367</span>
<span id="cb12-565"><a href="#cb12-565" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-566"><a href="#cb12-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-567"><a href="#cb12-567" aria-hidden="true" tabindex="-1"></a>Therefore, the $95\%$ confidence interval for $\beta$ is </span>
<span id="cb12-568"><a href="#cb12-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-569"><a href="#cb12-569" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-570"><a href="#cb12-570" aria-hidden="true" tabindex="-1"></a>\hat{\beta} \pm \left<span class="sc">\{</span>t_{0.025,8}\times se(\hat{\beta})\right<span class="sc">\}</span>=0.836 \pm 2.306\times 0.1367 = (0.5207,1.1512) </span>
<span id="cb12-571"><a href="#cb12-571" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-572"><a href="#cb12-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-573"><a href="#cb12-573" aria-hidden="true" tabindex="-1"></a>The $95\%$ two-sided confidence interval contains the value $1$, so the two-sided test conducted at $5\%$ level results in $H_0$ being accepted.  </span>
<span id="cb12-574"><a href="#cb12-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-575"><a href="#cb12-575" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mean Response and Individual Response  </span></span>
<span id="cb12-576"><a href="#cb12-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-577"><a href="#cb12-577" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mean Response  </span></span>
<span id="cb12-578"><a href="#cb12-578" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-579"><a href="#cb12-579" aria-hidden="true" tabindex="-1"></a>If $\mu_0$ is the expected (mean) response for a value $x_0$ of the predictor variable, that is </span>
<span id="cb12-580"><a href="#cb12-580" aria-hidden="true" tabindex="-1"></a>$\mu_0 = \mathbb{E}<span class="co">[</span><span class="ot">Y|x_0</span><span class="co">]</span>=\alpha +\beta x_0$, then $\mu_0$ is an unbiased estimator given by &lt;/p&gt;</span>
<span id="cb12-581"><a href="#cb12-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-582"><a href="#cb12-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-583"><a href="#cb12-583" aria-hidden="true" tabindex="-1"></a>\hat{\mu}_0 = \hat{\alpha}+\hat{\beta} x_0</span>
<span id="cb12-584"><a href="#cb12-584" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-585"><a href="#cb12-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-586"><a href="#cb12-586" aria-hidden="true" tabindex="-1"></a>and the variance of the estimator is given by  </span>
<span id="cb12-587"><a href="#cb12-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-588"><a href="#cb12-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-589"><a href="#cb12-589" aria-hidden="true" tabindex="-1"></a>var(\hat{\mu}_0) = \left(\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2</span>
<span id="cb12-590"><a href="#cb12-590" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-591"><a href="#cb12-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-592"><a href="#cb12-592" aria-hidden="true" tabindex="-1"></a>Therefore, </span>
<span id="cb12-593"><a href="#cb12-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-594"><a href="#cb12-594" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-595"><a href="#cb12-595" aria-hidden="true" tabindex="-1"></a>\frac{\hat{\mu}_0-\mu_0}{se[\hat{\mu}_0] }= \frac{\hat{\mu}_0-\mu_0}{\sqrt{\left(\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2}}\sim t_{n-2}</span>
<span id="cb12-596"><a href="#cb12-596" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-597"><a href="#cb12-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-598"><a href="#cb12-598" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individual Response  </span></span>
<span id="cb12-599"><a href="#cb12-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-600"><a href="#cb12-600" aria-hidden="true" tabindex="-1"></a>The actual estimate of an individual response</span>
<span id="cb12-601"><a href="#cb12-601" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-602"><a href="#cb12-602" aria-hidden="true" tabindex="-1"></a>\hat{y}_0 = \hat{\alpha} +\hat{\beta}x_0</span>
<span id="cb12-603"><a href="#cb12-603" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-604"><a href="#cb12-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-605"><a href="#cb12-605" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-606"><a href="#cb12-606" aria-hidden="true" tabindex="-1"></a>However, the uncertainty associated with this estimator, as indicated by its variance, is higher compared to the mean estimator because it relies on the value of an individual response $y_0$ rather than the more stable mean. To account for the additional variability of an individual response relative to the mean, an extra term, $\sigma^2$, must be included in the variance expression for the estimator of a mean response.&lt;/p&gt;  </span>
<span id="cb12-607"><a href="#cb12-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-608"><a href="#cb12-608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-609"><a href="#cb12-609" aria-hidden="true" tabindex="-1"></a>var<span class="co">[</span><span class="ot">\hat{y}_0</span><span class="co">]</span> = \left(1+\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2</span>
<span id="cb12-610"><a href="#cb12-610" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-611"><a href="#cb12-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-612"><a href="#cb12-612" aria-hidden="true" tabindex="-1"></a>Thus, </span>
<span id="cb12-613"><a href="#cb12-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-614"><a href="#cb12-614" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-615"><a href="#cb12-615" aria-hidden="true" tabindex="-1"></a>\frac{\hat{y}-y_0}{se<span class="co">[</span><span class="ot">\hat{y}_0</span><span class="co">]</span>}=\frac{\hat{y}-y_0}{\sqrt{\left(1+\frac{1}{n}+\frac{(x_0-\bar{x})^2}{S_{xx}}\right)\sigma^2}}\sim t_{n-2}</span>
<span id="cb12-616"><a href="#cb12-616" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-617"><a href="#cb12-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-618"><a href="#cb12-618" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align:justify"&gt;</span>
<span id="cb12-619"><a href="#cb12-619" aria-hidden="true" tabindex="-1"></a>Let's put this two idea through our example. If we want to find a $95\%$ confidence interval or the </span>
<span id="cb12-620"><a href="#cb12-620" aria-hidden="true" tabindex="-1"></a>expected portfolio value on stock price of say, 360. In that case,&lt;/p&gt;</span>
<span id="cb12-621"><a href="#cb12-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-622"><a href="#cb12-622" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-623"><a href="#cb12-623" aria-hidden="true" tabindex="-1"></a>\text{Estimate of the expected portfolio value} = 0.266+0.836\times 3.6 = 3.276</span>
<span id="cb12-624"><a href="#cb12-624" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-625"><a href="#cb12-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-626"><a href="#cb12-626" aria-hidden="true" tabindex="-1"></a>and </span>
<span id="cb12-627"><a href="#cb12-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-628"><a href="#cb12-628" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-629"><a href="#cb12-629" aria-hidden="true" tabindex="-1"></a>\text{se}<span class="co">[</span><span class="ot">\text{Estimate}</span><span class="co">]</span> = \sqrt{\left(\frac{1}{10}+\frac{(3.6-3.566)^2}{8.53}\right) 0.1594}=0.1263</span>
<span id="cb12-630"><a href="#cb12-630" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-631"><a href="#cb12-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-632"><a href="#cb12-632" aria-hidden="true" tabindex="-1"></a>So, the $95\%$ CI  </span>
<span id="cb12-633"><a href="#cb12-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-634"><a href="#cb12-634" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-635"><a href="#cb12-635" aria-hidden="true" tabindex="-1"></a>3.276\pm (t_{0.025,8}\times \text{se}<span class="co">[</span><span class="ot">\text{Estimate}</span><span class="co">]</span>) = 3.276 \pm 2.306\times 0.1263 = (2.985,3.567)</span>
<span id="cb12-636"><a href="#cb12-636" aria-hidden="true" tabindex="-1"></a>$$  </span>
<span id="cb12-637"><a href="#cb12-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-638"><a href="#cb12-638" aria-hidden="true" tabindex="-1"></a>That is for a stock price of $\$360$, the expected portfolio value would be in the range of $(\$298.50,\$356.70)$</span>
<span id="cb12-639"><a href="#cb12-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-640"><a href="#cb12-640" aria-hidden="true" tabindex="-1"></a>Similarly, the $95\%$ CI for the predicted actual portfolio value</span>
<span id="cb12-641"><a href="#cb12-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-642"><a href="#cb12-642" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-643"><a href="#cb12-643" aria-hidden="true" tabindex="-1"></a>3.276\pm (t_{0.025,8}\times \text{se}<span class="co">[</span><span class="ot">\text{Estimate}</span><span class="co">]</span>) &amp;= 3.276 \pm 2.306\sqrt{\left(1+\frac{1}{10}+\frac{(3.6-3.566)^2}{8.53}\right) 0.1594}<span class="sc">\\</span></span>
<span id="cb12-644"><a href="#cb12-644" aria-hidden="true" tabindex="-1"></a>&amp; = (2.3103,4.2417)</span>
<span id="cb12-645"><a href="#cb12-645" aria-hidden="true" tabindex="-1"></a>\end{align*} </span>
<span id="cb12-646"><a href="#cb12-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-647"><a href="#cb12-647" aria-hidden="true" tabindex="-1"></a>or $(\$231.03,\$424.17)$  </span>
<span id="cb12-648"><a href="#cb12-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-649"><a href="#cb12-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Accuracy  </span></span>
<span id="cb12-650"><a href="#cb12-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-651"><a href="#cb12-651" aria-hidden="true" tabindex="-1"></a>The residual from the fit at $x_i$ is the estimated error which is defined by </span>
<span id="cb12-652"><a href="#cb12-652" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-653"><a href="#cb12-653" aria-hidden="true" tabindex="-1"></a>\hat{\epsilon}_i = y_i - \hat{y}_i</span>
<span id="cb12-654"><a href="#cb12-654" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-655"><a href="#cb12-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-656"><a href="#cb12-656" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-657"><a href="#cb12-657" aria-hidden="true" tabindex="-1"></a>Scatter plots of residuals versus the explanatory variable (or the fitted response values) are particularly insightful. A lack of random scatter in the residuals, such as the presence of a discernible pattern, indicates potential shortcomings in the model.&lt;/p&gt;</span>
<span id="cb12-658"><a href="#cb12-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-661"><a href="#cb12-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-662"><a href="#cb12-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-663"><a href="#cb12-663" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb12-664"><a href="#cb12-664" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock'</span>: [<span class="st">'Apple'</span>, <span class="st">'Citi'</span>, <span class="st">'MS'</span>, <span class="st">'WF'</span>, <span class="st">'GS'</span>, <span class="st">'Google'</span>, <span class="st">'Amazon'</span>, <span class="st">'Tesla'</span>, <span class="st">'Toyota'</span>, <span class="st">'SPY'</span>],</span>
<span id="cb12-665"><a href="#cb12-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">'StockPrice'</span>: [<span class="fl">2.11</span>, <span class="fl">2.42</span>, <span class="fl">2.52</span>, <span class="fl">3.21</span>, <span class="fl">3.62</span>, <span class="fl">3.86</span>, <span class="fl">4.13</span>, <span class="fl">4.27</span>, <span class="fl">4.51</span>, <span class="fl">5.01</span>], </span>
<span id="cb12-666"><a href="#cb12-666" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Portfolio'</span>: [<span class="fl">2.12</span>, <span class="fl">2.16</span>, <span class="fl">2.51</span>, <span class="fl">2.65</span>, <span class="fl">3.62</span>, <span class="fl">3.15</span>, <span class="fl">4.32</span>, <span class="fl">3.31</span>, <span class="fl">4.18</span>, <span class="fl">4.45</span>]</span>
<span id="cb12-667"><a href="#cb12-667" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-668"><a href="#cb12-668" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb12-669"><a href="#cb12-669" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df.Portfolio.values </span>
<span id="cb12-670"><a href="#cb12-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-671"><a href="#cb12-671" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> [<span class="fl">0.266</span><span class="op">+</span><span class="fl">0.836</span><span class="op">*</span>i <span class="cf">for</span> i <span class="kw">in</span> x]</span>
<span id="cb12-672"><a href="#cb12-672" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y<span class="op">-</span>y_hat)</span>
<span id="cb12-673"><a href="#cb12-673" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>)</span>
<span id="cb12-674"><a href="#cb12-674" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb12-675"><a href="#cb12-675" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb12-676"><a href="#cb12-676" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of the residuals from the fitted line'</span>)</span>
<span id="cb12-677"><a href="#cb12-677" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-678"><a href="#cb12-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>    </span>
<span id="cb12-679"><a href="#cb12-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-680"><a href="#cb12-680" aria-hidden="true" tabindex="-1"></a>&lt;p style="text-align: justify"&gt;</span>
<span id="cb12-681"><a href="#cb12-681" aria-hidden="true" tabindex="-1"></a>In this plot, we can see that the residuals tend to increase as $x$ increases, indicates that the error variance is not bounded, but increasing with $x$. So, the model is not the best one. A transformation of the responses may stabilize the error variance. &lt;br&gt;</span>
<span id="cb12-682"><a href="#cb12-682" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb12-683"><a href="#cb12-683" aria-hidden="true" tabindex="-1"></a>In certain case, for some growth models, the appropriate model is that the expected response is related to the exploratory variable through an exponential relationship, i.e.,</span>
<span id="cb12-684"><a href="#cb12-684" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;  </span>
<span id="cb12-685"><a href="#cb12-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-686"><a href="#cb12-686" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-687"><a href="#cb12-687" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">Y_i|X=x_i</span><span class="co">]</span> &amp;= \alpha e^{\beta x_i}<span class="sc">\\</span></span>
<span id="cb12-688"><a href="#cb12-688" aria-hidden="true" tabindex="-1"></a>\implies z_i = \log y_i &amp; = \eta + \beta x_i + \epsilon_i; \hspace{4mm}\text{where }\eta=\log \alpha</span>
<span id="cb12-689"><a href="#cb12-689" aria-hidden="true" tabindex="-1"></a>\end{align*}  </span>
<span id="cb12-690"><a href="#cb12-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-693"><a href="#cb12-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-694"><a href="#cb12-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-695"><a href="#cb12-695" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.StockPrice.values</span>
<span id="cb12-696"><a href="#cb12-696" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(df.Portfolio.values)</span>
<span id="cb12-697"><a href="#cb12-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-698"><a href="#cb12-698" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb12-699"><a href="#cb12-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-700"><a href="#cb12-700" aria-hidden="true" tabindex="-1"></a>x_sum, y_sum <span class="op">=</span><span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb12-701"><a href="#cb12-701" aria-hidden="true" tabindex="-1"></a>s_xx, s_yy, s_xy <span class="op">=</span> <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb12-702"><a href="#cb12-702" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb12-703"><a href="#cb12-703" aria-hidden="true" tabindex="-1"></a>    x_sum <span class="op">+=</span> x[i]</span>
<span id="cb12-704"><a href="#cb12-704" aria-hidden="true" tabindex="-1"></a>    s_xx <span class="op">+=</span> x[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-705"><a href="#cb12-705" aria-hidden="true" tabindex="-1"></a>    y_sum <span class="op">+=</span> y[i]</span>
<span id="cb12-706"><a href="#cb12-706" aria-hidden="true" tabindex="-1"></a>    s_yy <span class="op">+=</span> y[i]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb12-707"><a href="#cb12-707" aria-hidden="true" tabindex="-1"></a>    s_xy <span class="op">+=</span> x[i]<span class="op">*</span>y[i]    </span>
<span id="cb12-708"><a href="#cb12-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-709"><a href="#cb12-709" aria-hidden="true" tabindex="-1"></a>s_xx <span class="op">=</span> s_xx <span class="op">-</span> (x_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb12-710"><a href="#cb12-710" aria-hidden="true" tabindex="-1"></a>s_yy <span class="op">=</span> s_yy <span class="op">-</span> (y_sum)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb12-711"><a href="#cb12-711" aria-hidden="true" tabindex="-1"></a>s_xy <span class="op">=</span> s_xy <span class="op">-</span> (x_sum <span class="op">*</span> y_sum)<span class="op">/</span>n</span>
<span id="cb12-712"><a href="#cb12-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-713"><a href="#cb12-713" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> s_xy<span class="op">/</span>math.sqrt(s_xx <span class="op">*</span> s_yy)</span>
<span id="cb12-714"><a href="#cb12-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-715"><a href="#cb12-715" aria-hidden="true" tabindex="-1"></a><span class="co"># Print with formatted labels</span></span>
<span id="cb12-716"><a href="#cb12-716" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum x: </span><span class="sc">{</span>x_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-717"><a href="#cb12-717" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum y: </span><span class="sc">{</span>y_sum<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-718"><a href="#cb12-718" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓₓ: </span><span class="sc">{</span>s_xx<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-719"><a href="#cb12-719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sᵧᵧ: </span><span class="sc">{</span>s_yy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-720"><a href="#cb12-720" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sₓᵧ: </span><span class="sc">{</span>s_xy<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-721"><a href="#cb12-721" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb12-722"><a href="#cb12-722" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r : </span><span class="sc">{</span>r<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-723"><a href="#cb12-723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-724"><a href="#cb12-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-725"><a href="#cb12-725" aria-hidden="true" tabindex="-1"></a>Now we have: </span>
<span id="cb12-726"><a href="#cb12-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-727"><a href="#cb12-727" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb12-728"><a href="#cb12-728" aria-hidden="true" tabindex="-1"></a>n &amp; = 10, \hspace{4mm} \sum x = 35.66, \hspace{4mm} \sum y = 11.43<span class="sc">\\</span></span>
<span id="cb12-729"><a href="#cb12-729" aria-hidden="true" tabindex="-1"></a>S_{xx} &amp;= 8.53 \hspace{4mm} S_{yy}=0.70, \hspace{4mm} S_{xy}=2.29<span class="sc">\\</span></span>
<span id="cb12-730"><a href="#cb12-730" aria-hidden="true" tabindex="-1"></a>\implies \hat{\beta} &amp;=\frac{S_{xy}}{S_{xx}}= \frac{2.29}{8.53} = 0.268<span class="sc">\\</span></span>
<span id="cb12-731"><a href="#cb12-731" aria-hidden="true" tabindex="-1"></a>\hat{\alpha} &amp;= \frac{\sum y}{n} - \hat{\beta} \frac{\sum x}{n} = \bar{y}-\hat{\beta}\bar{x}<span class="sc">\\</span></span>
<span id="cb12-732"><a href="#cb12-732" aria-hidden="true" tabindex="-1"></a>&amp; = 1.143 - 0.268 \times 3.566 = 0.1873</span>
<span id="cb12-733"><a href="#cb12-733" aria-hidden="true" tabindex="-1"></a>\end{align*} </span>
<span id="cb12-734"><a href="#cb12-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-737"><a href="#cb12-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb12-738"><a href="#cb12-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-739"><a href="#cb12-739" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-740"><a href="#cb12-740" aria-hidden="true" tabindex="-1"></a>z_hat <span class="op">=</span> [np.log(<span class="fl">0.1873</span>)<span class="op">+</span><span class="fl">0.268</span><span class="op">*</span>i <span class="cf">for</span> i <span class="kw">in</span> x]</span>
<span id="cb12-741"><a href="#cb12-741" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.log(y)</span>
<span id="cb12-742"><a href="#cb12-742" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, z<span class="op">-</span>z_hat)</span>
<span id="cb12-743"><a href="#cb12-743" aria-hidden="true" tabindex="-1"></a>plt.axhline(np.mean(z<span class="op">-</span>z_hat))</span>
<span id="cb12-744"><a href="#cb12-744" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb12-745"><a href="#cb12-745" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Price'</span>)</span>
<span id="cb12-746"><a href="#cb12-746" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter plot of the residuals from the fitted line'</span>)</span>
<span id="cb12-747"><a href="#cb12-747" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-748"><a href="#cb12-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb12-749"><a href="#cb12-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-750"><a href="#cb12-750" aria-hidden="true" tabindex="-1"></a>Now the residuals look good, that is no special pattern or increasing the error variance. </span>
<span id="cb12-751"><a href="#cb12-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-752"><a href="#cb12-752" aria-hidden="true" tabindex="-1"></a>Thanks for reading.  </span>
<span id="cb12-753"><a href="#cb12-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-754"><a href="#cb12-754" aria-hidden="true" tabindex="-1"></a><span class="fu">## References  </span></span>
<span id="cb12-755"><a href="#cb12-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-756"><a href="#cb12-756" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Montgomery, D. C., &amp; Runger, G. C.** (2014). *Applied Statistics and Probability for Engineers*. Wiley.  </span>
<span id="cb12-757"><a href="#cb12-757" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Casella, G., &amp; Berger, R. L.** (2002). *Statistical Inference*. Duxbury.  </span>
<span id="cb12-758"><a href="#cb12-758" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S.** (2003). *Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences*. Routledge.  </span>
<span id="cb12-759"><a href="#cb12-759" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Seber, G. A. F., &amp; Lee, A. J.** (2003). *Linear Regression Analysis*. Wiley. </span>
<span id="cb12-760"><a href="#cb12-760" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Neter, J., Kutner, M. H., Nachtsheim, C. J., &amp; Wasserman, W.** (1996). *Applied Linear Statistical Models*. Irwin.  </span>
<span id="cb12-761"><a href="#cb12-761" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Hastie, T., Tibshirani, R., &amp; Friedman, J.** (2009). *The Elements of Statistical Learning: Data Mining, Inference, and Prediction*. Springer.  </span>
<span id="cb12-762"><a href="#cb12-762" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Weisberg, S.** (2005). *Applied Linear Regression*. Wiley.  </span>
<span id="cb12-763"><a href="#cb12-763" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Bivariate Normal Distribution Explanation**:  </span>
<span id="cb12-764"><a href="#cb12-764" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Rice, J. A. (2006). *Mathematical Statistics and Data Analysis*. Thomson Brooks/Cole.  </span>
<span id="cb12-765"><a href="#cb12-765" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A detailed exploration of the bivariate normal distribution and its properties.</span>
<span id="cb12-766"><a href="#cb12-766" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>**Fisher's Transformation of Correlation Coefficients**:  </span>
<span id="cb12-767"><a href="#cb12-767" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Fisher, R. A. (1921). *On the probable error of a coefficient of correlation*. Metron, 1, 3-32.  </span>
<span id="cb12-768"><a href="#cb12-768" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The foundational paper describing Fisher's transformation and its use in hypothesis testing.</span>
<span id="cb12-769"><a href="#cb12-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-770"><a href="#cb12-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-771"><a href="#cb12-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-772"><a href="#cb12-772" aria-hidden="true" tabindex="-1"></a>**Share on** </span>
<span id="cb12-773"><a href="#cb12-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-774"><a href="#cb12-774" aria-hidden="true" tabindex="-1"></a>::::{.columns}</span>
<span id="cb12-775"><a href="#cb12-775" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb12-776"><a href="#cb12-776" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.facebook.com/sharer.php?u=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1877F2; text-decoration: none;"&gt;</span>
<span id="cb12-777"><a href="#cb12-777" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-778"><a href="#cb12-778" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands facebook size=3x &gt;}}</span>
<span id="cb12-779"><a href="#cb12-779" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb12-780"><a href="#cb12-780" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-781"><a href="#cb12-781" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-782"><a href="#cb12-782" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-783"><a href="#cb12-783" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb12-784"><a href="#cb12-784" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.linkedin.com/sharing/share-offsite/?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#0077B5; text-decoration: none;"&gt;</span>
<span id="cb12-785"><a href="#cb12-785" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-786"><a href="#cb12-786" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands linkedin size=3x &gt;}}</span>
<span id="cb12-787"><a href="#cb12-787" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb12-788"><a href="#cb12-788" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-789"><a href="#cb12-789" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-790"><a href="#cb12-790" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-791"><a href="#cb12-791" aria-hidden="true" tabindex="-1"></a>:::{.column width="33%"}</span>
<span id="cb12-792"><a href="#cb12-792" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://www.twitter.com/intent/tweet?url=https://mrislambd.github.io/jobandintern/correlationandregression/" target="_blank" style="color:#1DA1F2; text-decoration: none;"&gt;</span>
<span id="cb12-793"><a href="#cb12-793" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-794"><a href="#cb12-794" aria-hidden="true" tabindex="-1"></a>{{&lt; fa brands twitter size=3x &gt;}}</span>
<span id="cb12-795"><a href="#cb12-795" aria-hidden="true" tabindex="-1"></a>&lt;/a&gt;</span>
<span id="cb12-796"><a href="#cb12-796" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-797"><a href="#cb12-797" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-798"><a href="#cb12-798" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb12-799"><a href="#cb12-799" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-800"><a href="#cb12-800" aria-hidden="true" tabindex="-1"></a>&lt;script src="https://giscus.app/client.js"</span>
<span id="cb12-801"><a href="#cb12-801" aria-hidden="true" tabindex="-1"></a>        data-repo="mrislambd/mrislambd.github.io" </span>
<span id="cb12-802"><a href="#cb12-802" aria-hidden="true" tabindex="-1"></a>        data-repo-id="R_kgDOMV8crA"</span>
<span id="cb12-803"><a href="#cb12-803" aria-hidden="true" tabindex="-1"></a>        data-category="Announcements"</span>
<span id="cb12-804"><a href="#cb12-804" aria-hidden="true" tabindex="-1"></a>        data-category-id="DIC_kwDOMV8crM4CjbQW"</span>
<span id="cb12-805"><a href="#cb12-805" aria-hidden="true" tabindex="-1"></a>        data-mapping="pathname"</span>
<span id="cb12-806"><a href="#cb12-806" aria-hidden="true" tabindex="-1"></a>        data-strict="0"</span>
<span id="cb12-807"><a href="#cb12-807" aria-hidden="true" tabindex="-1"></a>        data-reactions-enabled="1"</span>
<span id="cb12-808"><a href="#cb12-808" aria-hidden="true" tabindex="-1"></a>        data-emit-metadata="0"</span>
<span id="cb12-809"><a href="#cb12-809" aria-hidden="true" tabindex="-1"></a>        data-input-position="bottom"</span>
<span id="cb12-810"><a href="#cb12-810" aria-hidden="true" tabindex="-1"></a>        data-theme="light"</span>
<span id="cb12-811"><a href="#cb12-811" aria-hidden="true" tabindex="-1"></a>        data-lang="en"</span>
<span id="cb12-812"><a href="#cb12-812" aria-hidden="true" tabindex="-1"></a>        crossorigin="anonymous"</span>
<span id="cb12-813"><a href="#cb12-813" aria-hidden="true" tabindex="-1"></a>        async&gt;</span>
<span id="cb12-814"><a href="#cb12-814" aria-hidden="true" tabindex="-1"></a>&lt;/script&gt;</span>
<span id="cb12-815"><a href="#cb12-815" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-816"><a href="#cb12-816" aria-hidden="true" tabindex="-1"></a>&lt;div id="fb-root"&gt;&lt;/div&gt;</span>
<span id="cb12-817"><a href="#cb12-817" aria-hidden="true" tabindex="-1"></a>&lt;script async defer crossorigin="anonymous"</span>
<span id="cb12-818"><a href="#cb12-818" aria-hidden="true" tabindex="-1"></a> src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v20.0"&gt;&lt;/script&gt;</span>
<span id="cb12-819"><a href="#cb12-819" aria-hidden="true" tabindex="-1"></a>&lt;div class="fb-comments" data-href="https://mrislambd.github.io/jobandintern/correlationandregression/" data-width="750" data-numposts="5"&gt;&lt;/div&gt;  </span>
<span id="cb12-820"><a href="#cb12-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-821"><a href="#cb12-821" aria-hidden="true" tabindex="-1"></a>**You may also like**</span>
<span id="cb12-822"><a href="#cb12-822" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org/">Quarto</a> 1.5.54</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2024 @ Rafiq Islam
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.txt">
<p>License</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rafiqr35" target="_blank">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://youtube.com/@quanttube" target="_blank">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:rafiqfsu@gmail.com?subject&amp;body" target="_blank">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","closeEffect":"zoom","loop":false,"openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>